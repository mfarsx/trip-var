3b6824d806fb0795e060cb7f14cb54fa
const {
  validationResult
} = require('express-validator');
const {
  ValidationError
} = require('../utils/errors');

/**
 * Validation middleware factory
 * @param {Array} validations - Array of validation rules
 * @returns {Function} Express middleware function
 */
const validate = validations => {
  return async (req, res, next) => {
    try {
      // Run all validations
      await Promise.all(validations.map(validation => validation.run(req)));

      // Check for validation errors
      const errors = validationResult(req);
      if (!errors.isEmpty()) {
        const errorMessages = errors.array().map(error => error.msg);
        const errorDetails = errors.array().map(error => ({
          field: error.param,
          message: error.msg,
          value: error.value,
          location: error.location
        }));
        const validationError = new ValidationError(`Validation failed: ${errorMessages.join(', ')}`, errorDetails);
        return next(validationError);
      }
      next();
    } catch (err) {
      next(err);
    }
  };
};

/**
 * Sanitization middleware
 * @param {Object} options - Sanitization options
 * @returns {Function} Express middleware function
 */
const sanitize = (options = {}) => {
  const {
    removeHtml = true,
    removeScripts = true,
    trimStrings = true,
    allowedTags = [],
    maxLength = 1000
  } = options;
  return (req, res, next) => {
    const sanitizeString = str => {
      if (typeof str !== 'string') {
        return str;
      }
      let sanitized = str;

      // Trim whitespace
      if (trimStrings) {
        sanitized = sanitized.trim();
      }

      // Remove HTML tags
      if (removeHtml) {
        sanitized = sanitized.replace(/<[^>]*>/g, '');
      }

      // Remove script tags and javascript: protocols
      if (removeScripts) {
        sanitized = sanitized.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '').replace(/javascript:/gi, '').replace(/on\w+\s*=/gi, '');
      }

      // Limit length
      if (sanitized.length > maxLength) {
        sanitized = sanitized.substring(0, maxLength);
      }
      return sanitized;
    };

    // Sanitize request body
    if (req.body) {
      Object.keys(req.body).forEach(key => {
        if (typeof req.body[key] === 'string') {
          req.body[key] = sanitizeString(req.body[key]);
        } else if (Array.isArray(req.body[key])) {
          req.body[key] = req.body[key].map(item => typeof item === 'string' ? sanitizeString(item) : item);
        }
      });
    }

    // Sanitize query parameters
    if (req.query) {
      Object.keys(req.query).forEach(key => {
        if (typeof req.query[key] === 'string') {
          req.query[key] = sanitizeString(req.query[key]);
        }
      });
    }

    // Sanitize URL parameters
    if (req.params) {
      Object.keys(req.params).forEach(key => {
        if (typeof req.params[key] === 'string') {
          req.params[key] = sanitizeString(req.params[key]);
        }
      });
    }
    next();
  };
};

/**
 * Rate limiting validation
 * @param {Object} options - Rate limiting options
 * @returns {Function} Express middleware function
 */
const rateLimitValidation = (options = {}) => {
  const {
    windowMs = 15 * 60 * 1000,
    // 15 minutes
    max = 100,
    // limit each IP to 100 requests per windowMs
    message = 'Too many requests from this IP, please try again later.',
    skipSuccessfulRequests = false,
    skipFailedRequests = false
  } = options;
  const requests = new Map();
  return (req, res, next) => {
    const key = req.ip || req.connection.remoteAddress;
    const now = Date.now();
    const windowStart = now - windowMs;

    // Clean up old entries
    if (requests.has(key)) {
      const userRequests = requests.get(key).filter(timestamp => timestamp > windowStart);
      requests.set(key, userRequests);
    } else {
      requests.set(key, []);
    }
    const userRequests = requests.get(key);

    // Check if limit exceeded
    if (userRequests.length >= max) {
      return res.status(429).json({
        status: 'error',
        message,
        retryAfter: Math.ceil(windowMs / 1000)
      });
    }

    // Add current request
    userRequests.push(now);
    requests.set(key, userRequests);
    next();
  };
};

/**
 * File upload validation
 * @param {Object} options - File validation options
 * @returns {Function} Express middleware function
 */
const fileValidation = (options = {}) => {
  const {
    maxSize = 5 * 1024 * 1024,
    // 5MB
    allowedTypes = ['image/jpeg', 'image/png', 'image/gif'],
    maxFiles = 1
  } = options;
  return (req, res, next) => {
    try {
      if (!req.files || req.files.length === 0) {
        return next();
      }
      const files = Array.isArray(req.files) ? req.files : [req.files];

      // Check number of files
      if (files.length > maxFiles) {
        const error = new ValidationError(`Maximum ${maxFiles} file(s) allowed`);
        return next(error);
      }

      // Validate each file
      for (const file of files) {
        // Check file size
        if (file.size > maxSize) {
          const error = new ValidationError(`File ${file.name} is too large. Maximum size is ${maxSize / 1024 / 1024}MB`);
          return next(error);
        }

        // Check file type
        if (!allowedTypes.includes(file.mimetype)) {
          const error = new ValidationError(`File type ${file.mimetype} is not allowed. Allowed types: ${allowedTypes.join(', ')}`);
          return next(error);
        }
      }
      next();
    } catch (err) {
      next(err);
    }
  };
};

/**
 * MongoDB ObjectId validation
 * @param {string} paramName - Parameter name to validate
 * @returns {Function} Express middleware function
 */
const validateObjectId = paramName => {
  return (req, res, next) => {
    try {
      const id = req.params[paramName];
      if (!id || !/^[0-9a-fA-F]{24}$/.test(id)) {
        const error = new ValidationError(`Invalid ${paramName} format`);
        return next(error);
      }
      next();
    } catch (err) {
      next(err);
    }
  };
};

/**
 * Pagination validation
 * @returns {Function} Express middleware function
 */
const validatePagination = () => {
  return (req, res, next) => {
    try {
      const page = parseInt(req.query.page, 10) || 1;
      const limit = parseInt(req.query.limit, 10) || 10;
      if (page < 1) {
        const error = new ValidationError('Page must be a positive integer');
        return next(error);
      }
      if (limit < 1 || limit > 100) {
        const error = new ValidationError('Limit must be between 1 and 100');
        return next(error);
      }
      req.pagination = {
        page,
        limit,
        skip: (page - 1) * limit
      };
      next();
    } catch (err) {
      next(err);
    }
  };
};
module.exports = {
  validate,
  sanitize,
  rateLimitValidation,
  fileValidation,
  validateObjectId,
  validatePagination
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2YWxpZGF0aW9uUmVzdWx0IiwicmVxdWlyZSIsIlZhbGlkYXRpb25FcnJvciIsInZhbGlkYXRlIiwidmFsaWRhdGlvbnMiLCJyZXEiLCJyZXMiLCJuZXh0IiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsInZhbGlkYXRpb24iLCJydW4iLCJlcnJvcnMiLCJpc0VtcHR5IiwiZXJyb3JNZXNzYWdlcyIsImFycmF5IiwiZXJyb3IiLCJtc2ciLCJlcnJvckRldGFpbHMiLCJmaWVsZCIsInBhcmFtIiwibWVzc2FnZSIsInZhbHVlIiwibG9jYXRpb24iLCJ2YWxpZGF0aW9uRXJyb3IiLCJqb2luIiwiZXJyIiwic2FuaXRpemUiLCJvcHRpb25zIiwicmVtb3ZlSHRtbCIsInJlbW92ZVNjcmlwdHMiLCJ0cmltU3RyaW5ncyIsImFsbG93ZWRUYWdzIiwibWF4TGVuZ3RoIiwic2FuaXRpemVTdHJpbmciLCJzdHIiLCJzYW5pdGl6ZWQiLCJ0cmltIiwicmVwbGFjZSIsImxlbmd0aCIsInN1YnN0cmluZyIsImJvZHkiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImtleSIsIkFycmF5IiwiaXNBcnJheSIsIml0ZW0iLCJxdWVyeSIsInBhcmFtcyIsInJhdGVMaW1pdFZhbGlkYXRpb24iLCJ3aW5kb3dNcyIsIm1heCIsInNraXBTdWNjZXNzZnVsUmVxdWVzdHMiLCJza2lwRmFpbGVkUmVxdWVzdHMiLCJyZXF1ZXN0cyIsIk1hcCIsImlwIiwiY29ubmVjdGlvbiIsInJlbW90ZUFkZHJlc3MiLCJub3ciLCJEYXRlIiwid2luZG93U3RhcnQiLCJoYXMiLCJ1c2VyUmVxdWVzdHMiLCJnZXQiLCJmaWx0ZXIiLCJ0aW1lc3RhbXAiLCJzZXQiLCJzdGF0dXMiLCJqc29uIiwicmV0cnlBZnRlciIsIk1hdGgiLCJjZWlsIiwicHVzaCIsImZpbGVWYWxpZGF0aW9uIiwibWF4U2l6ZSIsImFsbG93ZWRUeXBlcyIsIm1heEZpbGVzIiwiZmlsZXMiLCJmaWxlIiwic2l6ZSIsIm5hbWUiLCJpbmNsdWRlcyIsIm1pbWV0eXBlIiwidmFsaWRhdGVPYmplY3RJZCIsInBhcmFtTmFtZSIsImlkIiwidGVzdCIsInZhbGlkYXRlUGFnaW5hdGlvbiIsInBhZ2UiLCJwYXJzZUludCIsImxpbWl0IiwicGFnaW5hdGlvbiIsInNraXAiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsidmFsaWRhdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRpb25SZXN1bHQgfSA9IHJlcXVpcmUoJ2V4cHJlc3MtdmFsaWRhdG9yJyk7XG5jb25zdCB7IFZhbGlkYXRpb25FcnJvciB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvZXJyb3JzJyk7XG5cbi8qKlxuICogVmFsaWRhdGlvbiBtaWRkbGV3YXJlIGZhY3RvcnlcbiAqIEBwYXJhbSB7QXJyYXl9IHZhbGlkYXRpb25zIC0gQXJyYXkgb2YgdmFsaWRhdGlvbiBydWxlc1xuICogQHJldHVybnMge0Z1bmN0aW9ufSBFeHByZXNzIG1pZGRsZXdhcmUgZnVuY3Rpb25cbiAqL1xuY29uc3QgdmFsaWRhdGUgPSAodmFsaWRhdGlvbnMpID0+IHtcbiAgcmV0dXJuIGFzeW5jKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJ1biBhbGwgdmFsaWRhdGlvbnNcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKHZhbGlkYXRpb25zLm1hcCh2YWxpZGF0aW9uID0+IHZhbGlkYXRpb24ucnVuKHJlcSkpKTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIHZhbGlkYXRpb24gZXJyb3JzXG4gICAgICBjb25zdCBlcnJvcnMgPSB2YWxpZGF0aW9uUmVzdWx0KHJlcSk7XG5cbiAgICAgIGlmICghZXJyb3JzLmlzRW1wdHkoKSkge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID0gZXJyb3JzLmFycmF5KCkubWFwKGVycm9yID0+IGVycm9yLm1zZyk7XG4gICAgICAgIGNvbnN0IGVycm9yRGV0YWlscyA9IGVycm9ycy5hcnJheSgpLm1hcChlcnJvciA9PiAoe1xuICAgICAgICAgIGZpZWxkOiBlcnJvci5wYXJhbSxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tc2csXG4gICAgICAgICAgdmFsdWU6IGVycm9yLnZhbHVlLFxuICAgICAgICAgIGxvY2F0aW9uOiBlcnJvci5sb2NhdGlvblxuICAgICAgICB9KSk7XG5cbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbkVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICBgVmFsaWRhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JNZXNzYWdlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgZXJyb3JEZXRhaWxzXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIG5leHQodmFsaWRhdGlvbkVycm9yKTtcbiAgICAgIH1cblxuICAgICAgbmV4dCgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfTtcbn07XG5cbi8qKlxuICogU2FuaXRpemF0aW9uIG1pZGRsZXdhcmVcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIC0gU2FuaXRpemF0aW9uIG9wdGlvbnNcbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gRXhwcmVzcyBtaWRkbGV3YXJlIGZ1bmN0aW9uXG4gKi9cbmNvbnN0IHNhbml0aXplID0gKG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCB7XG4gICAgcmVtb3ZlSHRtbCA9IHRydWUsXG4gICAgcmVtb3ZlU2NyaXB0cyA9IHRydWUsXG4gICAgdHJpbVN0cmluZ3MgPSB0cnVlLFxuICAgIGFsbG93ZWRUYWdzID0gW10sXG4gICAgbWF4TGVuZ3RoID0gMTAwMFxuICB9ID0gb3B0aW9ucztcblxuICByZXR1cm4gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgY29uc3Qgc2FuaXRpemVTdHJpbmcgPSAoc3RyKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIHN0ciAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgIH1cblxuICAgICAgbGV0IHNhbml0aXplZCA9IHN0cjtcblxuICAgICAgLy8gVHJpbSB3aGl0ZXNwYWNlXG4gICAgICBpZiAodHJpbVN0cmluZ3MpIHtcbiAgICAgICAgc2FuaXRpemVkID0gc2FuaXRpemVkLnRyaW0oKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVtb3ZlIEhUTUwgdGFnc1xuICAgICAgaWYgKHJlbW92ZUh0bWwpIHtcbiAgICAgICAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoLzxbXj5dKj4vZywgJycpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZW1vdmUgc2NyaXB0IHRhZ3MgYW5kIGphdmFzY3JpcHQ6IHByb3RvY29sc1xuICAgICAgaWYgKHJlbW92ZVNjcmlwdHMpIHtcbiAgICAgICAgc2FuaXRpemVkID0gc2FuaXRpemVkXG4gICAgICAgICAgLnJlcGxhY2UoLzxzY3JpcHRcXGJbXjxdKig/Oig/ITxcXC9zY3JpcHQ+KTxbXjxdKikqPFxcL3NjcmlwdD4vZ2ksICcnKVxuICAgICAgICAgIC5yZXBsYWNlKC9qYXZhc2NyaXB0Oi9naSwgJycpXG4gICAgICAgICAgLnJlcGxhY2UoL29uXFx3K1xccyo9L2dpLCAnJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIExpbWl0IGxlbmd0aFxuICAgICAgaWYgKHNhbml0aXplZC5sZW5ndGggPiBtYXhMZW5ndGgpIHtcbiAgICAgICAgc2FuaXRpemVkID0gc2FuaXRpemVkLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gc2FuaXRpemVkO1xuICAgIH07XG5cbiAgICAvLyBTYW5pdGl6ZSByZXF1ZXN0IGJvZHlcbiAgICBpZiAocmVxLmJvZHkpIHtcbiAgICAgIE9iamVjdC5rZXlzKHJlcS5ib2R5KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVxLmJvZHlba2V5XSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXEuYm9keVtrZXldID0gc2FuaXRpemVTdHJpbmcocmVxLmJvZHlba2V5XSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZXEuYm9keVtrZXldKSkge1xuICAgICAgICAgIHJlcS5ib2R5W2tleV0gPSByZXEuYm9keVtrZXldLm1hcChpdGVtID0+XG4gICAgICAgICAgICB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgPyBzYW5pdGl6ZVN0cmluZyhpdGVtKSA6IGl0ZW1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTYW5pdGl6ZSBxdWVyeSBwYXJhbWV0ZXJzXG4gICAgaWYgKHJlcS5xdWVyeSkge1xuICAgICAgT2JqZWN0LmtleXMocmVxLnF1ZXJ5KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVxLnF1ZXJ5W2tleV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmVxLnF1ZXJ5W2tleV0gPSBzYW5pdGl6ZVN0cmluZyhyZXEucXVlcnlba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFNhbml0aXplIFVSTCBwYXJhbWV0ZXJzXG4gICAgaWYgKHJlcS5wYXJhbXMpIHtcbiAgICAgIE9iamVjdC5rZXlzKHJlcS5wYXJhbXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiByZXEucGFyYW1zW2tleV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmVxLnBhcmFtc1trZXldID0gc2FuaXRpemVTdHJpbmcocmVxLnBhcmFtc1trZXldKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgbmV4dCgpO1xuICB9O1xufTtcblxuLyoqXG4gKiBSYXRlIGxpbWl0aW5nIHZhbGlkYXRpb25cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIC0gUmF0ZSBsaW1pdGluZyBvcHRpb25zXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEV4cHJlc3MgbWlkZGxld2FyZSBmdW5jdGlvblxuICovXG5jb25zdCByYXRlTGltaXRWYWxpZGF0aW9uID0gKG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCB7XG4gICAgd2luZG93TXMgPSAxNSAqIDYwICogMTAwMCwgLy8gMTUgbWludXRlc1xuICAgIG1heCA9IDEwMCwgLy8gbGltaXQgZWFjaCBJUCB0byAxMDAgcmVxdWVzdHMgcGVyIHdpbmRvd01zXG4gICAgbWVzc2FnZSA9ICdUb28gbWFueSByZXF1ZXN0cyBmcm9tIHRoaXMgSVAsIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcbiAgICBza2lwU3VjY2Vzc2Z1bFJlcXVlc3RzID0gZmFsc2UsXG4gICAgc2tpcEZhaWxlZFJlcXVlc3RzID0gZmFsc2VcbiAgfSA9IG9wdGlvbnM7XG5cbiAgY29uc3QgcmVxdWVzdHMgPSBuZXcgTWFwKCk7XG5cbiAgcmV0dXJuIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGNvbnN0IGtleSA9IHJlcS5pcCB8fCByZXEuY29ubmVjdGlvbi5yZW1vdGVBZGRyZXNzO1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgY29uc3Qgd2luZG93U3RhcnQgPSBub3cgLSB3aW5kb3dNcztcblxuICAgIC8vIENsZWFuIHVwIG9sZCBlbnRyaWVzXG4gICAgaWYgKHJlcXVlc3RzLmhhcyhrZXkpKSB7XG4gICAgICBjb25zdCB1c2VyUmVxdWVzdHMgPSByZXF1ZXN0cy5nZXQoa2V5KS5maWx0ZXIodGltZXN0YW1wID0+IHRpbWVzdGFtcCA+IHdpbmRvd1N0YXJ0KTtcbiAgICAgIHJlcXVlc3RzLnNldChrZXksIHVzZXJSZXF1ZXN0cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcXVlc3RzLnNldChrZXksIFtdKTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2VyUmVxdWVzdHMgPSByZXF1ZXN0cy5nZXQoa2V5KTtcblxuICAgIC8vIENoZWNrIGlmIGxpbWl0IGV4Y2VlZGVkXG4gICAgaWYgKHVzZXJSZXF1ZXN0cy5sZW5ndGggPj0gbWF4KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MjkpLmpzb24oe1xuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbCh3aW5kb3dNcyAvIDEwMDApXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgY3VycmVudCByZXF1ZXN0XG4gICAgdXNlclJlcXVlc3RzLnB1c2gobm93KTtcbiAgICByZXF1ZXN0cy5zZXQoa2V5LCB1c2VyUmVxdWVzdHMpO1xuXG4gICAgbmV4dCgpO1xuICB9O1xufTtcblxuLyoqXG4gKiBGaWxlIHVwbG9hZCB2YWxpZGF0aW9uXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIEZpbGUgdmFsaWRhdGlvbiBvcHRpb25zXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEV4cHJlc3MgbWlkZGxld2FyZSBmdW5jdGlvblxuICovXG5jb25zdCBmaWxlVmFsaWRhdGlvbiA9IChvcHRpb25zID0ge30pID0+IHtcbiAgY29uc3Qge1xuICAgIG1heFNpemUgPSA1ICogMTAyNCAqIDEwMjQsIC8vIDVNQlxuICAgIGFsbG93ZWRUeXBlcyA9IFsnaW1hZ2UvanBlZycsICdpbWFnZS9wbmcnLCAnaW1hZ2UvZ2lmJ10sXG4gICAgbWF4RmlsZXMgPSAxXG4gIH0gPSBvcHRpb25zO1xuXG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFyZXEuZmlsZXMgfHwgcmVxLmZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmaWxlcyA9IEFycmF5LmlzQXJyYXkocmVxLmZpbGVzKSA/IHJlcS5maWxlcyA6IFtyZXEuZmlsZXNdO1xuXG4gICAgICAvLyBDaGVjayBudW1iZXIgb2YgZmlsZXNcbiAgICAgIGlmIChmaWxlcy5sZW5ndGggPiBtYXhGaWxlcykge1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoYE1heGltdW0gJHttYXhGaWxlc30gZmlsZShzKSBhbGxvd2VkYCk7XG4gICAgICAgIHJldHVybiBuZXh0KGVycm9yKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgZWFjaCBmaWxlXG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgLy8gQ2hlY2sgZmlsZSBzaXplXG4gICAgICAgIGlmIChmaWxlLnNpemUgPiBtYXhTaXplKSB7XG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVmFsaWRhdGlvbkVycm9yKGBGaWxlICR7ZmlsZS5uYW1lfSBpcyB0b28gbGFyZ2UuIE1heGltdW0gc2l6ZSBpcyAke21heFNpemUgLyAxMDI0IC8gMTAyNH1NQmApO1xuICAgICAgICAgIHJldHVybiBuZXh0KGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGZpbGUgdHlwZVxuICAgICAgICBpZiAoIWFsbG93ZWRUeXBlcy5pbmNsdWRlcyhmaWxlLm1pbWV0eXBlKSkge1xuICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcihgRmlsZSB0eXBlICR7ZmlsZS5taW1ldHlwZX0gaXMgbm90IGFsbG93ZWQuIEFsbG93ZWQgdHlwZXM6ICR7YWxsb3dlZFR5cGVzLmpvaW4oJywgJyl9YCk7XG4gICAgICAgICAgcmV0dXJuIG5leHQoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIG5leHQoKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH07XG59O1xuXG4vKipcbiAqIE1vbmdvREIgT2JqZWN0SWQgdmFsaWRhdGlvblxuICogQHBhcmFtIHtzdHJpbmd9IHBhcmFtTmFtZSAtIFBhcmFtZXRlciBuYW1lIHRvIHZhbGlkYXRlXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEV4cHJlc3MgbWlkZGxld2FyZSBmdW5jdGlvblxuICovXG5jb25zdCB2YWxpZGF0ZU9iamVjdElkID0gKHBhcmFtTmFtZSkgPT4ge1xuICByZXR1cm4gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGlkID0gcmVxLnBhcmFtc1twYXJhbU5hbWVdO1xuXG4gICAgICBpZiAoIWlkIHx8ICEvXlswLTlhLWZBLUZdezI0fSQvLnRlc3QoaWQpKSB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcihgSW52YWxpZCAke3BhcmFtTmFtZX0gZm9ybWF0YCk7XG4gICAgICAgIHJldHVybiBuZXh0KGVycm9yKTtcbiAgICAgIH1cblxuICAgICAgbmV4dCgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfTtcbn07XG5cbi8qKlxuICogUGFnaW5hdGlvbiB2YWxpZGF0aW9uXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEV4cHJlc3MgbWlkZGxld2FyZSBmdW5jdGlvblxuICovXG5jb25zdCB2YWxpZGF0ZVBhZ2luYXRpb24gPSAoKSA9PiB7XG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFnZSA9IHBhcnNlSW50KHJlcS5xdWVyeS5wYWdlLCAxMCkgfHwgMTtcbiAgICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQocmVxLnF1ZXJ5LmxpbWl0LCAxMCkgfHwgMTA7XG5cbiAgICAgIGlmIChwYWdlIDwgMSkge1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ1BhZ2UgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXInKTtcbiAgICAgICAgcmV0dXJuIG5leHQoZXJyb3IpO1xuICAgICAgfVxuXG4gICAgICBpZiAobGltaXQgPCAxIHx8IGxpbWl0ID4gMTAwKSB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcignTGltaXQgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDEwMCcpO1xuICAgICAgICByZXR1cm4gbmV4dChlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIHJlcS5wYWdpbmF0aW9uID0ge1xuICAgICAgICBwYWdlLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgc2tpcDogKHBhZ2UgLSAxKSAqIGxpbWl0XG4gICAgICB9O1xuXG4gICAgICBuZXh0KCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZhbGlkYXRlLFxuICBzYW5pdGl6ZSxcbiAgcmF0ZUxpbWl0VmFsaWRhdGlvbixcbiAgZmlsZVZhbGlkYXRpb24sXG4gIHZhbGlkYXRlT2JqZWN0SWQsXG4gIHZhbGlkYXRlUGFnaW5hdGlvblxufTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBRUE7QUFBaUIsQ0FBQyxHQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFDekQsTUFBTTtFQUFFQztBQUFnQixDQUFDLEdBQUdELE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7QUFFdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1FLFFBQVEsR0FBSUMsV0FBVyxJQUFLO0VBQ2hDLE9BQU8sT0FBTUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUM5QixJQUFJO01BQ0Y7TUFDQSxNQUFNQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0wsV0FBVyxDQUFDTSxHQUFHLENBQUNDLFVBQVUsSUFBSUEsVUFBVSxDQUFDQyxHQUFHLENBQUNQLEdBQUcsQ0FBQyxDQUFDLENBQUM7O01BRXJFO01BQ0EsTUFBTVEsTUFBTSxHQUFHYixnQkFBZ0IsQ0FBQ0ssR0FBRyxDQUFDO01BRXBDLElBQUksQ0FBQ1EsTUFBTSxDQUFDQyxPQUFPLENBQUMsQ0FBQyxFQUFFO1FBQ3JCLE1BQU1DLGFBQWEsR0FBR0YsTUFBTSxDQUFDRyxLQUFLLENBQUMsQ0FBQyxDQUFDTixHQUFHLENBQUNPLEtBQUssSUFBSUEsS0FBSyxDQUFDQyxHQUFHLENBQUM7UUFDNUQsTUFB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