d6ae685bd4254993fe234a9e99cfa5fc
const request = require('supertest');
const app = require('./app.test');
const {
  setupTestEnvironment,
  cleanupTestEnvironment,
  expectSuccessResponse
} = require('./setup');
describe('Health Check API', () => {
  beforeAll(async () => {
    await setupTestEnvironment();
  });
  afterAll(async () => {
    await cleanupTestEnvironment();
  });
  describe('GET /health', () => {
    it('should return health status successfully', async () => {
      const response = await request(app).get('/health').expect(200);
      expect(response.body).toHaveProperty('status');
      expect(response.body).toHaveProperty('timestamp');
      expect(response.body).toHaveProperty('uptime');
      expect(response.body).toHaveProperty('environment');
      expect(response.body.status).toBe('ok');
    });
    it('should include basic service information', async () => {
      const response = await request(app).get('/health').expect(200);
      expect(response.body).toHaveProperty('service');
      expect(response.body).toHaveProperty('version');
      expect(response.body.service).toBe('tripvar-server');
      expect(response.body.version).toBeDefined();
    });
    it('should check database status via dedicated endpoint', async () => {
      const response = await request(app).get('/health/db').expect(200);
      expect(response.body).toHaveProperty('status');
      expect(response.body).toHaveProperty('database');
    });
    it('should check Redis status via dedicated endpoint', async () => {
      const response = await request(app).get('/health/redis').expect(200);
      expect(response.body).toHaveProperty('status');
      expect(response.body).toHaveProperty('redis');
    });
    it('should include environment information', async () => {
      const response = await request(app).get('/health').expect(200);
      expect(response.body).toHaveProperty('environment');
      expect(response.body.environment).toBe('test');
    });
  });
  describe('GET /health/all', () => {
    it('should return comprehensive health information', async () => {
      const response = await request(app).get('/health/all').expect(200);
      expect(response.body).toHaveProperty('status');
      expect(response.body).toHaveProperty('timestamp');
    });
    it('should include system metrics', async () => {
      const response = await request(app).get('/health/metrics').expect(200);
      expect(response.body).toHaveProperty('system');
      expect(response.body).toHaveProperty('timestamp');
    });
    it('should include database status in comprehensive check', async () => {
      const response = await request(app).get('/health/all').expect(200);
      expect(response.body).toHaveProperty('services');
      expect(response.body.services).toHaveProperty('mongodb');
    });
    it('should include Redis status in comprehensive check', async () => {
      const response = await request(app).get('/health/all').expect(200);
      expect(response.body).toHaveProperty('services');
      expect(response.body.services).toHaveProperty('redis');
    });
  });
  describe('GET /health/ready', () => {
    it('should return ready status', async () => {
      const response = await request(app).get('/health/ready').expect(200);
      expect(response.body).toHaveProperty('status');
      expect(response.body).toHaveProperty('services');
      expect(response.body.status).toBe('ready');
    });
    it('should include service readiness checks', async () => {
      const response = await request(app).get('/health/ready').expect(200);
      expect(response.body).toHaveProperty('services');
      expect(response.body.services).toHaveProperty('database');
      expect(response.body.services).toHaveProperty('redis');
    });
  });
  describe('GET /health/live', () => {
    it('should return liveness status', async () => {
      const response = await request(app).get('/health/live').expect(200);
      expect(response.body).toHaveProperty('status');
      expect(response.body).toHaveProperty('uptime');
      expect(response.body.status).toBe('alive');
    });
    it('should include uptime information', async () => {
      const response = await request(app).get('/health/live').expect(200);
      expect(response.body).toHaveProperty('uptime');
      expect(typeof response.body.uptime).toBe('number');
    });
  });
  describe('Health Check Error Handling', () => {
    it('should handle database connection errors gracefully', async () => {
      // This test would require mocking the database connection
      // For now, we'll test that the health endpoint responds
      const response = await request(app).get('/health').expect(200);
      expect(response.body).toHaveProperty('status');
    });
    it('should handle Redis connection errors gracefully', async () => {
      // This test would require mocking the Redis connection
      // For now, we'll test that the health endpoint responds
      const response = await request(app).get('/health').expect(200);
      expect(response.body).toHaveProperty('status');
    });
  });
  describe('Health Check Performance', () => {
    it('should respond quickly to health checks', async () => {
      const startTime = Date.now();
      const response = await request(app).get('/health').expect(200);
      const endTime = Date.now();
      const responseTime = endTime - startTime;

      // Health checks should respond within 100ms
      expect(responseTime).toBeLessThan(100);
      expect(response.body.status).toBe('ok');
    });
    it('should handle multiple concurrent health checks', async () => {
      const promises = Array(10).fill().map(() => request(app).get('/health'));
      const responses = await Promise.all(promises);
      responses.forEach(response => {
        expect(response.status).toBe(200);
        expect(response.body.status).toBe('ok');
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0IiwicmVxdWlyZSIsImFwcCIsInNldHVwVGVzdEVudmlyb25tZW50IiwiY2xlYW51cFRlc3RFbnZpcm9ubWVudCIsImV4cGVjdFN1Y2Nlc3NSZXNwb25zZSIsImRlc2NyaWJlIiwiYmVmb3JlQWxsIiwiYWZ0ZXJBbGwiLCJpdCIsInJlc3BvbnNlIiwiZ2V0IiwiZXhwZWN0IiwiYm9keSIsInRvSGF2ZVByb3BlcnR5Iiwic3RhdHVzIiwidG9CZSIsInNlcnZpY2UiLCJ2ZXJzaW9uIiwidG9CZURlZmluZWQiLCJlbnZpcm9ubWVudCIsInNlcnZpY2VzIiwidXB0aW1lIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImVuZFRpbWUiLCJyZXNwb25zZVRpbWUiLCJ0b0JlTGVzc1RoYW4iLCJwcm9taXNlcyIsIkFycmF5IiwiZmlsbCIsIm1hcCIsInJlc3BvbnNlcyIsIlByb21pc2UiLCJhbGwiLCJmb3JFYWNoIl0sInNvdXJjZXMiOlsiaGVhbHRoLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpO1xuY29uc3QgYXBwID0gcmVxdWlyZSgnLi9hcHAudGVzdCcpO1xuY29uc3Qge1xuICBzZXR1cFRlc3RFbnZpcm9ubWVudCxcbiAgY2xlYW51cFRlc3RFbnZpcm9ubWVudCxcbiAgZXhwZWN0U3VjY2Vzc1Jlc3BvbnNlXG59ID0gcmVxdWlyZSgnLi9zZXR1cCcpO1xuXG5kZXNjcmliZSgnSGVhbHRoIENoZWNrIEFQSScsICgpID0+IHtcbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBzZXR1cFRlc3RFbnZpcm9ubWVudCgpO1xuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY2xlYW51cFRlc3RFbnZpcm9ubWVudCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9oZWFsdGgnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gaGVhbHRoIHN0YXR1cyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvaGVhbHRoJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N0YXR1cycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd0aW1lc3RhbXAnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndXB0aW1lJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2Vudmlyb25tZW50Jyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdGF0dXMpLnRvQmUoJ29rJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgYmFzaWMgc2VydmljZSBpbmZvcm1hdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc2VydmljZScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd2ZXJzaW9uJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zZXJ2aWNlKS50b0JlKCd0cmlwdmFyLXNlcnZlcicpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkudmVyc2lvbikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2hlY2sgZGF0YWJhc2Ugc3RhdHVzIHZpYSBkZWRpY2F0ZWQgZW5kcG9pbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvaGVhbHRoL2RiJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N0YXR1cycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdkYXRhYmFzZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjaGVjayBSZWRpcyBzdGF0dXMgdmlhIGRlZGljYXRlZCBlbmRwb2ludCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgvcmVkaXMnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3JlZGlzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgZW52aXJvbm1lbnQgaW5mb3JtYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvaGVhbHRoJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2Vudmlyb25tZW50Jyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lbnZpcm9ubWVudCkudG9CZSgndGVzdCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9oZWFsdGgvYWxsJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbXByZWhlbnNpdmUgaGVhbHRoIGluZm9ybWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2hlYWx0aC9hbGwnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3RpbWVzdGFtcCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIHN5c3RlbSBtZXRyaWNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2hlYWx0aC9tZXRyaWNzJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N5c3RlbScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd0aW1lc3RhbXAnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBkYXRhYmFzZSBzdGF0dXMgaW4gY29tcHJlaGVuc2l2ZSBjaGVjaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgvYWxsJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3NlcnZpY2VzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zZXJ2aWNlcykudG9IYXZlUHJvcGVydHkoJ21vbmdvZGInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBSZWRpcyBzdGF0dXMgaW4gY29tcHJlaGVuc2l2ZSBjaGVjaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgvYWxsJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3NlcnZpY2VzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zZXJ2aWNlcykudG9IYXZlUHJvcGVydHkoJ3JlZGlzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2hlYWx0aC9yZWFkeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiByZWFkeSBzdGF0dXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvaGVhbHRoL3JlYWR5JylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N0YXR1cycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdzZXJ2aWNlcycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3RhdHVzKS50b0JlKCdyZWFkeScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIHNlcnZpY2UgcmVhZGluZXNzIGNoZWNrcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgvcmVhZHknKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc2VydmljZXMnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnNlcnZpY2VzKS50b0hhdmVQcm9wZXJ0eSgnZGF0YWJhc2UnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnNlcnZpY2VzKS50b0hhdmVQcm9wZXJ0eSgncmVkaXMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvaGVhbHRoL2xpdmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbGl2ZW5lc3Mgc3RhdHVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2hlYWx0aC9saXZlJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N0YXR1cycpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd1cHRpbWUnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN0YXR1cykudG9CZSgnYWxpdmUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSB1cHRpbWUgaW5mb3JtYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvaGVhbHRoL2xpdmUnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndXB0aW1lJyk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3BvbnNlLmJvZHkudXB0aW1lKS50b0JlKCdudW1iZXInKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0hlYWx0aCBDaGVjayBFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBjb25uZWN0aW9uIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGhpcyB0ZXN0IHdvdWxkIHJlcXVpcmUgbW9ja2luZyB0aGUgZGF0YWJhc2UgY29ubmVjdGlvblxuICAgICAgLy8gRm9yIG5vdywgd2UnbGwgdGVzdCB0aGF0IHRoZSBoZWFsdGggZW5kcG9pbnQgcmVzcG9uZHNcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBSZWRpcyBjb25uZWN0aW9uIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGhpcyB0ZXN0IHdvdWxkIHJlcXVpcmUgbW9ja2luZyB0aGUgUmVkaXMgY29ubmVjdGlvblxuICAgICAgLy8gRm9yIG5vdywgd2UnbGwgdGVzdCB0aGF0IHRoZSBoZWFsdGggZW5kcG9pbnQgcmVzcG9uZHNcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdIZWFsdGggQ2hlY2sgUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXNwb25kIHF1aWNrbHkgdG8gaGVhbHRoIGNoZWNrcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVzcG9uc2VUaW1lID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gSGVhbHRoIGNoZWNrcyBzaG91bGQgcmVzcG9uZCB3aXRoaW4gMTAwbXNcbiAgICAgIGV4cGVjdChyZXNwb25zZVRpbWUpLnRvQmVMZXNzVGhhbigxMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3RhdHVzKS50b0JlKCdvaycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbXVsdGlwbGUgY29uY3VycmVudCBoZWFsdGggY2hlY2tzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvbWlzZXMgPSBBcnJheSgxMCkuZmlsbCgpLm1hcCgoKSA9PlxuICAgICAgICByZXF1ZXN0KGFwcCkuZ2V0KCcvaGVhbHRoJylcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblxuICAgICAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN0YXR1cykudG9CZSgnb2snKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ3BDLE1BQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLFlBQVksQ0FBQztBQUNqQyxNQUFNO0VBQ0pFLG9CQUFvQjtFQUNwQkMsc0JBQXNCO0VBQ3RCQztBQUNGLENBQUMsR0FBR0osT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUV0QkssUUFBUSxDQUFDLGtCQUFrQixFQUFFLE1BQU07RUFDakNDLFNBQVMsQ0FBQyxZQUFZO0lBQ3BCLE1BQU1KLG9CQUFvQixDQUFDLENBQUM7RUFDOUIsQ0FBQyxDQUFDO0VBRUZLLFFBQVEsQ0FBQyxZQUFZO0lBQ25C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