a5dd77c103ef87dc68d535ca554fd7b9
const {
  redisUtils
} = require('../config/redis');
const {
  info,
  error
} = require('../utils/logger');

/**
 * Redis caching middleware
 * @param {Object} options - Cache options
 * @param {string} options.key - Cache key (can be a function that receives req)
 * @param {number} options.ttl - Time to live in seconds (default: 3600)
 * @param {boolean} options.skipCache - Skip cache for certain conditions
 * @returns {Function} Express middleware function
 */
const redisCache = (options = {}) => {
  const {
    key,
    ttl = 3600,
    skipCache = false
  } = options;
  return async (req, res, next) => {
    // Skip caching if requested
    if (skipCache || req.query.skipCache === 'true') {
      return next();
    }
    try {
      // Generate cache key
      let cacheKey;
      if (typeof key === 'function') {
        cacheKey = key(req);
      } else if (key) {
        cacheKey = key;
      } else {
        // Default cache key based on URL and query params
        cacheKey = `cache:${req.method}:${req.originalUrl}`;
      }

      // Try to get from cache
      const cachedData = await redisUtils.getCache(cacheKey);
      if (cachedData) {
        info('Cache hit', {
          key: cacheKey,
          path: req.path
        });
        return res.json({
          ...cachedData,
          _cached: true,
          _cacheKey: cacheKey
        });
      }

      // Cache miss - continue to route handler
      info('Cache miss', {
        key: cacheKey,
        path: req.path
      });

      // Store original res.json to intercept response
      const originalJson = res.json;
      res.json = function (data) {
        // Cache the response (async, don't wait)
        redisUtils.setCache(cacheKey, data, ttl).catch(err => {
          error('Failed to cache response', {
            error: err.message,
            cacheKey
          });
        });

        // Call original json method
        return originalJson.call(this, data);
      };
      next();
    } catch (err) {
      // If Redis fails, continue without caching
      error('Redis cache middleware error', {
        error: err.message,
        stack: err.stack
      });
      next();
    }
  };
};

/**
 * Invalidate cache by key pattern
 * @param {string} pattern - Key pattern to invalidate
 */
const invalidateCache = async pattern => {
  try {
    const {
      getRedisClient
    } = require('../config/redis');
    const client = getRedisClient();
    const keys = await client.keys(pattern);
    if (keys.length > 0) {
      await client.del(...keys);
      info('Cache invalidated', {
        pattern,
        keysCount: keys.length
      });
    }
  } catch (err) {
    error('Failed to invalidate cache', {
      error: err.message,
      pattern
    });
  }
};

/**
 * Session middleware using Redis
 */
const redisSession = (options = {}) => {
  const {
    ttl = 86400
  } = options; // 24 hours default

  return async (req, res, next) => {
    try {
      // Get session ID from cookie or header
      const sessionId = req.cookies?.sessionId || req.headers['x-session-id'];
      if (sessionId) {
        const sessionData = await redisUtils.getSession(sessionId);
        if (sessionData) {
          req.session = sessionData;
        }
      }

      // Add session methods to response
      res.setSession = async data => {
        const newSessionId = sessionId || require('crypto').randomUUID();
        await redisUtils.setSession(newSessionId, data, ttl);
        res.cookie('sessionId', newSessionId, {
          httpOnly: true,
          secure: process.env.NODE_ENV === 'production',
          maxAge: ttl * 1000
        });
        req.session = data;
        return newSessionId;
      };
      res.clearSession = async () => {
        if (sessionId) {
          await redisUtils.deleteSession(sessionId);
          res.clearCookie('sessionId');
          delete req.session;
        }
      };
      next();
    } catch (err) {
      error('Redis session middleware error', {
        error: err.message,
        stack: err.stack
      });
      next();
    }
  };
};
module.exports = {
  redisCache,
  invalidateCache,
  redisSession
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZWRpc1V0aWxzIiwicmVxdWlyZSIsImluZm8iLCJlcnJvciIsInJlZGlzQ2FjaGUiLCJvcHRpb25zIiwia2V5IiwidHRsIiwic2tpcENhY2hlIiwicmVxIiwicmVzIiwibmV4dCIsInF1ZXJ5IiwiY2FjaGVLZXkiLCJtZXRob2QiLCJvcmlnaW5hbFVybCIsImNhY2hlZERhdGEiLCJnZXRDYWNoZSIsInBhdGgiLCJqc29uIiwiX2NhY2hlZCIsIl9jYWNoZUtleSIsIm9yaWdpbmFsSnNvbiIsImRhdGEiLCJzZXRDYWNoZSIsImNhdGNoIiwiZXJyIiwibWVzc2FnZSIsImNhbGwiLCJzdGFjayIsImludmFsaWRhdGVDYWNoZSIsInBhdHRlcm4iLCJnZXRSZWRpc0NsaWVudCIsImNsaWVudCIsImtleXMiLCJsZW5ndGgiLCJkZWwiLCJrZXlzQ291bnQiLCJyZWRpc1Nlc3Npb24iLCJzZXNzaW9uSWQiLCJjb29raWVzIiwiaGVhZGVycyIsInNlc3Npb25EYXRhIiwiZ2V0U2Vzc2lvbiIsInNlc3Npb24iLCJzZXRTZXNzaW9uIiwibmV3U2Vzc2lvbklkIiwicmFuZG9tVVVJRCIsImNvb2tpZSIsImh0dHBPbmx5Iiwic2VjdXJlIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwibWF4QWdlIiwiY2xlYXJTZXNzaW9uIiwiZGVsZXRlU2Vzc2lvbiIsImNsZWFyQ29va2llIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInJlZGlzQ2FjaGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyByZWRpc1V0aWxzIH0gPSByZXF1aXJlKCcuLi9jb25maWcvcmVkaXMnKTtcbmNvbnN0IHsgaW5mbywgZXJyb3IgfSA9IHJlcXVpcmUoJy4uL3V0aWxzL2xvZ2dlcicpO1xuXG4vKipcbiAqIFJlZGlzIGNhY2hpbmcgbWlkZGxld2FyZVxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBDYWNoZSBvcHRpb25zXG4gKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy5rZXkgLSBDYWNoZSBrZXkgKGNhbiBiZSBhIGZ1bmN0aW9uIHRoYXQgcmVjZWl2ZXMgcmVxKVxuICogQHBhcmFtIHtudW1iZXJ9IG9wdGlvbnMudHRsIC0gVGltZSB0byBsaXZlIGluIHNlY29uZHMgKGRlZmF1bHQ6IDM2MDApXG4gKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMuc2tpcENhY2hlIC0gU2tpcCBjYWNoZSBmb3IgY2VydGFpbiBjb25kaXRpb25zXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEV4cHJlc3MgbWlkZGxld2FyZSBmdW5jdGlvblxuICovXG5jb25zdCByZWRpc0NhY2hlID0gKG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCB7IGtleSwgdHRsID0gMzYwMCwgc2tpcENhY2hlID0gZmFsc2UgfSA9IG9wdGlvbnM7XG5cbiAgcmV0dXJuIGFzeW5jKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgLy8gU2tpcCBjYWNoaW5nIGlmIHJlcXVlc3RlZFxuICAgIGlmIChza2lwQ2FjaGUgfHwgcmVxLnF1ZXJ5LnNraXBDYWNoZSA9PT0gJ3RydWUnKSB7XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBHZW5lcmF0ZSBjYWNoZSBrZXlcbiAgICAgIGxldCBjYWNoZUtleTtcbiAgICAgIGlmICh0eXBlb2Yga2V5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNhY2hlS2V5ID0ga2V5KHJlcSk7XG4gICAgICB9IGVsc2UgaWYgKGtleSkge1xuICAgICAgICBjYWNoZUtleSA9IGtleTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIERlZmF1bHQgY2FjaGUga2V5IGJhc2VkIG9uIFVSTCBhbmQgcXVlcnkgcGFyYW1zXG4gICAgICAgIGNhY2hlS2V5ID0gYGNhY2hlOiR7cmVxLm1ldGhvZH06JHtyZXEub3JpZ2luYWxVcmx9YDtcbiAgICAgIH1cblxuICAgICAgLy8gVHJ5IHRvIGdldCBmcm9tIGNhY2hlXG4gICAgICBjb25zdCBjYWNoZWREYXRhID0gYXdhaXQgcmVkaXNVdGlscy5nZXRDYWNoZShjYWNoZUtleSk7XG5cbiAgICAgIGlmIChjYWNoZWREYXRhKSB7XG4gICAgICAgIGluZm8oJ0NhY2hlIGhpdCcsIHsga2V5OiBjYWNoZUtleSwgcGF0aDogcmVxLnBhdGggfSk7XG4gICAgICAgIHJldHVybiByZXMuanNvbih7XG4gICAgICAgICAgLi4uY2FjaGVkRGF0YSxcbiAgICAgICAgICBfY2FjaGVkOiB0cnVlLFxuICAgICAgICAgIF9jYWNoZUtleTogY2FjaGVLZXlcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENhY2hlIG1pc3MgLSBjb250aW51ZSB0byByb3V0ZSBoYW5kbGVyXG4gICAgICBpbmZvKCdDYWNoZSBtaXNzJywgeyBrZXk6IGNhY2hlS2V5LCBwYXRoOiByZXEucGF0aCB9KTtcblxuICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgcmVzLmpzb24gdG8gaW50ZXJjZXB0IHJlc3BvbnNlXG4gICAgICBjb25zdCBvcmlnaW5hbEpzb24gPSByZXMuanNvbjtcbiAgICAgIHJlcy5qc29uID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAvLyBDYWNoZSB0aGUgcmVzcG9uc2UgKGFzeW5jLCBkb24ndCB3YWl0KVxuICAgICAgICByZWRpc1V0aWxzLnNldENhY2hlKGNhY2hlS2V5LCBkYXRhLCB0dGwpLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgZXJyb3IoJ0ZhaWxlZCB0byBjYWNoZSByZXNwb25zZScsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCBjYWNoZUtleSB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2FsbCBvcmlnaW5hbCBqc29uIG1ldGhvZFxuICAgICAgICByZXR1cm4gb3JpZ2luYWxKc29uLmNhbGwodGhpcywgZGF0YSk7XG4gICAgICB9O1xuXG4gICAgICBuZXh0KCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBJZiBSZWRpcyBmYWlscywgY29udGludWUgd2l0aG91dCBjYWNoaW5nXG4gICAgICBlcnJvcignUmVkaXMgY2FjaGUgbWlkZGxld2FyZSBlcnJvcicsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCBzdGFjazogZXJyLnN0YWNrIH0pO1xuICAgICAgbmV4dCgpO1xuICAgIH1cbiAgfTtcbn07XG5cbi8qKlxuICogSW52YWxpZGF0ZSBjYWNoZSBieSBrZXkgcGF0dGVyblxuICogQHBhcmFtIHtzdHJpbmd9IHBhdHRlcm4gLSBLZXkgcGF0dGVybiB0byBpbnZhbGlkYXRlXG4gKi9cbmNvbnN0IGludmFsaWRhdGVDYWNoZSA9IGFzeW5jKHBhdHRlcm4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGdldFJlZGlzQ2xpZW50IH0gPSByZXF1aXJlKCcuLi9jb25maWcvcmVkaXMnKTtcbiAgICBjb25zdCBjbGllbnQgPSBnZXRSZWRpc0NsaWVudCgpO1xuICAgIGNvbnN0IGtleXMgPSBhd2FpdCBjbGllbnQua2V5cyhwYXR0ZXJuKTtcblxuICAgIGlmIChrZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgIGF3YWl0IGNsaWVudC5kZWwoLi4ua2V5cyk7XG4gICAgICBpbmZvKCdDYWNoZSBpbnZhbGlkYXRlZCcsIHsgcGF0dGVybiwga2V5c0NvdW50OiBrZXlzLmxlbmd0aCB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGVycm9yKCdGYWlsZWQgdG8gaW52YWxpZGF0ZSBjYWNoZScsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCBwYXR0ZXJuIH0pO1xuICB9XG59O1xuXG4vKipcbiAqIFNlc3Npb24gbWlkZGxld2FyZSB1c2luZyBSZWRpc1xuICovXG5jb25zdCByZWRpc1Nlc3Npb24gPSAob3B0aW9ucyA9IHt9KSA9PiB7XG4gIGNvbnN0IHsgdHRsID0gODY0MDAgfSA9IG9wdGlvbnM7IC8vIDI0IGhvdXJzIGRlZmF1bHRcblxuICByZXR1cm4gYXN5bmMocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHNlc3Npb24gSUQgZnJvbSBjb29raWUgb3IgaGVhZGVyXG4gICAgICBjb25zdCBzZXNzaW9uSWQgPSByZXEuY29va2llcz8uc2Vzc2lvbklkIHx8IHJlcS5oZWFkZXJzWyd4LXNlc3Npb24taWQnXTtcblxuICAgICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgICBjb25zdCBzZXNzaW9uRGF0YSA9IGF3YWl0IHJlZGlzVXRpbHMuZ2V0U2Vzc2lvbihzZXNzaW9uSWQpO1xuICAgICAgICBpZiAoc2Vzc2lvbkRhdGEpIHtcbiAgICAgICAgICByZXEuc2Vzc2lvbiA9IHNlc3Npb25EYXRhO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCBzZXNzaW9uIG1ldGhvZHMgdG8gcmVzcG9uc2VcbiAgICAgIHJlcy5zZXRTZXNzaW9uID0gYXN5bmMoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBuZXdTZXNzaW9uSWQgPSBzZXNzaW9uSWQgfHwgcmVxdWlyZSgnY3J5cHRvJykucmFuZG9tVVVJRCgpO1xuICAgICAgICBhd2FpdCByZWRpc1V0aWxzLnNldFNlc3Npb24obmV3U2Vzc2lvbklkLCBkYXRhLCB0dGwpO1xuICAgICAgICByZXMuY29va2llKCdzZXNzaW9uSWQnLCBuZXdTZXNzaW9uSWQsIHtcbiAgICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgICAgICAgbWF4QWdlOiB0dGwgKiAxMDAwXG4gICAgICAgIH0pO1xuICAgICAgICByZXEuc2Vzc2lvbiA9IGRhdGE7XG4gICAgICAgIHJldHVybiBuZXdTZXNzaW9uSWQ7XG4gICAgICB9O1xuXG4gICAgICByZXMuY2xlYXJTZXNzaW9uID0gYXN5bmMoKSA9PiB7XG4gICAgICAgIGlmIChzZXNzaW9uSWQpIHtcbiAgICAgICAgICBhd2FpdCByZWRpc1V0aWxzLmRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkKTtcbiAgICAgICAgICByZXMuY2xlYXJDb29raWUoJ3Nlc3Npb25JZCcpO1xuICAgICAgICAgIGRlbGV0ZSByZXEuc2Vzc2lvbjtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbmV4dCgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgZXJyb3IoJ1JlZGlzIHNlc3Npb24gbWlkZGxld2FyZSBlcnJvcicsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCBzdGFjazogZXJyLnN0YWNrIH0pO1xuICAgICAgbmV4dCgpO1xuICAgIH1cbiAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICByZWRpc0NhY2hlLFxuICBpbnZhbGlkYXRlQ2FjaGUsXG4gIHJlZGlzU2Vzc2lvblxufTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBRUE7QUFBVyxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztBQUNqRCxNQUFNO0VBQUVDLElBQUk7RUFBRUM7QUFBTSxDQUFDLEdBQUdGLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7QUFFbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1HLFVBQVUsR0FBR0EsQ0FBQ0MsT0FBTyxHQUFHLENBQUMsQ0FBQyxLQUFLO0VBQ25DLE1BQU07SUFBRUMsR0FBRztJQUFFQyxHQUFHLEdBQUcsSUFBSTtJQUFFQyxTQUFTLEdBQUc7RUFBTSxDQUFDLEdBQUdILE9BQU87RUFFdEQsT0FBTyxPQUFNSSxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0lBQzlCO0lBQ0EsSUFBSUgsU0FBUyxJQUFJQyxHQUFHLENBQUNHLEtBQUssQ0FBQ0osU0FBUyxLQUFLLE1BQU0sRUFBRTtNQUMvQyxPQUFPRyxJQUFJLENBQUMsQ0FBQztJQUNmO0lBRUEsSUFBSTtNQUNGO01BQ0EsSUFBSUUsUUFBUTtNQUNaLElBQUksT0FBT1AsR0FBRyxLQUFLLFVBQVUsRUFBRTtRQUM3Qk8sUUFBUSxHQUFHUCxHQUFHLENBQUNHLEdBQUcsQ0FBQztNQUNyQixDQUFDLE1BQU0sSUFBSUgsR0FBRyxFQUFFO1FBQ2RP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