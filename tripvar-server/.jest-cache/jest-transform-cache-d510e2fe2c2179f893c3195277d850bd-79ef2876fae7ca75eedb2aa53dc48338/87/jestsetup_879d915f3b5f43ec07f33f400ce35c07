e40c475555ef3a37b6f170f5a28a4ffe
// Global Jest setup for Tripvar Server Tests

// Mock Redis before any other imports

// Mock Redis utilities

// Mock logger to reduce noise in tests
_getJestObj().mock('ioredis', () => {
  const mockRedis = {
    get: jest.fn().mockResolvedValue(null),
    set: jest.fn().mockResolvedValue('OK'),
    del: jest.fn().mockResolvedValue(1),
    exists: jest.fn().mockResolvedValue(0),
    expire: jest.fn().mockResolvedValue(1),
    flushall: jest.fn().mockResolvedValue('OK'),
    ping: jest.fn().mockResolvedValue('PONG'),
    quit: jest.fn().mockResolvedValue('OK'),
    publish: jest.fn().mockResolvedValue(1),
    subscribe: jest.fn().mockResolvedValue(1),
    unsubscribe: jest.fn().mockResolvedValue(1),
    pipeline: jest.fn(() => ({
      get: jest.fn().mockReturnThis(),
      set: jest.fn().mockReturnThis(),
      del: jest.fn().mockReturnThis(),
      exec: jest.fn().mockResolvedValue([])
    })),
    on: jest.fn(),
    connect: jest.fn().mockResolvedValue(),
    disconnect: jest.fn().mockResolvedValue(),
    status: 'ready'
  };
  return {
    Redis: jest.fn(() => mockRedis),
    default: jest.fn(() => mockRedis),
    createClient: jest.fn(() => mockRedis)
  };
});
_getJestObj().mock('../utils/redis', () => ({
  connectRedis: jest.fn().mockResolvedValue(),
  disconnectRedis: jest.fn().mockResolvedValue(),
  getRedisClient: jest.fn(() => ({
    get: jest.fn().mockResolvedValue(null),
    set: jest.fn().mockResolvedValue('OK'),
    del: jest.fn().mockResolvedValue(1),
    exists: jest.fn().mockResolvedValue(0),
    expire: jest.fn().mockResolvedValue(1),
    flushall: jest.fn().mockResolvedValue('OK'),
    ping: jest.fn().mockResolvedValue('PONG'),
    quit: jest.fn().mockResolvedValue('OK'),
    status: 'ready'
  })),
  isRedisReady: jest.fn().mockReturnValue(true),
  deleteCache: jest.fn().mockResolvedValue(true),
  getCache: jest.fn().mockResolvedValue(null),
  setCache: jest.fn().mockResolvedValue('OK')
}));
_getJestObj().mock('../utils/logger', () => ({
  info: jest.fn(),
  error: jest.fn(),
  warn: jest.fn(),
  debug: jest.fn()
}));

// Set test environment variables
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
process.env.NODE_ENV = 'test';
process.env.JWT_SECRET = 'test-jwt-secret-key-for-testing-only';
process.env.JWT_EXPIRES_IN = '1h';
process.env.LOG_LEVEL = 'error';
process.env.REDIS_URL = 'redis://localhost:6379';

// Increase timeout for tests
jest.setTimeout(30000);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJtb2NrUmVkaXMiLCJnZXQiLCJqZXN0IiwiZm4iLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInNldCIsImRlbCIsImV4aXN0cyIsImV4cGlyZSIsImZsdXNoYWxsIiwicGluZyIsInF1aXQiLCJwdWJsaXNoIiwic3Vic2NyaWJlIiwidW5zdWJzY3JpYmUiLCJwaXBlbGluZSIsIm1vY2tSZXR1cm5UaGlzIiwiZXhlYyIsIm9uIiwiY29ubmVjdCIsImRpc2Nvbm5lY3QiLCJzdGF0dXMiLCJSZWRpcyIsImRlZmF1bHQiLCJjcmVhdGVDbGllbnQiLCJjb25uZWN0UmVkaXMiLCJkaXNjb25uZWN0UmVkaXMiLCJnZXRSZWRpc0NsaWVudCIsImlzUmVkaXNSZWFkeSIsIm1vY2tSZXR1cm5WYWx1ZSIsImRlbGV0ZUNhY2hlIiwiZ2V0Q2FjaGUiLCJzZXRDYWNoZSIsImluZm8iLCJlcnJvciIsIndhcm4iLCJkZWJ1ZyIsInJlcXVpcmUiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJKV1RfU0VDUkVUIiwiSldUX0VYUElSRVNfSU4iLCJMT0dfTEVWRUwiLCJSRURJU19VUkwiLCJzZXRUaW1lb3V0Il0sInNvdXJjZXMiOlsiamVzdC5zZXR1cC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBHbG9iYWwgSmVzdCBzZXR1cCBmb3IgVHJpcHZhciBTZXJ2ZXIgVGVzdHNcblxuLy8gTW9jayBSZWRpcyBiZWZvcmUgYW55IG90aGVyIGltcG9ydHNcbmplc3QubW9jaygnaW9yZWRpcycsICgpID0+IHtcbiAgY29uc3QgbW9ja1JlZGlzID0ge1xuICAgIGdldDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpLFxuICAgIHNldDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdPSycpLFxuICAgIGRlbDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKDEpLFxuICAgIGV4aXN0czogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKDApLFxuICAgIGV4cGlyZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKDEpLFxuICAgIGZsdXNoYWxsOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ09LJyksXG4gICAgcGluZzogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdQT05HJyksXG4gICAgcXVpdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdPSycpLFxuICAgIHB1Ymxpc2g6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKSxcbiAgICBzdWJzY3JpYmU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKSxcbiAgICB1bnN1YnNjcmliZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKDEpLFxuICAgIHBpcGVsaW5lOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgc2V0OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIGRlbDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBleGVjOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pXG4gICAgfSkpLFxuICAgIG9uOiBqZXN0LmZuKCksXG4gICAgY29ubmVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCksXG4gICAgZGlzY29ubmVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCksXG4gICAgc3RhdHVzOiAncmVhZHknXG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBSZWRpczogamVzdC5mbigoKSA9PiBtb2NrUmVkaXMpLFxuICAgIGRlZmF1bHQ6IGplc3QuZm4oKCkgPT4gbW9ja1JlZGlzKSxcbiAgICBjcmVhdGVDbGllbnQ6IGplc3QuZm4oKCkgPT4gbW9ja1JlZGlzKVxuICB9O1xufSk7XG5cbi8vIE1vY2sgUmVkaXMgdXRpbGl0aWVzXG5qZXN0Lm1vY2soJy4uL3V0aWxzL3JlZGlzJywgKCkgPT4gKHtcbiAgY29ubmVjdFJlZGlzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoKSxcbiAgZGlzY29ubmVjdFJlZGlzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoKSxcbiAgZ2V0UmVkaXNDbGllbnQ6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKSxcbiAgICBzZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnT0snKSxcbiAgICBkZWw6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKSxcbiAgICBleGlzdHM6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwKSxcbiAgICBleHBpcmU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKSxcbiAgICBmbHVzaGFsbDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdPSycpLFxuICAgIHBpbmc6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnUE9ORycpLFxuICAgIHF1aXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnT0snKSxcbiAgICBzdGF0dXM6ICdyZWFkeSdcbiAgfSkpLFxuICBpc1JlZGlzUmVhZHk6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gIGRlbGV0ZUNhY2hlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSksXG4gIGdldENhY2hlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobnVsbCksXG4gIHNldENhY2hlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ09LJylcbn0pKTtcblxuLy8gTW9jayBsb2dnZXIgdG8gcmVkdWNlIG5vaXNlIGluIHRlc3RzXG5qZXN0Lm1vY2soJy4uL3V0aWxzL2xvZ2dlcicsICgpID0+ICh7XG4gIGluZm86IGplc3QuZm4oKSxcbiAgZXJyb3I6IGplc3QuZm4oKSxcbiAgd2FybjogamVzdC5mbigpLFxuICBkZWJ1ZzogamVzdC5mbigpXG59KSk7XG5cbi8vIFNldCB0ZXN0IGVudmlyb25tZW50IHZhcmlhYmxlc1xucHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAndGVzdCc7XG5wcm9jZXNzLmVudi5KV1RfU0VDUkVUID0gJ3Rlc3Qtand0LXNlY3JldC1rZXktZm9yLXRlc3Rpbmctb25seSc7XG5wcm9jZXNzLmVudi5KV1RfRVhQSVJFU19JTiA9ICcxaCc7XG5wcm9jZXNzLmVudi5MT0dfTEVWRUwgPSAnZXJyb3InO1xucHJvY2Vzcy5lbnYuUkVESVNfVVJMID0gJ3JlZGlzOi8vbG9jYWxob3N0OjYzNzknO1xuXG4vLyBJbmNyZWFzZSB0aW1lb3V0IGZvciB0ZXN0c1xuamVzdC5zZXRUaW1lb3V0KDMwMDAwKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBOztBQWlDQTs7QUFxQkE7QUFyREFBLFdBQUEsR0FBS0MsSUFBSSxDQUFDLFNBQVMsRUFBRSxNQUFNO0VBQ3pCLE1BQU1DLFNBQVMsR0FBRztJQUNoQkMsR0FBRyxFQUFFQyxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGlCQUFpQixDQUFDLElBQUksQ0FBQztJQUN0Q0MsR0FBRyxFQUFFSCxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGlCQUFpQixDQUFDLElBQUksQ0FBQztJQUN0Q0UsR0FBRyxFQUFFSixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGlCQUFpQixDQUFDLENBQUMsQ0FBQztJQUNuQ0csTUFBTSxFQUFFTCxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGlCQUFpQixDQUFDLENBQUMsQ0FBQztJQUN0Q0ksTUFBTSxFQUFFTixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGlCQUFpQixDQUFDLENBQUMsQ0FBQztJQUN0Q0ssUUFBUSxFQUFFUCxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGlCQUFpQixDQUFDLElBQUksQ0FBQztJQUMzQ00sSUFBSSxFQUFFUixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUND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