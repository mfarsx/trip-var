3ec1a1293cebf8119dec26c278abb42a
const mongoose = require("mongoose");
const {
  MongoMemoryServer
} = require("mongodb-memory-server");
const {
  createError
} = require("../utils/errors");

// Global test setup
let mongoServer;

/**
 * Setup test environment
 */
const setupTestEnvironment = async () => {
  // Create in-memory MongoDB instance with optimized settings
  mongoServer = await MongoMemoryServer.create({
    binary: {
      version: '6.0.0' // Use specific version for consistency
    },
    instance: {
      dbName: 'tripvar-test'
    },
    // Optimize for test performance
    autoStart: true
  });
  const mongoUri = mongoServer.getUri();

  // Connect to test database with optimized settings
  await mongoose.connect(mongoUri, {
    useNewUrlParser: true,
    useUnifiedTopology: true,
    maxPoolSize: 1,
    // Reduce connection pool for tests
    serverSelectionTimeoutMS: 5000,
    // Faster timeout
    socketTimeoutMS: 45000,
    bufferCommands: false // Disable mongoose buffering
  });

  // Set test environment variables
  process.env.NODE_ENV = "test";
  process.env.JWT_SECRET = "test-jwt-secret-key-for-testing-purposes-only";
  process.env.JWT_EXPIRES_IN = "1h";
  process.env.LOG_LEVEL = "error"; // Reduce log noise during tests
  process.env.REDIS_URL = "redis://localhost:6379"; // Use local Redis for tests
  process.env.MONGODB_URI = mongoUri; // Use in-memory MongoDB
};

/**
 * Cleanup test environment
 */
const cleanupTestEnvironment = async () => {
  // Close database connection
  await mongoose.connection.close();

  // Stop in-memory MongoDB
  if (mongoServer) {
    await mongoServer.stop();
  }
};

/**
 * Clear all collections
 */
const clearDatabase = async () => {
  const collections = mongoose.connection.collections;
  for (const key in collections) {
    const collection = collections[key];
    await collection.deleteMany({});
  }
};

/**
 * Create test user
 */
const createTestUser = async (userData = {}) => {
  const User = require("../public/models/user.model");
  const defaultUser = {
    email: "test@example.com",
    password: "TestPassword123!",
    name: "Test User",
    dateOfBirth: new Date("1990-01-01"),
    nationality: "United States",
    role: "user",
    ...userData
  };
  return await User.create(defaultUser);
};

/**
 * Create test admin user
 */
const createTestAdmin = async (adminData = {}) => {
  return await createTestUser({
    email: "admin@example.com",
    name: "Test Admin",
    role: "admin",
    ...adminData
  });
};

/**
 * Create test destination
 */
const createTestDestination = async (destinationData = {}) => {
  const Destination = require("../public/models/destination.model");
  const defaultDestination = {
    title: "Test Destination",
    description: "A beautiful test destination for testing purposes",
    imageUrl: "https://example.com/test-image.jpg",
    location: "Test Location",
    category: "Beach",
    price: 299.99,
    rating: 4.5,
    amenities: ["WiFi", "Pool"],
    isActive: true,
    ...destinationData
  };
  return await Destination.create(defaultDestination);
};

/**
 * Generate future dates for testing
 */
const generateFutureDates = (daysFromNow = 30, nights = 4) => {
  const checkInDate = new Date();
  checkInDate.setDate(checkInDate.getDate() + daysFromNow);
  const checkOutDate = new Date(checkInDate);
  checkOutDate.setDate(checkOutDate.getDate() + nights);
  return {
    checkInDate: checkInDate.toISOString().split('T')[0],
    // Format as YYYY-MM-DD
    checkOutDate: checkOutDate.toISOString().split('T')[0]
  };
};

/**
 * Create test booking
 */
const createTestBooking = async (bookingData = {}) => {
  const Booking = require("../public/models/booking.model");

  // Create future dates for testing
  const futureDate = new Date();
  futureDate.setDate(futureDate.getDate() + 30); // 30 days from now
  const checkOutDate = new Date(futureDate);
  checkOutDate.setDate(checkOutDate.getDate() + 4); // 4 days later

  const defaultBooking = {
    user: bookingData.userId || (await createTestUser())._id,
    destination: bookingData.destinationId || (await createTestDestination())._id,
    checkInDate: futureDate,
    checkOutDate: checkOutDate,
    numberOfGuests: 2,
    totalAmount: 1199.96,
    pricePerNight: 299.99,
    totalNights: 4,
    status: "confirmed",
    paymentStatus: "pending",
    paymentMethod: "credit-card",
    contactEmail: "test@example.com",
    contactPhone: "+1234567890",
    specialRequests: "Test special requests",
    ...bookingData
  };
  return await Booking.create(defaultBooking);
};

/**
 * Create test review
 */
const createTestReview = async (reviewData = {}) => {
  const Review = require("../public/models/review.model");
  const defaultReview = {
    user: reviewData.userId || (await createTestUser())._id,
    destination: reviewData.destinationId || (await createTestDestination())._id,
    title: "Great test destination!",
    content: "This is a test review for testing purposes. Highly recommended!",
    rating: 5,
    status: "approved",
    ...reviewData
  };
  return await Review.create(defaultReview);
};

/**
 * Create test notification
 */
const createTestNotification = async (notificationData = {}) => {
  const Notification = require("../public/models/notification.model");
  const defaultNotification = {
    user: notificationData.userId || (await createTestUser())._id,
    title: "Test Notification",
    message: "This is a test notification for testing purposes.",
    type: "system",
    priority: "medium",
    isRead: false,
    ...notificationData
  };
  return await Notification.create(defaultNotification);
};

/**
 * Generate JWT token for testing
 */
const generateTestToken = user => {
  const jwt = require("jsonwebtoken");
  return jwt.sign({
    id: user._id,
    role: user.role
  }, process.env.JWT_SECRET, {
    expiresIn: process.env.JWT_EXPIRES_IN
  });
};

/**
 * Mock request object for testing
 */
const createMockRequest = (overrides = {}) => {
  return {
    body: {},
    params: {},
    query: {},
    headers: {},
    ip: "127.0.0.1",
    method: "GET",
    originalUrl: "/test",
    get: jest.fn(),
    ...overrides
  };
};

/**
 * Mock response object for testing
 */
const createMockResponse = () => {
  const res = {
    status: jest.fn().mockReturnThis(),
    json: jest.fn().mockReturnThis(),
    send: jest.fn().mockReturnThis(),
    set: jest.fn().mockReturnThis(),
    on: jest.fn().mockReturnThis()
  };
  return res;
};

/**
 * Mock next function for testing
 */
const createMockNext = () => jest.fn();

/**
 * Test error assertions
 */
const expectError = (error, expectedStatus, expectedMessage, expectedCode) => {
  expect(error).toBeInstanceOf(Error);
  expect(error.statusCode).toBe(expectedStatus);
  expect(error.message).toContain(expectedMessage);
  if (expectedCode) {
    expect(error.code).toBe(expectedCode);
  }
};

/**
 * Test response assertions
 */
const expectResponse = (res, expectedStatus, expectedData = null) => {
  expect(res.status).toHaveBeenCalledWith(expectedStatus);
  if (expectedData) {
    expect(res.json).toHaveBeenCalledWith(expect.objectContaining(expectedData));
  }
};

/**
 * Test validation error assertions
 */
const expectValidationError = (res, expectedStatus = 400, expectedFields = []) => {
  expect(res.status).toBe(expectedStatus);
  expect(res.body.status).toBe("fail");

  // Check for validation error code or message
  const hasValidationError = res.body.code === "VALIDATION_ERROR" || res.body.code === "INVALID_JSON" || res.body.code === "PAYLOAD_TOO_LARGE" || res.body.message?.toLowerCase().includes("validation") || res.body.message?.toLowerCase().includes("invalid") || res.body.message?.toLowerCase().includes("required");
  expect(hasValidationError).toBe(true);
  if (expectedFields.length > 0) {
    // Check if details array contains errors for the expected fields
    const details = res.body.details || [];
    const message = res.body.message || "";
    expectedFields.forEach(field => {
      const hasFieldError = details.some(error => error.path === field || error.field === field || error.message && error.message.toLowerCase().includes(field.toLowerCase()) || error.message && error.message.toLowerCase().includes(field.replace(/([A-Z])/g, ' $1').toLowerCase().trim())) || message.toLowerCase().includes(field.toLowerCase()) || message.toLowerCase().includes(field.replace(/([A-Z])/g, ' $1').toLowerCase().trim());
      expect(hasFieldError).toBe(true);
    });
  }
};

/**
 * Test authentication error assertions
 */
const expectAuthError = (res, expectedStatus = 401) => {
  expect(res.status).toBe(expectedStatus);
  expect(res.body.status).toBe("fail");
  expect(res.body.code).toMatch(/UNAUTHORIZED|AUTHENTICATION_ERROR|INVALID_TOKEN/);
};

/**
 * Test success response assertions
 */
const expectSuccessResponse = (res, expectedStatus = 200, expectedMessage = null) => {
  expect(res.status).toBe(expectedStatus);
  expect(res.body.status).toBe("success");
  if (expectedMessage) {
    expect(res.body.message).toBe(expectedMessage);
  }
};

/**
 * Test pagination response assertions
 */
const expectPaginatedResponse = (res, expectedStatus = 200) => {
  expect(res.status).toBe(expectedStatus);
  expect(res.body.status).toBe("success");
  expect(res.body.data.results).toEqual(expect.any(Array));
  expect(res.body.data.pagination).toEqual(expect.objectContaining({
    page: expect.any(Number),
    limit: expect.any(Number),
    total: expect.any(Number),
    pages: expect.any(Number)
  }));
};

/**
 * Test not found error assertions
 */
const expectNotFoundError = (res, expectedStatus = 404, expectedMessage = null) => {
  expect(res.status).toBe(expectedStatus);
  expect(res.body.status).toBe("fail");
  if (expectedMessage) {
    expect(res.body.message).toContain(expectedMessage);
  }
};

/**
 * Test conflict error assertions
 */
const expectConflictError = (res, expectedStatus = 409, expectedMessage = null) => {
  expect(res.status).toBe(expectedStatus);
  expect(res.body.status).toBe("fail");
  if (expectedMessage) {
    expect(res.body.message).toContain(expectedMessage);
  }
};

/**
 * Wait for async operations
 */
const waitFor = ms => new Promise(resolve => setTimeout(resolve, ms));

/**
 * Test database connection
 */
const testDatabaseConnection = async () => {
  try {
    await mongoose.connection.db.admin().ping();
    return true;
  } catch (error) {
    return false;
  }
};

/**
 * Test utilities for common operations
 */
const testUtils = {
  setupTestEnvironment,
  cleanupTestEnvironment,
  clearDatabase,
  createTestUser,
  createTestAdmin,
  createTestDestination,
  createTestBooking,
  createTestReview,
  generateTestToken,
  generateFutureDates,
  createMockRequest,
  createMockResponse,
  createMockNext,
  expectError,
  expectResponse,
  expectValidationError,
  expectAuthError,
  expectSuccessResponse,
  expectPaginatedResponse,
  expectNotFoundError,
  expectConflictError,
  waitFor,
  testDatabaseConnection
};
module.exports = testUtils;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJNb25nb01lbW9yeVNlcnZlciIsImNyZWF0ZUVycm9yIiwibW9uZ29TZXJ2ZXIiLCJzZXR1cFRlc3RFbnZpcm9ubWVudCIsImNyZWF0ZSIsImJpbmFyeSIsInZlcnNpb24iLCJpbnN0YW5jZSIsImRiTmFtZSIsImF1dG9TdGFydCIsIm1vbmdvVXJpIiwiZ2V0VXJpIiwiY29ubmVjdCIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsIm1heFBvb2xTaXplIiwic2VydmVyU2VsZWN0aW9uVGltZW91dE1TIiwic29ja2V0VGltZW91dE1TIiwiYnVmZmVyQ29tbWFuZHMiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJKV1RfU0VDUkVUIiwiSldUX0VYUElSRVNfSU4iLCJMT0dfTEVWRUwiLCJSRURJU19VUkwiLCJNT05HT0RCX1VSSSIsImNsZWFudXBUZXN0RW52aXJvbm1lbnQiLCJjb25uZWN0aW9uIiwiY2xvc2UiLCJzdG9wIiwiY2xlYXJEYXRhYmFzZSIsImNvbGxlY3Rpb25zIiwia2V5IiwiY29sbGVjdGlvbiIsImRlbGV0ZU1hbnkiLCJjcmVhdGVUZXN0VXNlciIsInVzZXJEYXRhIiwiVXNlciIsImRlZmF1bHRVc2VyIiwiZW1haWwiLCJwYXNzd29yZCIsIm5hbWUiLCJkYXRlT2ZCaXJ0aCIsIkRhdGUiLCJuYXRpb25hbGl0eSIsInJvbGUiLCJjcmVhdGVUZXN0QWRtaW4iLCJhZG1pbkRhdGEiLCJjcmVhdGVUZXN0RGVzdGluYXRpb24iLCJkZXN0aW5hdGlvbkRhdGEiLCJEZXN0aW5hdGlvbiIsImRlZmF1bHREZXN0aW5hdGlvbiIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJpbWFnZVVybCIsImxvY2F0aW9uIiwiY2F0ZWdvcnkiLCJwcmljZSIsInJhdGluZyIsImFtZW5pdGllcyIsImlzQWN0aXZlIiwiZ2VuZXJhdGVGdXR1cmVEYXRlcyIsImRheXNGcm9tTm93IiwibmlnaHRzIiwiY2hlY2tJbkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImNoZWNrT3V0RGF0ZSIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJjcmVhdGVUZXN0Qm9va2luZyIsImJvb2tpbmdEYXRhIiwiQm9va2luZyIsImZ1dHVyZURhdGUiLCJkZWZhdWx0Qm9va2luZyIsInVzZXIiLCJ1c2VySWQiLCJfaWQiLCJkZXN0aW5hdGlvbiIsImRlc3RpbmF0aW9uSWQiLCJudW1iZXJPZkd1ZXN0cyIsInRvdGFsQW1vdW50IiwicHJpY2VQZXJOaWdodCIsInRvdGFsTmlnaHRzIiwic3RhdHVzIiwicGF5bWVudFN0YXR1cyIsInBheW1lbnRNZXRob2QiLCJjb250YWN0RW1haWwiLCJjb250YWN0UGhvbmUiLCJzcGVjaWFsUmVxdWVzdHMiLCJjcmVhdGVUZXN0UmV2aWV3IiwicmV2aWV3RGF0YSIsIlJldmlldyIsImRlZmF1bHRSZXZpZXciLCJjb250ZW50IiwiY3JlYXRlVGVzdE5vdGlmaWNhdGlvbiIsIm5vdGlmaWNhdGlvbkRhdGEiLCJOb3RpZmljYXRpb24iLCJkZWZhdWx0Tm90aWZpY2F0aW9uIiwibWVzc2FnZSIsInR5cGUiLCJwcmlvcml0eSIsImlzUmVhZCIsImdlbmVyYXRlVGVzdFRva2VuIiwiand0Iiwic2lnbiIsImlkIiwiZXhwaXJlc0luIiwiY3JlYXRlTW9ja1JlcXVlc3QiLCJvdmVycmlkZXMiLCJib2R5IiwicGFyYW1zIiwicXVlcnkiLCJoZWFkZXJzIiwiaXAiLCJtZXRob2QiLCJvcmlnaW5hbFVybCIsImdldCIsImplc3QiLCJmbiIsImNyZWF0ZU1vY2tSZXNwb25zZSIsInJlcyIsIm1vY2tSZXR1cm5UaGlzIiwianNvbiIsInNlbmQiLCJzZXQiLCJvbiIsImNyZWF0ZU1vY2tOZXh0IiwiZXhwZWN0RXJyb3IiLCJlcnJvciIsImV4cGVjdGVkU3RhdHVzIiwiZXhwZWN0ZWRNZXNzYWdlIiwiZXhwZWN0ZWRDb2RlIiwiZXhwZWN0IiwidG9CZUluc3RhbmNlT2YiLCJFcnJvciIsInN0YXR1c0NvZGUiLCJ0b0JlIiwidG9Db250YWluIiwiY29kZSIsImV4cGVjdFJlc3BvbnNlIiwiZXhwZWN0ZWREYXRhIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJvYmplY3RDb250YWluaW5nIiwiZXhwZWN0VmFsaWRhdGlvbkVycm9yIiwiZXhwZWN0ZWRGaWVsZHMiLCJoYXNWYWxpZGF0aW9uRXJyb3IiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwibGVuZ3RoIiwiZGV0YWlscyIsImZvckVhY2giLCJmaWVsZCIsImhhc0ZpZWxkRXJyb3IiLCJzb21lIiwicGF0aCIsInJlcGxhY2UiLCJ0cmltIiwiZXhwZWN0QXV0aEVycm9yIiwidG9NYXRjaCIsImV4cGVjdFN1Y2Nlc3NSZXNwb25zZSIsImV4cGVjdFBhZ2luYXRlZFJlc3BvbnNlIiwiZGF0YSIsInJlc3VsdHMiLCJ0b0VxdWFsIiwiYW55IiwiQXJyYXkiLCJwYWdpbmF0aW9uIiwicGFnZSIsIk51bWJlciIsImxpbWl0IiwidG90YWwiLCJwYWdlcyIsImV4cGVjdE5vdEZvdW5kRXJyb3IiLCJleHBlY3RDb25mbGljdEVycm9yIiwid2FpdEZvciIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwidGVzdERhdGFiYXNlQ29ubmVjdGlvbiIsImRiIiwiYWRtaW4iLCJwaW5nIiwidGVzdFV0aWxzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNldHVwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuY29uc3QgeyBNb25nb01lbW9yeVNlcnZlciB9ID0gcmVxdWlyZShcIm1vbmdvZGItbWVtb3J5LXNlcnZlclwiKTtcbmNvbnN0IHsgY3JlYXRlRXJyb3IgfSA9IHJlcXVpcmUoXCIuLi91dGlscy9lcnJvcnNcIik7XG5cbi8vIEdsb2JhbCB0ZXN0IHNldHVwXG5sZXQgbW9uZ29TZXJ2ZXI7XG5cbi8qKlxuICogU2V0dXAgdGVzdCBlbnZpcm9ubWVudFxuICovXG5jb25zdCBzZXR1cFRlc3RFbnZpcm9ubWVudCA9IGFzeW5jICgpID0+IHtcbiAgLy8gQ3JlYXRlIGluLW1lbW9yeSBNb25nb0RCIGluc3RhbmNlIHdpdGggb3B0aW1pemVkIHNldHRpbmdzXG4gIG1vbmdvU2VydmVyID0gYXdhaXQgTW9uZ29NZW1vcnlTZXJ2ZXIuY3JlYXRlKHtcbiAgICBiaW5hcnk6IHtcbiAgICAgIHZlcnNpb246ICc2LjAuMCcsIC8vIFVzZSBzcGVjaWZpYyB2ZXJzaW9uIGZvciBjb25zaXN0ZW5jeVxuICAgIH0sXG4gICAgaW5zdGFuY2U6IHtcbiAgICAgIGRiTmFtZTogJ3RyaXB2YXItdGVzdCcsXG4gICAgfSxcbiAgICAvLyBPcHRpbWl6ZSBmb3IgdGVzdCBwZXJmb3JtYW5jZVxuICAgIGF1dG9TdGFydDogdHJ1ZSxcbiAgfSk7XG5cbiAgY29uc3QgbW9uZ29VcmkgPSBtb25nb1NlcnZlci5nZXRVcmkoKTtcblxuICAvLyBDb25uZWN0IHRvIHRlc3QgZGF0YWJhc2Ugd2l0aCBvcHRpbWl6ZWQgc2V0dGluZ3NcbiAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdChtb25nb1VyaSwge1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUsXG4gICAgbWF4UG9vbFNpemU6IDEsIC8vIFJlZHVjZSBjb25uZWN0aW9uIHBvb2wgZm9yIHRlc3RzXG4gICAgc2VydmVyU2VsZWN0aW9uVGltZW91dE1TOiA1MDAwLCAvLyBGYXN0ZXIgdGltZW91dFxuICAgIHNvY2tldFRpbWVvdXRNUzogNDUwMDAsXG4gICAgYnVmZmVyQ29tbWFuZHM6IGZhbHNlLCAvLyBEaXNhYmxlIG1vbmdvb3NlIGJ1ZmZlcmluZ1xuICB9KTtcblxuICAvLyBTZXQgdGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBcInRlc3RcIjtcbiAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCA9IFwidGVzdC1qd3Qtc2VjcmV0LWtleS1mb3ItdGVzdGluZy1wdXJwb3Nlcy1vbmx5XCI7XG4gIHByb2Nlc3MuZW52LkpXVF9FWFBJUkVTX0lOID0gXCIxaFwiO1xuICBwcm9jZXNzLmVudi5MT0dfTEVWRUwgPSBcImVycm9yXCI7IC8vIFJlZHVjZSBsb2cgbm9pc2UgZHVyaW5nIHRlc3RzXG4gIHByb2Nlc3MuZW52LlJFRElTX1VSTCA9IFwicmVkaXM6Ly9sb2NhbGhvc3Q6NjM3OVwiOyAvLyBVc2UgbG9jYWwgUmVkaXMgZm9yIHRlc3RzXG4gIHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJID0gbW9uZ29Vcmk7IC8vIFVzZSBpbi1tZW1vcnkgTW9uZ29EQlxufTtcblxuLyoqXG4gKiBDbGVhbnVwIHRlc3QgZW52aXJvbm1lbnRcbiAqL1xuY29uc3QgY2xlYW51cFRlc3RFbnZpcm9ubWVudCA9IGFzeW5jICgpID0+IHtcbiAgLy8gQ2xvc2UgZGF0YWJhc2UgY29ubmVjdGlvblxuICBhd2FpdCBtb25nb29zZS5jb25uZWN0aW9uLmNsb3NlKCk7XG5cbiAgLy8gU3RvcCBpbi1tZW1vcnkgTW9uZ29EQlxuICBpZiAobW9uZ29TZXJ2ZXIpIHtcbiAgICBhd2FpdCBtb25nb1NlcnZlci5zdG9wKCk7XG4gIH1cbn07XG5cbi8qKlxuICogQ2xlYXIgYWxsIGNvbGxlY3Rpb25zXG4gKi9cbmNvbnN0IGNsZWFyRGF0YWJhc2UgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGNvbGxlY3Rpb25zID0gbW9uZ29vc2UuY29ubmVjdGlvbi5jb2xsZWN0aW9ucztcblxuICBmb3IgKGNvbnN0IGtleSBpbiBjb2xsZWN0aW9ucykge1xuICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uc1trZXldO1xuICAgIGF3YWl0IGNvbGxlY3Rpb24uZGVsZXRlTWFueSh7fSk7XG4gIH1cbn07XG5cbi8qKlxuICogQ3JlYXRlIHRlc3QgdXNlclxuICovXG5jb25zdCBjcmVhdGVUZXN0VXNlciA9IGFzeW5jICh1c2VyRGF0YSA9IHt9KSA9PiB7XG4gIGNvbnN0IFVzZXIgPSByZXF1aXJlKFwiLi4vcHVibGljL21vZGVscy91c2VyLm1vZGVsXCIpO1xuXG4gIGNvbnN0IGRlZmF1bHRVc2VyID0ge1xuICAgIGVtYWlsOiBcInRlc3RAZXhhbXBsZS5jb21cIixcbiAgICBwYXNzd29yZDogXCJUZXN0UGFzc3dvcmQxMjMhXCIsXG4gICAgbmFtZTogXCJUZXN0IFVzZXJcIixcbiAgICBkYXRlT2ZCaXJ0aDogbmV3IERhdGUoXCIxOTkwLTAxLTAxXCIpLFxuICAgIG5hdGlvbmFsaXR5OiBcIlVuaXRlZCBTdGF0ZXNcIixcbiAgICByb2xlOiBcInVzZXJcIixcbiAgICAuLi51c2VyRGF0YSxcbiAgfTtcblxuICByZXR1cm4gYXdhaXQgVXNlci5jcmVhdGUoZGVmYXVsdFVzZXIpO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgdGVzdCBhZG1pbiB1c2VyXG4gKi9cbmNvbnN0IGNyZWF0ZVRlc3RBZG1pbiA9IGFzeW5jIChhZG1pbkRhdGEgPSB7fSkgPT4ge1xuICByZXR1cm4gYXdhaXQgY3JlYXRlVGVzdFVzZXIoe1xuICAgIGVtYWlsOiBcImFkbWluQGV4YW1wbGUuY29tXCIsXG4gICAgbmFtZTogXCJUZXN0IEFkbWluXCIsXG4gICAgcm9sZTogXCJhZG1pblwiLFxuICAgIC4uLmFkbWluRGF0YSxcbiAgfSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSB0ZXN0IGRlc3RpbmF0aW9uXG4gKi9cbmNvbnN0IGNyZWF0ZVRlc3REZXN0aW5hdGlvbiA9IGFzeW5jIChkZXN0aW5hdGlvbkRhdGEgPSB7fSkgPT4ge1xuICBjb25zdCBEZXN0aW5hdGlvbiA9IHJlcXVpcmUoXCIuLi9wdWJsaWMvbW9kZWxzL2Rlc3RpbmF0aW9uLm1vZGVsXCIpO1xuXG4gIGNvbnN0IGRlZmF1bHREZXN0aW5hdGlvbiA9IHtcbiAgICB0aXRsZTogXCJUZXN0IERlc3RpbmF0aW9uXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQSBiZWF1dGlmdWwgdGVzdCBkZXN0aW5hdGlvbiBmb3IgdGVzdGluZyBwdXJwb3Nlc1wiLFxuICAgIGltYWdlVXJsOiBcImh0dHBzOi8vZXhhbXBsZS5jb20vdGVzdC1pbWFnZS5qcGdcIixcbiAgICBsb2NhdGlvbjogXCJUZXN0IExvY2F0aW9uXCIsXG4gICAgY2F0ZWdvcnk6IFwiQmVhY2hcIixcbiAgICBwcmljZTogMjk5Ljk5LFxuICAgIHJhdGluZzogNC41LFxuICAgIGFtZW5pdGllczogW1wiV2lGaVwiLCBcIlBvb2xcIl0sXG4gICAgaXNBY3RpdmU6IHRydWUsXG4gICAgLi4uZGVzdGluYXRpb25EYXRhLFxuICB9O1xuXG4gIHJldHVybiBhd2FpdCBEZXN0aW5hdGlvbi5jcmVhdGUoZGVmYXVsdERlc3RpbmF0aW9uKTtcbn07XG5cbi8qKlxuICogR2VuZXJhdGUgZnV0dXJlIGRhdGVzIGZvciB0ZXN0aW5nXG4gKi9cbmNvbnN0IGdlbmVyYXRlRnV0dXJlRGF0ZXMgPSAoZGF5c0Zyb21Ob3cgPSAzMCwgbmlnaHRzID0gNCkgPT4ge1xuICBjb25zdCBjaGVja0luRGF0ZSA9IG5ldyBEYXRlKCk7XG4gIGNoZWNrSW5EYXRlLnNldERhdGUoY2hlY2tJbkRhdGUuZ2V0RGF0ZSgpICsgZGF5c0Zyb21Ob3cpO1xuICBcbiAgY29uc3QgY2hlY2tPdXREYXRlID0gbmV3IERhdGUoY2hlY2tJbkRhdGUpO1xuICBjaGVja091dERhdGUuc2V0RGF0ZShjaGVja091dERhdGUuZ2V0RGF0ZSgpICsgbmlnaHRzKTtcbiAgXG4gIHJldHVybiB7XG4gICAgY2hlY2tJbkRhdGU6IGNoZWNrSW5EYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSwgLy8gRm9ybWF0IGFzIFlZWVktTU0tRERcbiAgICBjaGVja091dERhdGU6IGNoZWNrT3V0RGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF1cbiAgfTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHRlc3QgYm9va2luZ1xuICovXG5jb25zdCBjcmVhdGVUZXN0Qm9va2luZyA9IGFzeW5jIChib29raW5nRGF0YSA9IHt9KSA9PiB7XG4gIGNvbnN0IEJvb2tpbmcgPSByZXF1aXJlKFwiLi4vcHVibGljL21vZGVscy9ib29raW5nLm1vZGVsXCIpO1xuXG4gIC8vIENyZWF0ZSBmdXR1cmUgZGF0ZXMgZm9yIHRlc3RpbmdcbiAgY29uc3QgZnV0dXJlRGF0ZSA9IG5ldyBEYXRlKCk7XG4gIGZ1dHVyZURhdGUuc2V0RGF0ZShmdXR1cmVEYXRlLmdldERhdGUoKSArIDMwKTsgLy8gMzAgZGF5cyBmcm9tIG5vd1xuICBjb25zdCBjaGVja091dERhdGUgPSBuZXcgRGF0ZShmdXR1cmVEYXRlKTtcbiAgY2hlY2tPdXREYXRlLnNldERhdGUoY2hlY2tPdXREYXRlLmdldERhdGUoKSArIDQpOyAvLyA0IGRheXMgbGF0ZXJcblxuICBjb25zdCBkZWZhdWx0Qm9va2luZyA9IHtcbiAgICB1c2VyOiBib29raW5nRGF0YS51c2VySWQgfHwgKGF3YWl0IGNyZWF0ZVRlc3RVc2VyKCkpLl9pZCxcbiAgICBkZXN0aW5hdGlvbjogYm9va2luZ0RhdGEuZGVzdGluYXRpb25JZCB8fCAoYXdhaXQgY3JlYXRlVGVzdERlc3RpbmF0aW9uKCkpLl9pZCxcbiAgICBjaGVja0luRGF0ZTogZnV0dXJlRGF0ZSxcbiAgICBjaGVja091dERhdGU6IGNoZWNrT3V0RGF0ZSxcbiAgICBudW1iZXJPZkd1ZXN0czogMixcbiAgICB0b3RhbEFtb3VudDogMTE5OS45NixcbiAgICBwcmljZVBlck5pZ2h0OiAyOTkuOTksXG4gICAgdG90YWxOaWdodHM6IDQsXG4gICAgc3RhdHVzOiBcImNvbmZpcm1lZFwiLFxuICAgIHBheW1lbnRTdGF0dXM6IFwicGVuZGluZ1wiLFxuICAgIHBheW1lbnRNZXRob2Q6IFwiY3JlZGl0LWNhcmRcIixcbiAgICBjb250YWN0RW1haWw6IFwidGVzdEBleGFtcGxlLmNvbVwiLFxuICAgIGNvbnRhY3RQaG9uZTogXCIrMTIzNDU2Nzg5MFwiLFxuICAgIHNwZWNpYWxSZXF1ZXN0czogXCJUZXN0IHNwZWNpYWwgcmVxdWVzdHNcIixcbiAgICAuLi5ib29raW5nRGF0YSxcbiAgfTtcblxuICByZXR1cm4gYXdhaXQgQm9va2luZy5jcmVhdGUoZGVmYXVsdEJvb2tpbmcpO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgdGVzdCByZXZpZXdcbiAqL1xuY29uc3QgY3JlYXRlVGVzdFJldmlldyA9IGFzeW5jIChyZXZpZXdEYXRhID0ge30pID0+IHtcbiAgY29uc3QgUmV2aWV3ID0gcmVxdWlyZShcIi4uL3B1YmxpYy9tb2RlbHMvcmV2aWV3Lm1vZGVsXCIpO1xuXG4gIGNvbnN0IGRlZmF1bHRSZXZpZXcgPSB7XG4gICAgdXNlcjogcmV2aWV3RGF0YS51c2VySWQgfHwgKGF3YWl0IGNyZWF0ZVRlc3RVc2VyKCkpLl9pZCxcbiAgICBkZXN0aW5hdGlvbjpcbiAgICAgIHJldmlld0RhdGEuZGVzdGluYXRpb25JZCB8fCAoYXdhaXQgY3JlYXRlVGVzdERlc3RpbmF0aW9uKCkpLl9pZCxcbiAgICB0aXRsZTogXCJHcmVhdCB0ZXN0IGRlc3RpbmF0aW9uIVwiLFxuICAgIGNvbnRlbnQ6IFwiVGhpcyBpcyBhIHRlc3QgcmV2aWV3IGZvciB0ZXN0aW5nIHB1cnBvc2VzLiBIaWdobHkgcmVjb21tZW5kZWQhXCIsXG4gICAgcmF0aW5nOiA1LFxuICAgIHN0YXR1czogXCJhcHByb3ZlZFwiLFxuICAgIC4uLnJldmlld0RhdGEsXG4gIH07XG5cbiAgcmV0dXJuIGF3YWl0IFJldmlldy5jcmVhdGUoZGVmYXVsdFJldmlldyk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSB0ZXN0IG5vdGlmaWNhdGlvblxuICovXG5jb25zdCBjcmVhdGVUZXN0Tm90aWZpY2F0aW9uID0gYXN5bmMgKG5vdGlmaWNhdGlvbkRhdGEgPSB7fSkgPT4ge1xuICBjb25zdCBOb3RpZmljYXRpb24gPSByZXF1aXJlKFwiLi4vcHVibGljL21vZGVscy9ub3RpZmljYXRpb24ubW9kZWxcIik7XG5cbiAgY29uc3QgZGVmYXVsdE5vdGlmaWNhdGlvbiA9IHtcbiAgICB1c2VyOiBub3RpZmljYXRpb25EYXRhLnVzZXJJZCB8fCAoYXdhaXQgY3JlYXRlVGVzdFVzZXIoKSkuX2lkLFxuICAgIHRpdGxlOiBcIlRlc3QgTm90aWZpY2F0aW9uXCIsXG4gICAgbWVzc2FnZTogXCJUaGlzIGlzIGEgdGVzdCBub3RpZmljYXRpb24gZm9yIHRlc3RpbmcgcHVycG9zZXMuXCIsXG4gICAgdHlwZTogXCJzeXN0ZW1cIixcbiAgICBwcmlvcml0eTogXCJtZWRpdW1cIixcbiAgICBpc1JlYWQ6IGZhbHNlLFxuICAgIC4uLm5vdGlmaWNhdGlvbkRhdGEsXG4gIH07XG5cbiAgcmV0dXJuIGF3YWl0IE5vdGlmaWNhdGlvbi5jcmVhdGUoZGVmYXVsdE5vdGlmaWNhdGlvbik7XG59O1xuXG4vKipcbiAqIEdlbmVyYXRlIEpXVCB0b2tlbiBmb3IgdGVzdGluZ1xuICovXG5jb25zdCBnZW5lcmF0ZVRlc3RUb2tlbiA9ICh1c2VyKSA9PiB7XG4gIGNvbnN0IGp3dCA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XG4gIHJldHVybiBqd3Quc2lnbih7IGlkOiB1c2VyLl9pZCwgcm9sZTogdXNlci5yb2xlIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHtcbiAgICBleHBpcmVzSW46IHByb2Nlc3MuZW52LkpXVF9FWFBJUkVTX0lOLFxuICB9KTtcbn07XG5cbi8qKlxuICogTW9jayByZXF1ZXN0IG9iamVjdCBmb3IgdGVzdGluZ1xuICovXG5jb25zdCBjcmVhdGVNb2NrUmVxdWVzdCA9IChvdmVycmlkZXMgPSB7fSkgPT4ge1xuICByZXR1cm4ge1xuICAgIGJvZHk6IHt9LFxuICAgIHBhcmFtczoge30sXG4gICAgcXVlcnk6IHt9LFxuICAgIGhlYWRlcnM6IHt9LFxuICAgIGlwOiBcIjEyNy4wLjAuMVwiLFxuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBvcmlnaW5hbFVybDogXCIvdGVzdFwiLFxuICAgIGdldDogamVzdC5mbigpLFxuICAgIC4uLm92ZXJyaWRlcyxcbiAgfTtcbn07XG5cbi8qKlxuICogTW9jayByZXNwb25zZSBvYmplY3QgZm9yIHRlc3RpbmdcbiAqL1xuY29uc3QgY3JlYXRlTW9ja1Jlc3BvbnNlID0gKCkgPT4ge1xuICBjb25zdCByZXMgPSB7XG4gICAgc3RhdHVzOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBqc29uOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBzZW5kOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICBzZXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgIG9uOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgfTtcbiAgcmV0dXJuIHJlcztcbn07XG5cbi8qKlxuICogTW9jayBuZXh0IGZ1bmN0aW9uIGZvciB0ZXN0aW5nXG4gKi9cbmNvbnN0IGNyZWF0ZU1vY2tOZXh0ID0gKCkgPT4gamVzdC5mbigpO1xuXG4vKipcbiAqIFRlc3QgZXJyb3IgYXNzZXJ0aW9uc1xuICovXG5jb25zdCBleHBlY3RFcnJvciA9IChlcnJvciwgZXhwZWN0ZWRTdGF0dXMsIGV4cGVjdGVkTWVzc2FnZSwgZXhwZWN0ZWRDb2RlKSA9PiB7XG4gIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoRXJyb3IpO1xuICBleHBlY3QoZXJyb3Iuc3RhdHVzQ29kZSkudG9CZShleHBlY3RlZFN0YXR1cyk7XG4gIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oZXhwZWN0ZWRNZXNzYWdlKTtcbiAgaWYgKGV4cGVjdGVkQ29kZSkge1xuICAgIGV4cGVjdChlcnJvci5jb2RlKS50b0JlKGV4cGVjdGVkQ29kZSk7XG4gIH1cbn07XG5cbi8qKlxuICogVGVzdCByZXNwb25zZSBhc3NlcnRpb25zXG4gKi9cbmNvbnN0IGV4cGVjdFJlc3BvbnNlID0gKHJlcywgZXhwZWN0ZWRTdGF0dXMsIGV4cGVjdGVkRGF0YSA9IG51bGwpID0+IHtcbiAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdGVkU3RhdHVzKTtcbiAgaWYgKGV4cGVjdGVkRGF0YSkge1xuICAgIGV4cGVjdChyZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyhleHBlY3RlZERhdGEpXG4gICAgKTtcbiAgfVxufTtcblxuLyoqXG4gKiBUZXN0IHZhbGlkYXRpb24gZXJyb3IgYXNzZXJ0aW9uc1xuICovXG5jb25zdCBleHBlY3RWYWxpZGF0aW9uRXJyb3IgPSAoXG4gIHJlcyxcbiAgZXhwZWN0ZWRTdGF0dXMgPSA0MDAsXG4gIGV4cGVjdGVkRmllbGRzID0gW11cbikgPT4ge1xuICBleHBlY3QocmVzLnN0YXR1cykudG9CZShleHBlY3RlZFN0YXR1cyk7XG4gIGV4cGVjdChyZXMuYm9keS5zdGF0dXMpLnRvQmUoXCJmYWlsXCIpO1xuICBcbiAgLy8gQ2hlY2sgZm9yIHZhbGlkYXRpb24gZXJyb3IgY29kZSBvciBtZXNzYWdlXG4gIGNvbnN0IGhhc1ZhbGlkYXRpb25FcnJvciA9IFxuICAgIHJlcy5ib2R5LmNvZGUgPT09IFwiVkFMSURBVElPTl9FUlJPUlwiIHx8XG4gICAgcmVzLmJvZHkuY29kZSA9PT0gXCJJTlZBTElEX0pTT05cIiB8fFxuICAgIHJlcy5ib2R5LmNvZGUgPT09IFwiUEFZTE9BRF9UT09fTEFSR0VcIiB8fFxuICAgIHJlcy5ib2R5Lm1lc3NhZ2U/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJ2YWxpZGF0aW9uXCIpIHx8XG4gICAgcmVzLmJvZHkubWVzc2FnZT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImludmFsaWRcIikgfHxcbiAgICByZXMuYm9keS5tZXNzYWdlPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicmVxdWlyZWRcIik7XG4gIFxuICBleHBlY3QoaGFzVmFsaWRhdGlvbkVycm9yKS50b0JlKHRydWUpO1xuICBcbiAgaWYgKGV4cGVjdGVkRmllbGRzLmxlbmd0aCA+IDApIHtcbiAgICAvLyBDaGVjayBpZiBkZXRhaWxzIGFycmF5IGNvbnRhaW5zIGVycm9ycyBmb3IgdGhlIGV4cGVjdGVkIGZpZWxkc1xuICAgIGNvbnN0IGRldGFpbHMgPSByZXMuYm9keS5kZXRhaWxzIHx8IFtdO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSByZXMuYm9keS5tZXNzYWdlIHx8IFwiXCI7XG4gICAgXG4gICAgZXhwZWN0ZWRGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgIGNvbnN0IGhhc0ZpZWxkRXJyb3IgPSBkZXRhaWxzLnNvbWUoXG4gICAgICAgIChlcnJvcikgPT5cbiAgICAgICAgICBlcnJvci5wYXRoID09PSBmaWVsZCB8fFxuICAgICAgICAgIGVycm9yLmZpZWxkID09PSBmaWVsZCB8fFxuICAgICAgICAgIChlcnJvci5tZXNzYWdlICYmXG4gICAgICAgICAgICBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmllbGQudG9Mb3dlckNhc2UoKSkpIHx8XG4gICAgICAgICAgKGVycm9yLm1lc3NhZ2UgJiZcbiAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWVsZC5yZXBsYWNlKC8oW0EtWl0pL2csICcgJDEnKS50b0xvd2VyQ2FzZSgpLnRyaW0oKSkpXG4gICAgICApIHx8IG1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWVsZC50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICAgbWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpZWxkLnJlcGxhY2UoLyhbQS1aXSkvZywgJyAkMScpLnRvTG93ZXJDYXNlKCkudHJpbSgpKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGhhc0ZpZWxkRXJyb3IpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH1cbn07XG5cbi8qKlxuICogVGVzdCBhdXRoZW50aWNhdGlvbiBlcnJvciBhc3NlcnRpb25zXG4gKi9cbmNvbnN0IGV4cGVjdEF1dGhFcnJvciA9IChyZXMsIGV4cGVjdGVkU3RhdHVzID0gNDAxKSA9PiB7XG4gIGV4cGVjdChyZXMuc3RhdHVzKS50b0JlKGV4cGVjdGVkU3RhdHVzKTtcbiAgZXhwZWN0KHJlcy5ib2R5LnN0YXR1cykudG9CZShcImZhaWxcIik7XG4gIGV4cGVjdChyZXMuYm9keS5jb2RlKS50b01hdGNoKC9VTkFVVEhPUklaRUR8QVVUSEVOVElDQVRJT05fRVJST1J8SU5WQUxJRF9UT0tFTi8pO1xufTtcblxuLyoqXG4gKiBUZXN0IHN1Y2Nlc3MgcmVzcG9uc2UgYXNzZXJ0aW9uc1xuICovXG5jb25zdCBleHBlY3RTdWNjZXNzUmVzcG9uc2UgPSAoXG4gIHJlcyxcbiAgZXhwZWN0ZWRTdGF0dXMgPSAyMDAsXG4gIGV4cGVjdGVkTWVzc2FnZSA9IG51bGxcbikgPT4ge1xuICBleHBlY3QocmVzLnN0YXR1cykudG9CZShleHBlY3RlZFN0YXR1cyk7XG4gIGV4cGVjdChyZXMuYm9keS5zdGF0dXMpLnRvQmUoXCJzdWNjZXNzXCIpO1xuICBpZiAoZXhwZWN0ZWRNZXNzYWdlKSB7XG4gICAgZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvQmUoZXhwZWN0ZWRNZXNzYWdlKTtcbiAgfVxufTtcblxuLyoqXG4gKiBUZXN0IHBhZ2luYXRpb24gcmVzcG9uc2UgYXNzZXJ0aW9uc1xuICovXG5jb25zdCBleHBlY3RQYWdpbmF0ZWRSZXNwb25zZSA9IChyZXMsIGV4cGVjdGVkU3RhdHVzID0gMjAwKSA9PiB7XG4gIGV4cGVjdChyZXMuc3RhdHVzKS50b0JlKGV4cGVjdGVkU3RhdHVzKTtcbiAgZXhwZWN0KHJlcy5ib2R5LnN0YXR1cykudG9CZShcInN1Y2Nlc3NcIik7XG4gIGV4cGVjdChyZXMuYm9keS5kYXRhLnJlc3VsdHMpLnRvRXF1YWwoZXhwZWN0LmFueShBcnJheSkpO1xuICBleHBlY3QocmVzLmJvZHkuZGF0YS5wYWdpbmF0aW9uKS50b0VxdWFsKFxuICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgIHBhZ2U6IGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgIGxpbWl0OiBleHBlY3QuYW55KE51bWJlciksXG4gICAgICB0b3RhbDogZXhwZWN0LmFueShOdW1iZXIpLFxuICAgICAgcGFnZXM6IGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICB9KVxuICApO1xufTtcblxuLyoqXG4gKiBUZXN0IG5vdCBmb3VuZCBlcnJvciBhc3NlcnRpb25zXG4gKi9cbmNvbnN0IGV4cGVjdE5vdEZvdW5kRXJyb3IgPSAoXG4gIHJlcyxcbiAgZXhwZWN0ZWRTdGF0dXMgPSA0MDQsXG4gIGV4cGVjdGVkTWVzc2FnZSA9IG51bGxcbikgPT4ge1xuICBleHBlY3QocmVzLnN0YXR1cykudG9CZShleHBlY3RlZFN0YXR1cyk7XG4gIGV4cGVjdChyZXMuYm9keS5zdGF0dXMpLnRvQmUoXCJmYWlsXCIpO1xuICBpZiAoZXhwZWN0ZWRNZXNzYWdlKSB7XG4gICAgZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbihleHBlY3RlZE1lc3NhZ2UpO1xuICB9XG59O1xuXG4vKipcbiAqIFRlc3QgY29uZmxpY3QgZXJyb3IgYXNzZXJ0aW9uc1xuICovXG5jb25zdCBleHBlY3RDb25mbGljdEVycm9yID0gKFxuICByZXMsXG4gIGV4cGVjdGVkU3RhdHVzID0gNDA5LFxuICBleHBlY3RlZE1lc3NhZ2UgPSBudWxsXG4pID0+IHtcbiAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvQmUoZXhwZWN0ZWRTdGF0dXMpO1xuICBleHBlY3QocmVzLmJvZHkuc3RhdHVzKS50b0JlKFwiZmFpbFwiKTtcbiAgaWYgKGV4cGVjdGVkTWVzc2FnZSkge1xuICAgIGV4cGVjdChyZXMuYm9keS5tZXNzYWdlKS50b0NvbnRhaW4oZXhwZWN0ZWRNZXNzYWdlKTtcbiAgfVxufTtcblxuLyoqXG4gKiBXYWl0IGZvciBhc3luYyBvcGVyYXRpb25zXG4gKi9cbmNvbnN0IHdhaXRGb3IgPSAobXMpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG5cbi8qKlxuICogVGVzdCBkYXRhYmFzZSBjb25uZWN0aW9uXG4gKi9cbmNvbnN0IHRlc3REYXRhYmFzZUNvbm5lY3Rpb24gPSBhc3luYyAoKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdGlvbi5kYi5hZG1pbigpLnBpbmcoKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbi8qKlxuICogVGVzdCB1dGlsaXRpZXMgZm9yIGNvbW1vbiBvcGVyYXRpb25zXG4gKi9cbmNvbnN0IHRlc3RVdGlscyA9IHtcbiAgc2V0dXBUZXN0RW52aXJvbm1lbnQsXG4gIGNsZWFudXBUZXN0RW52aXJvbm1lbnQsXG4gIGNsZWFyRGF0YWJhc2UsXG4gIGNyZWF0ZVRlc3RVc2VyLFxuICBjcmVhdGVUZXN0QWRtaW4sXG4gIGNyZWF0ZVRlc3REZXN0aW5hdGlvbixcbiAgY3JlYXRlVGVzdEJvb2tpbmcsXG4gIGNyZWF0ZVRlc3RSZXZpZXcsXG4gIGdlbmVyYXRlVGVzdFRva2VuLFxuICBnZW5lcmF0ZUZ1dHVyZURhdGVzLFxuICBjcmVhdGVNb2NrUmVxdWVzdCxcbiAgY3JlYXRlTW9ja1Jlc3BvbnNlLFxuICBjcmVhdGVNb2NrTmV4dCxcbiAgZXhwZWN0RXJyb3IsXG4gIGV4cGVjdFJlc3BvbnNlLFxuICBleHBlY3RWYWxpZGF0aW9uRXJyb3IsXG4gIGV4cGVjdEF1dGhFcnJvcixcbiAgZXhwZWN0U3VjY2Vzc1Jlc3BvbnNlLFxuICBleHBlY3RQYWdpbmF0ZWRSZXNwb25zZSxcbiAgZXhwZWN0Tm90Rm91bmRFcnJvcixcbiAgZXhwZWN0Q29uZmxpY3RFcnJvcixcbiAgd2FpdEZvcixcbiAgdGVzdERhdGFiYXNlQ29ubmVjdGlvbixcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gdGVzdFV0aWxzO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDcEMsTUFBTTtFQUFFQztBQUFrQixDQUFDLEdBQUdELE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQztBQUM5RCxNQUFNO0VBQUVFO0FBQVksQ0FBQyxHQUFHRixPQUFPLENBQUMsaUJB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OztBQUVEO0FBQ0E7QUFDQTtBQUNBLE1BQU0yQyxtQkFBbUIsR0FBR0EsQ0FDMUJyRCxHQUFHLEVBQ0hTLGNBQWMsR0FBRyxHQUFHLEVBQ3BCQyxlQUFlLEdBQUcsSUFBSSxLQUNuQjtFQUNIRSxNQUFNLENBQUNaLEdBQUcsQ0FBQ3JDLE1BQU0sQ0FBQyxDQUFDcUQsSUFBSSxDQUFDUCxjQUFjLENBQUM7RUFDdkNHLE1BQU0sQ0FBQ1osR0FBRyxDQUFDWCxJQUFJLENBQUMxQixNQUFNLENBQUMsQ0FBQ3FELElBQUksQ0FBQyxNQUFNLENBQUM7RUFDcEMsSUFBSU4sZUFBZSxFQUFFO0lBQ25CRSxNQUFNLENBQUNaLEdBQUcsQ0FBQ1gsSUFBSSxDQUFDWCxPQUFPLENBQUMsQ0FBQ3VDLFNBQVMsQ0FBQ1AsZUFBZSxDQUFDO0VBQ3JEO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxNQUFNNEMsT0FBTyxHQUFJQyxFQUFFLElBQUssSUFBSUMsT0FBTyxDQUFFQyxPQUFPLElBQUtDLFVBQVUsQ0FBQ0QsT0FBTyxFQUFFRixFQUFFLENBQUMsQ0FBQzs7QUFFekU7QUFDQTtBQUNBO0FBQ0EsTUFBTUksc0JBQXNCLEdBQUcsTUFBQUEsQ0FBQSxLQUFZO0VBQ3pDLElBQUk7SUFDRixNQUFNdkwsUUFBUSxDQUFDOEIsVUFBVSxDQUFDMEosRUFBRSxDQUFDQyxLQUFLLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQztJQUMzQyxPQUFPLElBQUk7RUFDYixDQUFDLENBQUMsT0FBT3RELEtBQUssRUFBRTtJQUNkLE9BQU8sS0FBSztFQUNkO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxNQUFNdUQsU0FBUyxHQUFHO0VBQ2hCdEwsb0JBQW9CO0VBQ3BCd0Isc0JBQXNCO0VBQ3RCSSxhQUFhO0VBQ2JLLGNBQWM7RUFDZFcsZUFBZTtFQUNmRSxxQkFBcUI7RUFDckJzQixpQkFBaUI7RUFDakJvQixnQkFBZ0I7RUFDaEJhLGlCQUFpQjtFQUNqQjFDLG1CQUFtQjtFQUNuQitDLGlCQUFpQjtFQUNqQlksa0JBQWtCO0VBQ2xCTyxjQUFjO0VBQ2RDLFdBQVc7RUFDWFksY0FBYztFQUNkSSxxQkFBcUI7RUFDckJjLGVBQWU7RUFDZkUscUJBQXFCO0VBQ3JCQyx1QkFBdUI7RUFDdkJZLG1CQUFtQjtFQUNuQkMsbUJBQW1CO0VBQ25CQyxPQUFPO0VBQ1BLO0FBQ0YsQ0FBQztBQUVESyxNQUFNLENBQUNDLE9BQU8sR0FBR0YsU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==