32ffb325f8388b6ae1c00d6b23289c10
const mongoose = require('mongoose');
const notificationSchema = new mongoose.Schema({
  // User who will receive the notification
  user: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
    required: [true, 'Notification must belong to a user']
  },
  // Related entities (optional)
  booking: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Booking',
    required: false
  },
  destination: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Destination',
    required: false
  },
  // Notification content
  title: {
    type: String,
    required: [true, 'Notification title is required'],
    trim: true,
    maxlength: [100, 'Title cannot exceed 100 characters']
  },
  message: {
    type: String,
    required: [true, 'Notification message is required'],
    trim: true,
    maxlength: [500, 'Message cannot exceed 500 characters']
  },
  // Notification type
  type: {
    type: String,
    required: [true, 'Notification type is required'],
    enum: {
      values: ['booking_confirmed', 'booking_cancelled', 'booking_reminder', 'payment_success', 'payment_failed', 'review_request', 'destination_update', 'promotion', 'system'],
      message: 'Invalid notification type'
    }
  },
  // Notification priority
  priority: {
    type: String,
    enum: {
      values: ['low', 'medium', 'high', 'urgent'],
      message: 'Priority must be low, medium, high, or urgent'
    },
    default: 'medium'
  },
  // Read status
  isRead: {
    type: Boolean,
    default: false
  },
  // Read timestamp
  readAt: {
    type: Date,
    required: false
  },
  // Action URL (optional)
  actionUrl: {
    type: String,
    required: false,
    maxlength: [200, 'Action URL cannot exceed 200 characters']
  },
  // Action text (optional)
  actionText: {
    type: String,
    required: false,
    maxlength: [50, 'Action text cannot exceed 50 characters']
  },
  // Expiration date (optional)
  expiresAt: {
    type: Date,
    required: false
  }
}, {
  timestamps: true,
  toJSON: {
    virtuals: true
  },
  toObject: {
    virtuals: true
  }
});

// Index for better query performance
notificationSchema.index({
  user: 1,
  createdAt: -1
});
notificationSchema.index({
  user: 1,
  isRead: 1
});
notificationSchema.index({
  type: 1
});
notificationSchema.index({
  expiresAt: 1
}, {
  expireAfterSeconds: 0
}); // TTL index

// Virtual field for notification age
notificationSchema.virtual('age').get(function () {
  const now = new Date();
  const created = new Date(this.createdAt);
  const diffTime = Math.abs(now - created);
  const diffMinutes = Math.floor(diffTime / (1000 * 60));
  const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
  const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
  if (diffMinutes < 1) {
    return 'Just now';
  }
  if (diffMinutes < 60) {
    return `${diffMinutes}m ago`;
  }
  if (diffHours < 24) {
    return `${diffHours}h ago`;
  }
  if (diffDays < 7) {
    return `${diffDays}d ago`;
  }
  return created.toLocaleDateString();
});

// Static method to create notification
notificationSchema.statics.createNotification = async function (notificationData) {
  const notification = new this(notificationData);
  await notification.save();
  return notification;
};

// Static method to mark notifications as read
notificationSchema.statics.markAsRead = async function (userId, notificationIds) {
  const updateData = {
    isRead: true,
    readAt: new Date()
  };
  if (notificationIds && notificationIds.length > 0) {
    return await this.updateMany({
      _id: {
        $in: notificationIds
      },
      user: userId
    }, updateData);
  } else {
    return await this.updateMany({
      user: userId,
      isRead: false
    }, updateData);
  }
};

// Static method to get unread count
notificationSchema.statics.getUnreadCount = async function (userId) {
  return await this.countDocuments({
    user: userId,
    isRead: false
  });
};

// Static method to cleanup expired notifications
notificationSchema.statics.cleanupExpired = async function () {
  return await this.deleteMany({
    expiresAt: {
      $lt: new Date()
    }
  });
};
const Notification = mongoose.model('Notification', notificationSchema);
module.exports = Notification;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJub3RpZmljYXRpb25TY2hlbWEiLCJTY2hlbWEiLCJ1c2VyIiwidHlwZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJyZXF1aXJlZCIsImJvb2tpbmciLCJkZXN0aW5hdGlvbiIsInRpdGxlIiwiU3RyaW5nIiwidHJpbSIsIm1heGxlbmd0aCIsIm1lc3NhZ2UiLCJlbnVtIiwidmFsdWVzIiwicHJpb3JpdHkiLCJkZWZhdWx0IiwiaXNSZWFkIiwiQm9vbGVhbiIsInJlYWRBdCIsIkRhdGUiLCJhY3Rpb25VcmwiLCJhY3Rpb25UZXh0IiwiZXhwaXJlc0F0IiwidGltZXN0YW1wcyIsInRvSlNPTiIsInZpcnR1YWxzIiwidG9PYmplY3QiLCJpbmRleCIsImNyZWF0ZWRBdCIsImV4cGlyZUFmdGVyU2Vjb25kcyIsInZpcnR1YWwiLCJnZXQiLCJub3ciLCJjcmVhdGVkIiwiZGlmZlRpbWUiLCJNYXRoIiwiYWJzIiwiZGlmZk1pbnV0ZXMiLCJmbG9vciIsImRpZmZIb3VycyIsImRpZmZEYXlzIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwic3RhdGljcyIsImNyZWF0ZU5vdGlmaWNhdGlvbiIsIm5vdGlmaWNhdGlvbkRhdGEiLCJub3RpZmljYXRpb24iLCJzYXZlIiwibWFya0FzUmVhZCIsInVzZXJJZCIsIm5vdGlmaWNhdGlvbklkcyIsInVwZGF0ZURhdGEiLCJsZW5ndGgiLCJ1cGRhdGVNYW55IiwiX2lkIiwiJGluIiwiZ2V0VW5yZWFkQ291bnQiLCJjb3VudERvY3VtZW50cyIsImNsZWFudXBFeHBpcmVkIiwiZGVsZXRlTWFueSIsIiRsdCIsIk5vdGlmaWNhdGlvbiIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIm5vdGlmaWNhdGlvbi5tb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5cbmNvbnN0IG5vdGlmaWNhdGlvblNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoXG4gIHtcbiAgICAvLyBVc2VyIHdobyB3aWxsIHJlY2VpdmUgdGhlIG5vdGlmaWNhdGlvblxuICAgIHVzZXI6IHtcbiAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICAgIHJlZjogJ1VzZXInLFxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCAnTm90aWZpY2F0aW9uIG11c3QgYmVsb25nIHRvIGEgdXNlciddXG4gICAgfSxcblxuICAgIC8vIFJlbGF0ZWQgZW50aXRpZXMgKG9wdGlvbmFsKVxuICAgIGJvb2tpbmc6IHtcbiAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICAgIHJlZjogJ0Jvb2tpbmcnLFxuICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgfSxcblxuICAgIGRlc3RpbmF0aW9uOiB7XG4gICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXG4gICAgICByZWY6ICdEZXN0aW5hdGlvbicsXG4gICAgICByZXF1aXJlZDogZmFsc2VcbiAgICB9LFxuXG4gICAgLy8gTm90aWZpY2F0aW9uIGNvbnRlbnRcbiAgICB0aXRsZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCAnTm90aWZpY2F0aW9uIHRpdGxlIGlzIHJlcXVpcmVkJ10sXG4gICAgICB0cmltOiB0cnVlLFxuICAgICAgbWF4bGVuZ3RoOiBbMTAwLCAnVGl0bGUgY2Fubm90IGV4Y2VlZCAxMDAgY2hhcmFjdGVycyddXG4gICAgfSxcblxuICAgIG1lc3NhZ2U6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ05vdGlmaWNhdGlvbiBtZXNzYWdlIGlzIHJlcXVpcmVkJ10sXG4gICAgICB0cmltOiB0cnVlLFxuICAgICAgbWF4bGVuZ3RoOiBbNTAwLCAnTWVzc2FnZSBjYW5ub3QgZXhjZWVkIDUwMCBjaGFyYWN0ZXJzJ11cbiAgICB9LFxuXG4gICAgLy8gTm90aWZpY2F0aW9uIHR5cGVcbiAgICB0eXBlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogW3RydWUsICdOb3RpZmljYXRpb24gdHlwZSBpcyByZXF1aXJlZCddLFxuICAgICAgZW51bToge1xuICAgICAgICB2YWx1ZXM6IFtcbiAgICAgICAgICAnYm9va2luZ19jb25maXJtZWQnLFxuICAgICAgICAgICdib29raW5nX2NhbmNlbGxlZCcsXG4gICAgICAgICAgJ2Jvb2tpbmdfcmVtaW5kZXInLFxuICAgICAgICAgICdwYXltZW50X3N1Y2Nlc3MnLFxuICAgICAgICAgICdwYXltZW50X2ZhaWxlZCcsXG4gICAgICAgICAgJ3Jldmlld19yZXF1ZXN0JyxcbiAgICAgICAgICAnZGVzdGluYXRpb25fdXBkYXRlJyxcbiAgICAgICAgICAncHJvbW90aW9uJyxcbiAgICAgICAgICAnc3lzdGVtJ1xuICAgICAgICBdLFxuICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBub3RpZmljYXRpb24gdHlwZSdcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gTm90aWZpY2F0aW9uIHByaW9yaXR5XG4gICAgcHJpb3JpdHk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGVudW06IHtcbiAgICAgICAgdmFsdWVzOiBbJ2xvdycsICdtZWRpdW0nLCAnaGlnaCcsICd1cmdlbnQnXSxcbiAgICAgICAgbWVzc2FnZTogJ1ByaW9yaXR5IG11c3QgYmUgbG93LCBtZWRpdW0sIGhpZ2gsIG9yIHVyZ2VudCdcbiAgICAgIH0sXG4gICAgICBkZWZhdWx0OiAnbWVkaXVtJ1xuICAgIH0sXG5cbiAgICAvLyBSZWFkIHN0YXR1c1xuICAgIGlzUmVhZDoge1xuICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgIGRlZmF1bHQ6IGZhbHNlXG4gICAgfSxcblxuICAgIC8vIFJlYWQgdGltZXN0YW1wXG4gICAgcmVhZEF0OiB7XG4gICAgICB0eXBlOiBEYXRlLFxuICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgfSxcblxuICAgIC8vIEFjdGlvbiBVUkwgKG9wdGlvbmFsKVxuICAgIGFjdGlvblVybDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgbWF4bGVuZ3RoOiBbMjAwLCAnQWN0aW9uIFVSTCBjYW5ub3QgZXhjZWVkIDIwMCBjaGFyYWN0ZXJzJ11cbiAgICB9LFxuXG4gICAgLy8gQWN0aW9uIHRleHQgKG9wdGlvbmFsKVxuICAgIGFjdGlvblRleHQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgIG1heGxlbmd0aDogWzUwLCAnQWN0aW9uIHRleHQgY2Fubm90IGV4Y2VlZCA1MCBjaGFyYWN0ZXJzJ11cbiAgICB9LFxuXG4gICAgLy8gRXhwaXJhdGlvbiBkYXRlIChvcHRpb25hbClcbiAgICBleHBpcmVzQXQ6IHtcbiAgICAgIHR5cGU6IERhdGUsXG4gICAgICByZXF1aXJlZDogZmFsc2VcbiAgICB9XG4gIH0sXG4gIHtcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjogeyB2aXJ0dWFsczogdHJ1ZSB9LFxuICAgIHRvT2JqZWN0OiB7IHZpcnR1YWxzOiB0cnVlIH1cbiAgfVxuKTtcblxuLy8gSW5kZXggZm9yIGJldHRlciBxdWVyeSBwZXJmb3JtYW5jZVxubm90aWZpY2F0aW9uU2NoZW1hLmluZGV4KHsgdXNlcjogMSwgY3JlYXRlZEF0OiAtMSB9KTtcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IHVzZXI6IDEsIGlzUmVhZDogMSB9KTtcbm5vdGlmaWNhdGlvblNjaGVtYS5pbmRleCh7IHR5cGU6IDEgfSk7XG5ub3RpZmljYXRpb25TY2hlbWEuaW5kZXgoeyBleHBpcmVzQXQ6IDEgfSwgeyBleHBpcmVBZnRlclNlY29uZHM6IDAgfSk7IC8vIFRUTCBpbmRleFxuXG4vLyBWaXJ0dWFsIGZpZWxkIGZvciBub3RpZmljYXRpb24gYWdlXG5ub3RpZmljYXRpb25TY2hlbWEudmlydHVhbCgnYWdlJykuZ2V0KGZ1bmN0aW9uKCkge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBjcmVhdGVkID0gbmV3IERhdGUodGhpcy5jcmVhdGVkQXQpO1xuICBjb25zdCBkaWZmVGltZSA9IE1hdGguYWJzKG5vdyAtIGNyZWF0ZWQpO1xuICBjb25zdCBkaWZmTWludXRlcyA9IE1hdGguZmxvb3IoZGlmZlRpbWUgLyAoMTAwMCAqIDYwKSk7XG4gIGNvbnN0IGRpZmZIb3VycyA9IE1hdGguZmxvb3IoZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjApKTtcbiAgY29uc3QgZGlmZkRheXMgPSBNYXRoLmZsb29yKGRpZmZUaW1lIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcblxuICBpZiAoZGlmZk1pbnV0ZXMgPCAxKSB7XG4gICAgcmV0dXJuICdKdXN0IG5vdyc7XG4gIH1cbiAgaWYgKGRpZmZNaW51dGVzIDwgNjApIHtcbiAgICByZXR1cm4gYCR7ZGlmZk1pbnV0ZXN9bSBhZ29gO1xuICB9XG4gIGlmIChkaWZmSG91cnMgPCAyNCkge1xuICAgIHJldHVybiBgJHtkaWZmSG91cnN9aCBhZ29gO1xuICB9XG4gIGlmIChkaWZmRGF5cyA8IDcpIHtcbiAgICByZXR1cm4gYCR7ZGlmZkRheXN9ZCBhZ29gO1xuICB9XG4gIHJldHVybiBjcmVhdGVkLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xufSk7XG5cbi8vIFN0YXRpYyBtZXRob2QgdG8gY3JlYXRlIG5vdGlmaWNhdGlvblxubm90aWZpY2F0aW9uU2NoZW1hLnN0YXRpY3MuY3JlYXRlTm90aWZpY2F0aW9uID0gYXN5bmMgZnVuY3Rpb24obm90aWZpY2F0aW9uRGF0YSkge1xuICBjb25zdCBub3RpZmljYXRpb24gPSBuZXcgdGhpcyhub3RpZmljYXRpb25EYXRhKTtcbiAgYXdhaXQgbm90aWZpY2F0aW9uLnNhdmUoKTtcbiAgcmV0dXJuIG5vdGlmaWNhdGlvbjtcbn07XG5cbi8vIFN0YXRpYyBtZXRob2QgdG8gbWFyayBub3RpZmljYXRpb25zIGFzIHJlYWRcbm5vdGlmaWNhdGlvblNjaGVtYS5zdGF0aWNzLm1hcmtBc1JlYWQgPSBhc3luYyBmdW5jdGlvbih1c2VySWQsIG5vdGlmaWNhdGlvbklkcykge1xuICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgIGlzUmVhZDogdHJ1ZSxcbiAgICByZWFkQXQ6IG5ldyBEYXRlKClcbiAgfTtcblxuICBpZiAobm90aWZpY2F0aW9uSWRzICYmIG5vdGlmaWNhdGlvbklkcy5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMudXBkYXRlTWFueShcbiAgICAgIHsgX2lkOiB7ICRpbjogbm90aWZpY2F0aW9uSWRzIH0sIHVzZXI6IHVzZXJJZCB9LFxuICAgICAgdXBkYXRlRGF0YVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMudXBkYXRlTWFueShcbiAgICAgIHsgdXNlcjogdXNlcklkLCBpc1JlYWQ6IGZhbHNlIH0sXG4gICAgICB1cGRhdGVEYXRhXG4gICAgKTtcbiAgfVxufTtcblxuLy8gU3RhdGljIG1ldGhvZCB0byBnZXQgdW5yZWFkIGNvdW50XG5ub3RpZmljYXRpb25TY2hlbWEuc3RhdGljcy5nZXRVbnJlYWRDb3VudCA9IGFzeW5jIGZ1bmN0aW9uKHVzZXJJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5jb3VudERvY3VtZW50cyh7IHVzZXI6IHVzZXJJZCwgaXNSZWFkOiBmYWxzZSB9KTtcbn07XG5cbi8vIFN0YXRpYyBtZXRob2QgdG8gY2xlYW51cCBleHBpcmVkIG5vdGlmaWNhdGlvbnNcbm5vdGlmaWNhdGlvblNjaGVtYS5zdGF0aWNzLmNsZWFudXBFeHBpcmVkID0gYXN5bmMgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmRlbGV0ZU1hbnkoe1xuICAgIGV4cGlyZXNBdDogeyAkbHQ6IG5ldyBEYXRlKCkgfVxuICB9KTtcbn07XG5cbmNvbnN0IE5vdGlmaWNhdGlvbiA9IG1vbmdvb3NlLm1vZGVsKCdOb3RpZmljYXRpb24nLCBub3RpZmljYXRpb25TY2hlbWEpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IE5vdGlmaWNhdGlvbjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQyxNQUFNQyxrQkFBa0IsR0FBRyxJQUFJRixRQUFRLENBQUNHLE1BQU0sQ0FDNUM7RUFDRTtFQUNBQyxJQUFJLEVBQUU7SUFDSkMsSUFBSSxFQUFFTCxRQUFRLENBQUNHLE1BQU0sQ0FBQ0csS0FBSyxDQUFDQyxRQUFRO0lBQ3BDQyxHQUFHLEVBQUUsTUFBTTtJQUNYQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsb0NBQW9DO0VBQ3ZELENBQUM7RUFFRDtFQUNBQyxPQUFPLEVBQUU7SUFDUEwsSUFBSSxFQUFFTCxRQUFRLENBQUNHLE1BQU0sQ0FBQ0csS0FBSyxDQUFDQyxRQUFRO0lBQ3BDQyxHQUFHLEVBQUUsU0FBUztJQUNkQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBRURFLFdBQVcsRUFBRTtJQUNYTixJQUFJLEVBQUVMLFFBQVEsQ0FBQ0csTUFBTSxDQUFDRyxLQUFLLENBQUNDLFFBQVE7SUFDcENDLEdBQUcsRUFBRSxhQUFhO0lBQ2xCQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBRUQ7RUFDQUcsS0FBSyxFQUFFO0lBQ0xQLElBQUksRUFBRVEsTUFBTTtJQUNaSixRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsZ0NBQWdDLENBQUM7SUFDbERLLElBQUksRUFBRSxJQUFJO0lBQ1ZDLFNBQVMsRUFBRSxDQUFDLEdBQUcsRUFBRSxvQ0FBb0M7RUFDdkQsQ0FBQztFQUVEQyxPQUFPLEVBQUU7SUFDUFgsSUFBSSxFQUFFUSxNQUFNO0lBQ1pKLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSxrQ0FBa0MsQ0FBQztJQUNwREssSUFBSSxFQUFFLElBQUk7SUFDVkMsU0FBUyxFQUFFLENBQUMsR0FBRyxFQUFFLHNDQUFzQztFQUN6RCxDQUFDO0VBRUQ7RUFDQVYsSUFBSSxFQUFF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