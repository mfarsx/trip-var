eb796ebcdac1bdc71c2a9bfa721786c8
const Review = require('../public/models/review.model');
const Destination = require('../public/models/destination.model');
const Booking = require('../public/models/booking.model');
const {
  ValidationError,
  NotFoundError,
  ConflictError
} = require('../utils/errors');
const {
  successResponse
} = require('../utils/response');
const {
  info,
  error
} = require('../utils/logger');

// Create a new review
const createReview = async (req, res, next) => {
  try {
    const {
      destinationId,
      bookingId,
      title,
      content,
      rating,
      ratings
    } = req.body;
    const userId = req.user.id;

    // Validate required fields
    if (!destinationId || !title || !content || !rating) {
      throw new ValidationError('Missing required review information');
    }

    // Check if destination exists
    const destination = await Destination.findById(destinationId);
    if (!destination) {
      throw new NotFoundError('Destination not found');
    }

    // Check if user already reviewed this destination
    const existingReview = await Review.findOne({
      user: userId,
      destination: destinationId
    });
    if (existingReview) {
      throw new ConflictError('You have already reviewed this destination');
    }

    // If bookingId is provided, verify the booking belongs to the user
    if (bookingId) {
      const booking = await Booking.findOne({
        _id: bookingId,
        user: userId,
        destination: destinationId
      });
      if (!booking) {
        throw new ValidationError('Invalid booking reference');
      }
    }

    // Create review
    const review = new Review({
      user: userId,
      destination: destinationId,
      booking: bookingId,
      title,
      content,
      rating,
      ratings
    });
    await review.save();

    // Populate the review with user details
    await review.populate('user', 'name email');
    info('New review created', {
      reviewId: review._id,
      userId,
      destinationId,
      rating
    });
    res.status(201).json(successResponse({
      review
    }, 'Review created successfully'));
  } catch (err) {
    error('Error creating review', {
      error: err.message,
      userId: req.user?.id
    });
    next(err);
  }
};

// Get reviews for a destination
const getDestinationReviews = async (req, res, next) => {
  try {
    const {
      destinationId
    } = req.params;
    const {
      page = 1,
      limit = 10,
      sort = 'newest'
    } = req.query;

    // Check if destination exists
    const destination = await Destination.findById(destinationId);
    if (!destination) {
      throw new NotFoundError('Destination not found');
    }

    // Build sort object
    let sortObj = {};
    switch (sort) {
      case 'newest':
        sortObj = {
          createdAt: -1
        };
        break;
      case 'oldest':
        sortObj = {
          createdAt: 1
        };
        break;
      case 'highest':
        sortObj = {
          rating: -1
        };
        break;
      case 'lowest':
        sortObj = {
          rating: 1
        };
        break;
      case 'most_helpful':
        sortObj = {
          helpfulVotes: -1
        };
        break;
      default:
        sortObj = {
          createdAt: -1
        };
    }

    // Calculate pagination
    const skip = (parseInt(page, 10) - 1) * parseInt(limit, 10);

    // Get reviews with pagination
    const reviews = await Review.find({
      destination: destinationId,
      status: 'approved'
    }).populate('user', 'name email').sort(sortObj).skip(skip).limit(parseInt(limit, 10));

    // Get total count
    const total = await Review.countDocuments({
      destination: destinationId,
      status: 'approved'
    });

    // Get rating statistics
    const stats = await Review.aggregate([{
      $match: {
        destination: destinationId,
        status: 'approved'
      }
    }, {
      $group: {
        _id: null,
        averageRating: {
          $avg: '$rating'
        },
        totalReviews: {
          $sum: 1
        },
        ratingDistribution: {
          $push: '$rating'
        }
      }
    }]);
    let ratingStats = {
      averageRating: 0,
      totalReviews: 0,
      distribution: {
        5: 0,
        4: 0,
        3: 0,
        2: 0,
        1: 0
      }
    };
    if (stats.length > 0) {
      const stat = stats[0];
      ratingStats.averageRating = Math.round(stat.averageRating * 10) / 10;
      ratingStats.totalReviews = stat.totalReviews;

      // Calculate distribution
      stat.ratingDistribution.forEach(rating => {
        ratingStats.distribution[rating]++;
      });
    }
    res.json(successResponse({
      reviews,
      ratingStats,
      pagination: {
        current: parseInt(page, 10),
        pages: Math.ceil(total / parseInt(limit, 10)),
        total
      }
    }, 'Reviews retrieved successfully'));
  } catch (err) {
    error('Error fetching reviews', {
      error: err.message,
      destinationId: req.params.destinationId
    });
    next(err);
  }
};

// Get user's reviews
const getUserReviews = async (req, res, next) => {
  try {
    const userId = req.user.id;
    const {
      page = 1,
      limit = 10
    } = req.query;

    // Calculate pagination
    const skip = (parseInt(page, 10) - 1) * parseInt(limit, 10);

    // Get user's reviews
    const reviews = await Review.find({
      user: userId
    }).populate('destination', 'title location imageUrl').sort({
      createdAt: -1
    }).skip(skip).limit(parseInt(limit, 10));

    // Get total count
    const total = await Review.countDocuments({
      user: userId
    });
    res.json(successResponse({
      reviews,
      pagination: {
        current: parseInt(page, 10),
        pages: Math.ceil(total / parseInt(limit, 10)),
        total
      }
    }, 'User reviews retrieved successfully'));
  } catch (err) {
    error('Error fetching user reviews', {
      error: err.message,
      userId: req.user?.id
    });
    next(err);
  }
};

// Update a review
const updateReview = async (req, res, next) => {
  try {
    const {
      reviewId
    } = req.params;
    const {
      title,
      content,
      rating,
      ratings
    } = req.body;
    const userId = req.user.id;
    const review = await Review.findById(reviewId);
    if (!review) {
      throw new NotFoundError('Review not found');
    }

    // Check if user owns this review
    if (review.user.toString() !== userId) {
      throw new ValidationError('Access denied');
    }

    // Update review
    const updatedReview = await Review.findByIdAndUpdate(reviewId, {
      title,
      content,
      rating,
      ratings
    }, {
      new: true,
      runValidators: true
    }).populate('user', 'name email');
    info('Review updated', {
      reviewId,
      userId
    });
    res.json(successResponse({
      review: updatedReview
    }, 'Review updated successfully'));
  } catch (err) {
    error('Error updating review', {
      error: err.message,
      reviewId: req.params.reviewId
    });
    next(err);
  }
};

// Delete a review
const deleteReview = async (req, res, next) => {
  try {
    const {
      reviewId
    } = req.params;
    const userId = req.user.id;
    const review = await Review.findById(reviewId);
    if (!review) {
      throw new NotFoundError('Review not found');
    }

    // Check if user owns this review or is admin
    if (review.user.toString() !== userId && req.user.role !== 'admin') {
      throw new ValidationError('Access denied');
    }
    await Review.findByIdAndDelete(reviewId);
    info('Review deleted', {
      reviewId,
      userId,
      deletedBy: req.user.role
    });
    res.json(successResponse(null, 'Review deleted successfully'));
  } catch (err) {
    error('Error deleting review', {
      error: err.message,
      reviewId: req.params.reviewId
    });
    next(err);
  }
};

// Mark review as helpful
const markReviewHelpful = async (req, res, next) => {
  try {
    const {
      reviewId
    } = req.params;
    const userId = req.user.id;
    const review = await Review.findById(reviewId);
    if (!review) {
      throw new NotFoundError('Review not found');
    }

    // Check if user already marked this review as helpful
    const isAlreadyHelpful = review.helpfulUsers.includes(userId);
    if (isAlreadyHelpful) {
      // Remove helpful vote
      review.helpfulUsers = review.helpfulUsers.filter(id => id.toString() !== userId);
      review.helpfulVotes = Math.max(0, review.helpfulVotes - 1);
    } else {
      // Add helpful vote
      review.helpfulUsers.push(userId);
      review.helpfulVotes += 1;
    }
    await review.save();
    res.json(successResponse({
      helpful: !isAlreadyHelpful,
      helpfulVotes: review.helpfulVotes
    }, `Review ${isAlreadyHelpful ? 'unmarked' : 'marked'} as helpful`));
  } catch (err) {
    error('Error marking review helpful', {
      error: err.message,
      reviewId: req.params.reviewId
    });
    next(err);
  }
};

// Get all reviews (admin only)
const getAllReviews = async (req, res, next) => {
  try {
    const {
      status,
      page = 1,
      limit = 20,
      destinationId
    } = req.query;

    // Build query
    const query = {};
    if (status) {
      query.status = status;
    }
    if (destinationId) {
      query.destination = destinationId;
    }

    // Calculate pagination
    const skip = (parseInt(page, 10) - 1) * parseInt(limit, 10);

    // Get reviews with pagination
    const reviews = await Review.find(query).populate('destination', 'title location').populate('user', 'name email').sort({
      createdAt: -1
    }).skip(skip).limit(parseInt(limit, 10));

    // Get total count
    const total = await Review.countDocuments(query);
    res.json(successResponse({
      reviews,
      pagination: {
        current: parseInt(page, 10),
        pages: Math.ceil(total / parseInt(limit, 10)),
        total
      }
    }, 'All reviews retrieved successfully'));
  } catch (err) {
    error('Error fetching all reviews', {
      error: err.message
    });
    next(err);
  }
};

// Update review status (admin only)
const updateReviewStatus = async (req, res, next) => {
  try {
    const {
      reviewId
    } = req.params;
    const {
      status,
      adminResponse
    } = req.body;
    const validStatuses = ['pending', 'approved', 'rejected'];
    if (!validStatuses.includes(status)) {
      throw new ValidationError('Invalid review status');
    }
    const review = await Review.findById(reviewId);
    if (!review) {
      throw new NotFoundError('Review not found');
    }

    // Update review status
    review.status = status;

    // Add admin response if provided
    if (adminResponse) {
      review.adminResponse = {
        content: adminResponse,
        respondedBy: req.user.id,
        respondedAt: new Date()
      };
    }
    await review.save();

    // Populate the review
    await review.populate([{
      path: 'user',
      select: 'name email'
    }, {
      path: 'destination',
      select: 'title location'
    }]);
    info('Review status updated', {
      reviewId,
      newStatus: status,
      adminId: req.user.id
    });
    res.json(successResponse({
      review
    }, 'Review status updated successfully'));
  } catch (err) {
    error('Error updating review status', {
      error: err.message,
      reviewId: req.params.reviewId
    });
    next(err);
  }
};
module.exports = {
  createReview,
  getDestinationReviews,
  getUserReviews,
  updateReview,
  deleteReview,
  markReviewHelpful,
  getAllReviews,
  updateReviewStatus
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZXZpZXciLCJyZXF1aXJlIiwiRGVzdGluYXRpb24iLCJCb29raW5nIiwiVmFsaWRhdGlvbkVycm9yIiwiTm90Rm91bmRFcnJvciIsIkNvbmZsaWN0RXJyb3IiLCJzdWNjZXNzUmVzcG9uc2UiLCJpbmZvIiwiZXJyb3IiLCJjcmVhdGVSZXZpZXciLCJyZXEiLCJyZXMiLCJuZXh0IiwiZGVzdGluYXRpb25JZCIsImJvb2tpbmdJZCIsInRpdGxlIiwiY29udGVudCIsInJhdGluZyIsInJhdGluZ3MiLCJib2R5IiwidXNlcklkIiwidXNlciIsImlkIiwiZGVzdGluYXRpb24iLCJmaW5kQnlJZCIsImV4aXN0aW5nUmV2aWV3IiwiZmluZE9uZSIsImJvb2tpbmciLCJfaWQiLCJyZXZpZXciLCJzYXZlIiwicG9wdWxhdGUiLCJyZXZpZXdJZCIsInN0YXR1cyIsImpzb24iLCJlcnIiLCJtZXNzYWdlIiwiZ2V0RGVzdGluYXRpb25SZXZpZXdzIiwicGFyYW1zIiwicGFnZSIsImxpbWl0Iiwic29ydCIsInF1ZXJ5Iiwic29ydE9iaiIsImNyZWF0ZWRBdCIsImhlbHBmdWxWb3RlcyIsInNraXAiLCJwYXJzZUludCIsInJldmlld3MiLCJmaW5kIiwidG90YWwiLCJjb3VudERvY3VtZW50cyIsInN0YXRzIiwiYWdncmVnYXRlIiwiJG1hdGNoIiwiJGdyb3VwIiwiYXZlcmFnZVJhdGluZyIsIiRhdmciLCJ0b3RhbFJldmlld3MiLCIkc3VtIiwicmF0aW5nRGlzdHJpYnV0aW9uIiwiJHB1c2giLCJyYXRpbmdTdGF0cyIsImRpc3RyaWJ1dGlvbiIsImxlbmd0aCIsInN0YXQiLCJNYXRoIiwicm91bmQiLCJmb3JFYWNoIiwicGFnaW5hdGlvbiIsImN1cnJlbnQiLCJwYWdlcyIsImNlaWwiLCJnZXRVc2VyUmV2aWV3cyIsInVwZGF0ZVJldmlldyIsInRvU3RyaW5nIiwidXBkYXRlZFJldmlldyIsImZpbmRCeUlkQW5kVXBkYXRlIiwibmV3IiwicnVuVmFsaWRhdG9ycyIsImRlbGV0ZVJldmlldyIsInJvbGUiLCJmaW5kQnlJZEFuZERlbGV0ZSIsImRlbGV0ZWRCeSIsIm1hcmtSZXZpZXdIZWxwZnVsIiwiaXNBbHJlYWR5SGVscGZ1bCIsImhlbHBmdWxVc2VycyIsImluY2x1ZGVzIiwiZmlsdGVyIiwibWF4IiwicHVzaCIsImhlbHBmdWwiLCJnZXRBbGxSZXZpZXdzIiwidXBkYXRlUmV2aWV3U3RhdHVzIiwiYWRtaW5SZXNwb25zZSIsInZhbGlkU3RhdHVzZXMiLCJyZXNwb25kZWRCeSIsInJlc3BvbmRlZEF0IiwiRGF0ZSIsInBhdGgiLCJzZWxlY3QiLCJuZXdTdGF0dXMiLCJhZG1pbklkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInJldmlldy5jb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJldmlldyA9IHJlcXVpcmUoJy4uL3B1YmxpYy9tb2RlbHMvcmV2aWV3Lm1vZGVsJyk7XG5jb25zdCBEZXN0aW5hdGlvbiA9IHJlcXVpcmUoJy4uL3B1YmxpYy9tb2RlbHMvZGVzdGluYXRpb24ubW9kZWwnKTtcbmNvbnN0IEJvb2tpbmcgPSByZXF1aXJlKCcuLi9wdWJsaWMvbW9kZWxzL2Jvb2tpbmcubW9kZWwnKTtcbmNvbnN0IHsgVmFsaWRhdGlvbkVycm9yLCBOb3RGb3VuZEVycm9yLCBDb25mbGljdEVycm9yIH0gPSByZXF1aXJlKCcuLi91dGlscy9lcnJvcnMnKTtcbmNvbnN0IHsgc3VjY2Vzc1Jlc3BvbnNlIH0gPSByZXF1aXJlKCcuLi91dGlscy9yZXNwb25zZScpO1xuY29uc3QgeyBpbmZvLCBlcnJvciB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvbG9nZ2VyJyk7XG5cbi8vIENyZWF0ZSBhIG5ldyByZXZpZXdcbmNvbnN0IGNyZWF0ZVJldmlldyA9IGFzeW5jKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qge1xuICAgICAgZGVzdGluYXRpb25JZCxcbiAgICAgIGJvb2tpbmdJZCxcbiAgICAgIHRpdGxlLFxuICAgICAgY29udGVudCxcbiAgICAgIHJhdGluZyxcbiAgICAgIHJhdGluZ3NcbiAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICBjb25zdCB1c2VySWQgPSByZXEudXNlci5pZDtcblxuICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgIGlmICghZGVzdGluYXRpb25JZCB8fCAhdGl0bGUgfHwgIWNvbnRlbnQgfHwgIXJhdGluZykge1xuICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignTWlzc2luZyByZXF1aXJlZCByZXZpZXcgaW5mb3JtYXRpb24nKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBkZXN0aW5hdGlvbiBleGlzdHNcbiAgICBjb25zdCBkZXN0aW5hdGlvbiA9IGF3YWl0IERlc3RpbmF0aW9uLmZpbmRCeUlkKGRlc3RpbmF0aW9uSWQpO1xuICAgIGlmICghZGVzdGluYXRpb24pIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKCdEZXN0aW5hdGlvbiBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIGFscmVhZHkgcmV2aWV3ZWQgdGhpcyBkZXN0aW5hdGlvblxuICAgIGNvbnN0IGV4aXN0aW5nUmV2aWV3ID0gYXdhaXQgUmV2aWV3LmZpbmRPbmUoe1xuICAgICAgdXNlcjogdXNlcklkLFxuICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uSWRcbiAgICB9KTtcblxuICAgIGlmIChleGlzdGluZ1Jldmlldykge1xuICAgICAgdGhyb3cgbmV3IENvbmZsaWN0RXJyb3IoJ1lvdSBoYXZlIGFscmVhZHkgcmV2aWV3ZWQgdGhpcyBkZXN0aW5hdGlvbicpO1xuICAgIH1cblxuICAgIC8vIElmIGJvb2tpbmdJZCBpcyBwcm92aWRlZCwgdmVyaWZ5IHRoZSBib29raW5nIGJlbG9uZ3MgdG8gdGhlIHVzZXJcbiAgICBpZiAoYm9va2luZ0lkKSB7XG4gICAgICBjb25zdCBib29raW5nID0gYXdhaXQgQm9va2luZy5maW5kT25lKHtcbiAgICAgICAgX2lkOiBib29raW5nSWQsXG4gICAgICAgIHVzZXI6IHVzZXJJZCxcbiAgICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uSWRcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWJvb2tpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignSW52YWxpZCBib29raW5nIHJlZmVyZW5jZScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENyZWF0ZSByZXZpZXdcbiAgICBjb25zdCByZXZpZXcgPSBuZXcgUmV2aWV3KHtcbiAgICAgIHVzZXI6IHVzZXJJZCxcbiAgICAgIGRlc3RpbmF0aW9uOiBkZXN0aW5hdGlvbklkLFxuICAgICAgYm9va2luZzogYm9va2luZ0lkLFxuICAgICAgdGl0bGUsXG4gICAgICBjb250ZW50LFxuICAgICAgcmF0aW5nLFxuICAgICAgcmF0aW5nc1xuICAgIH0pO1xuXG4gICAgYXdhaXQgcmV2aWV3LnNhdmUoKTtcblxuICAgIC8vIFBvcHVsYXRlIHRoZSByZXZpZXcgd2l0aCB1c2VyIGRldGFpbHNcbiAgICBhd2FpdCByZXZpZXcucG9wdWxhdGUoJ3VzZXInLCAnbmFtZSBlbWFpbCcpO1xuXG4gICAgaW5mbygnTmV3IHJldmlldyBjcmVhdGVkJywge1xuICAgICAgcmV2aWV3SWQ6IHJldmlldy5faWQsXG4gICAgICB1c2VySWQsXG4gICAgICBkZXN0aW5hdGlvbklkLFxuICAgICAgcmF0aW5nXG4gICAgfSk7XG5cbiAgICByZXMuc3RhdHVzKDIwMSkuanNvbihcbiAgICAgIHN1Y2Nlc3NSZXNwb25zZShcbiAgICAgICAgeyByZXZpZXcgfSxcbiAgICAgICAgJ1JldmlldyBjcmVhdGVkIHN1Y2Nlc3NmdWxseSdcbiAgICAgIClcbiAgICApO1xuXG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGVycm9yKCdFcnJvciBjcmVhdGluZyByZXZpZXcnLCB7IGVycm9yOiBlcnIubWVzc2FnZSwgdXNlcklkOiByZXEudXNlcj8uaWQgfSk7XG4gICAgbmV4dChlcnIpO1xuICB9XG59O1xuXG4vLyBHZXQgcmV2aWV3cyBmb3IgYSBkZXN0aW5hdGlvblxuY29uc3QgZ2V0RGVzdGluYXRpb25SZXZpZXdzID0gYXN5bmMocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRlc3RpbmF0aW9uSWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgeyBwYWdlID0gMSwgbGltaXQgPSAxMCwgc29ydCA9ICduZXdlc3QnIH0gPSByZXEucXVlcnk7XG5cbiAgICAvLyBDaGVjayBpZiBkZXN0aW5hdGlvbiBleGlzdHNcbiAgICBjb25zdCBkZXN0aW5hdGlvbiA9IGF3YWl0IERlc3RpbmF0aW9uLmZpbmRCeUlkKGRlc3RpbmF0aW9uSWQpO1xuICAgIGlmICghZGVzdGluYXRpb24pIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKCdEZXN0aW5hdGlvbiBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICAvLyBCdWlsZCBzb3J0IG9iamVjdFxuICAgIGxldCBzb3J0T2JqID0ge307XG4gICAgc3dpdGNoIChzb3J0KSB7XG4gICAgY2FzZSAnbmV3ZXN0JzpcbiAgICAgIHNvcnRPYmogPSB7IGNyZWF0ZWRBdDogLTEgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ29sZGVzdCc6XG4gICAgICBzb3J0T2JqID0geyBjcmVhdGVkQXQ6IDEgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2hpZ2hlc3QnOlxuICAgICAgc29ydE9iaiA9IHsgcmF0aW5nOiAtMSB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbG93ZXN0JzpcbiAgICAgIHNvcnRPYmogPSB7IHJhdGluZzogMSB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbW9zdF9oZWxwZnVsJzpcbiAgICAgIHNvcnRPYmogPSB7IGhlbHBmdWxWb3RlczogLTEgfTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBzb3J0T2JqID0geyBjcmVhdGVkQXQ6IC0xIH07XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHBhZ2luYXRpb25cbiAgICBjb25zdCBza2lwID0gKHBhcnNlSW50KHBhZ2UsIDEwKSAtIDEpICogcGFyc2VJbnQobGltaXQsIDEwKTtcblxuICAgIC8vIEdldCByZXZpZXdzIHdpdGggcGFnaW5hdGlvblxuICAgIGNvbnN0IHJldmlld3MgPSBhd2FpdCBSZXZpZXcuZmluZCh7XG4gICAgICBkZXN0aW5hdGlvbjogZGVzdGluYXRpb25JZCxcbiAgICAgIHN0YXR1czogJ2FwcHJvdmVkJ1xuICAgIH0pXG4gICAgICAucG9wdWxhdGUoJ3VzZXInLCAnbmFtZSBlbWFpbCcpXG4gICAgICAuc29ydChzb3J0T2JqKVxuICAgICAgLnNraXAoc2tpcClcbiAgICAgIC5saW1pdChwYXJzZUludChsaW1pdCwgMTApKTtcblxuICAgIC8vIEdldCB0b3RhbCBjb3VudFxuICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgUmV2aWV3LmNvdW50RG9jdW1lbnRzKHtcbiAgICAgIGRlc3RpbmF0aW9uOiBkZXN0aW5hdGlvbklkLFxuICAgICAgc3RhdHVzOiAnYXBwcm92ZWQnXG4gICAgfSk7XG5cbiAgICAvLyBHZXQgcmF0aW5nIHN0YXRpc3RpY3NcbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IFJldmlldy5hZ2dyZWdhdGUoW1xuICAgICAge1xuICAgICAgICAkbWF0Y2g6IHtcbiAgICAgICAgICBkZXN0aW5hdGlvbjogZGVzdGluYXRpb25JZCxcbiAgICAgICAgICBzdGF0dXM6ICdhcHByb3ZlZCdcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJGdyb3VwOiB7XG4gICAgICAgICAgX2lkOiBudWxsLFxuICAgICAgICAgIGF2ZXJhZ2VSYXRpbmc6IHsgJGF2ZzogJyRyYXRpbmcnIH0sXG4gICAgICAgICAgdG90YWxSZXZpZXdzOiB7ICRzdW06IDEgfSxcbiAgICAgICAgICByYXRpbmdEaXN0cmlidXRpb246IHtcbiAgICAgICAgICAgICRwdXNoOiAnJHJhdGluZydcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdKTtcblxuICAgIGxldCByYXRpbmdTdGF0cyA9IHtcbiAgICAgIGF2ZXJhZ2VSYXRpbmc6IDAsXG4gICAgICB0b3RhbFJldmlld3M6IDAsXG4gICAgICBkaXN0cmlidXRpb246IHsgNTogMCwgNDogMCwgMzogMCwgMjogMCwgMTogMCB9XG4gICAgfTtcblxuICAgIGlmIChzdGF0cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBzdGF0ID0gc3RhdHNbMF07XG4gICAgICByYXRpbmdTdGF0cy5hdmVyYWdlUmF0aW5nID0gTWF0aC5yb3VuZChzdGF0LmF2ZXJhZ2VSYXRpbmcgKiAxMCkgLyAxMDtcbiAgICAgIHJhdGluZ1N0YXRzLnRvdGFsUmV2aWV3cyA9IHN0YXQudG90YWxSZXZpZXdzO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgZGlzdHJpYnV0aW9uXG4gICAgICBzdGF0LnJhdGluZ0Rpc3RyaWJ1dGlvbi5mb3JFYWNoKHJhdGluZyA9PiB7XG4gICAgICAgIHJhdGluZ1N0YXRzLmRpc3RyaWJ1dGlvbltyYXRpbmddKys7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXMuanNvbihcbiAgICAgIHN1Y2Nlc3NSZXNwb25zZShcbiAgICAgICAge1xuICAgICAgICAgIHJldmlld3MsXG4gICAgICAgICAgcmF0aW5nU3RhdHMsXG4gICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgY3VycmVudDogcGFyc2VJbnQocGFnZSwgMTApLFxuICAgICAgICAgICAgcGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIHBhcnNlSW50KGxpbWl0LCAxMCkpLFxuICAgICAgICAgICAgdG90YWxcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICdSZXZpZXdzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknXG4gICAgICApXG4gICAgKTtcblxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBlcnJvcignRXJyb3IgZmV0Y2hpbmcgcmV2aWV3cycsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCBkZXN0aW5hdGlvbklkOiByZXEucGFyYW1zLmRlc3RpbmF0aW9uSWQgfSk7XG4gICAgbmV4dChlcnIpO1xuICB9XG59O1xuXG4vLyBHZXQgdXNlcidzIHJldmlld3NcbmNvbnN0IGdldFVzZXJSZXZpZXdzID0gYXN5bmMocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VySWQgPSByZXEudXNlci5pZDtcbiAgICBjb25zdCB7IHBhZ2UgPSAxLCBsaW1pdCA9IDEwIH0gPSByZXEucXVlcnk7XG5cbiAgICAvLyBDYWxjdWxhdGUgcGFnaW5hdGlvblxuICAgIGNvbnN0IHNraXAgPSAocGFyc2VJbnQocGFnZSwgMTApIC0gMSkgKiBwYXJzZUludChsaW1pdCwgMTApO1xuXG4gICAgLy8gR2V0IHVzZXIncyByZXZpZXdzXG4gICAgY29uc3QgcmV2aWV3cyA9IGF3YWl0IFJldmlldy5maW5kKHsgdXNlcjogdXNlcklkIH0pXG4gICAgICAucG9wdWxhdGUoJ2Rlc3RpbmF0aW9uJywgJ3RpdGxlIGxvY2F0aW9uIGltYWdlVXJsJylcbiAgICAgIC5zb3J0KHsgY3JlYXRlZEF0OiAtMSB9KVxuICAgICAgLnNraXAoc2tpcClcbiAgICAgIC5saW1pdChwYXJzZUludChsaW1pdCwgMTApKTtcblxuICAgIC8vIEdldCB0b3RhbCBjb3VudFxuICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgUmV2aWV3LmNvdW50RG9jdW1lbnRzKHsgdXNlcjogdXNlcklkIH0pO1xuXG4gICAgcmVzLmpzb24oXG4gICAgICBzdWNjZXNzUmVzcG9uc2UoXG4gICAgICAgIHtcbiAgICAgICAgICByZXZpZXdzLFxuICAgICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICAgIGN1cnJlbnQ6IHBhcnNlSW50KHBhZ2UsIDEwKSxcbiAgICAgICAgICAgIHBhZ2VzOiBNYXRoLmNlaWwodG90YWwgLyBwYXJzZUludChsaW1pdCwgMTApKSxcbiAgICAgICAgICAgIHRvdGFsXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAnVXNlciByZXZpZXdzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknXG4gICAgICApXG4gICAgKTtcblxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBlcnJvcignRXJyb3IgZmV0Y2hpbmcgdXNlciByZXZpZXdzJywgeyBlcnJvcjogZXJyLm1lc3NhZ2UsIHVzZXJJZDogcmVxLnVzZXI/LmlkIH0pO1xuICAgIG5leHQoZXJyKTtcbiAgfVxufTtcblxuLy8gVXBkYXRlIGEgcmV2aWV3XG5jb25zdCB1cGRhdGVSZXZpZXcgPSBhc3luYyhyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcmV2aWV3SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgeyB0aXRsZSwgY29udGVudCwgcmF0aW5nLCByYXRpbmdzIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VySWQgPSByZXEudXNlci5pZDtcblxuICAgIGNvbnN0IHJldmlldyA9IGF3YWl0IFJldmlldy5maW5kQnlJZChyZXZpZXdJZCk7XG5cbiAgICBpZiAoIXJldmlldykge1xuICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoJ1JldmlldyBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIG93bnMgdGhpcyByZXZpZXdcbiAgICBpZiAocmV2aWV3LnVzZXIudG9TdHJpbmcoKSAhPT0gdXNlcklkKSB7XG4gICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdBY2Nlc3MgZGVuaWVkJyk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHJldmlld1xuICAgIGNvbnN0IHVwZGF0ZWRSZXZpZXcgPSBhd2FpdCBSZXZpZXcuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICByZXZpZXdJZCxcbiAgICAgIHsgdGl0bGUsIGNvbnRlbnQsIHJhdGluZywgcmF0aW5ncyB9LFxuICAgICAgeyBuZXc6IHRydWUsIHJ1blZhbGlkYXRvcnM6IHRydWUgfVxuICAgICkucG9wdWxhdGUoJ3VzZXInLCAnbmFtZSBlbWFpbCcpO1xuXG4gICAgaW5mbygnUmV2aWV3IHVwZGF0ZWQnLCB7XG4gICAgICByZXZpZXdJZCxcbiAgICAgIHVzZXJJZFxuICAgIH0pO1xuXG4gICAgcmVzLmpzb24oXG4gICAgICBzdWNjZXNzUmVzcG9uc2UoXG4gICAgICAgIHsgcmV2aWV3OiB1cGRhdGVkUmV2aWV3IH0sXG4gICAgICAgICdSZXZpZXcgdXBkYXRlZCBzdWNjZXNzZnVsbHknXG4gICAgICApXG4gICAgKTtcblxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBlcnJvcignRXJyb3IgdXBkYXRpbmcgcmV2aWV3JywgeyBlcnJvcjogZXJyLm1lc3NhZ2UsIHJldmlld0lkOiByZXEucGFyYW1zLnJldmlld0lkIH0pO1xuICAgIG5leHQoZXJyKTtcbiAgfVxufTtcblxuLy8gRGVsZXRlIGEgcmV2aWV3XG5jb25zdCBkZWxldGVSZXZpZXcgPSBhc3luYyhyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcmV2aWV3SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuaWQ7XG5cbiAgICBjb25zdCByZXZpZXcgPSBhd2FpdCBSZXZpZXcuZmluZEJ5SWQocmV2aWV3SWQpO1xuXG4gICAgaWYgKCFyZXZpZXcpIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKCdSZXZpZXcgbm90IGZvdW5kJyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdXNlciBvd25zIHRoaXMgcmV2aWV3IG9yIGlzIGFkbWluXG4gICAgaWYgKHJldmlldy51c2VyLnRvU3RyaW5nKCkgIT09IHVzZXJJZCAmJiByZXEudXNlci5yb2xlICE9PSAnYWRtaW4nKSB7XG4gICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdBY2Nlc3MgZGVuaWVkJyk7XG4gICAgfVxuXG4gICAgYXdhaXQgUmV2aWV3LmZpbmRCeUlkQW5kRGVsZXRlKHJldmlld0lkKTtcblxuICAgIGluZm8oJ1JldmlldyBkZWxldGVkJywge1xuICAgICAgcmV2aWV3SWQsXG4gICAgICB1c2VySWQsXG4gICAgICBkZWxldGVkQnk6IHJlcS51c2VyLnJvbGVcbiAgICB9KTtcblxuICAgIHJlcy5qc29uKFxuICAgICAgc3VjY2Vzc1Jlc3BvbnNlKFxuICAgICAgICBudWxsLFxuICAgICAgICAnUmV2aWV3IGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5J1xuICAgICAgKVxuICAgICk7XG5cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHJldmlldycsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCByZXZpZXdJZDogcmVxLnBhcmFtcy5yZXZpZXdJZCB9KTtcbiAgICBuZXh0KGVycik7XG4gIH1cbn07XG5cbi8vIE1hcmsgcmV2aWV3IGFzIGhlbHBmdWxcbmNvbnN0IG1hcmtSZXZpZXdIZWxwZnVsID0gYXN5bmMocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHJldmlld0lkIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLmlkO1xuXG4gICAgY29uc3QgcmV2aWV3ID0gYXdhaXQgUmV2aWV3LmZpbmRCeUlkKHJldmlld0lkKTtcblxuICAgIGlmICghcmV2aWV3KSB7XG4gICAgICB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcignUmV2aWV3IG5vdCBmb3VuZCcpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHVzZXIgYWxyZWFkeSBtYXJrZWQgdGhpcyByZXZpZXcgYXMgaGVscGZ1bFxuICAgIGNvbnN0IGlzQWxyZWFkeUhlbHBmdWwgPSByZXZpZXcuaGVscGZ1bFVzZXJzLmluY2x1ZGVzKHVzZXJJZCk7XG5cbiAgICBpZiAoaXNBbHJlYWR5SGVscGZ1bCkge1xuICAgICAgLy8gUmVtb3ZlIGhlbHBmdWwgdm90ZVxuICAgICAgcmV2aWV3LmhlbHBmdWxVc2VycyA9IHJldmlldy5oZWxwZnVsVXNlcnMuZmlsdGVyKGlkID0+IGlkLnRvU3RyaW5nKCkgIT09IHVzZXJJZCk7XG4gICAgICByZXZpZXcuaGVscGZ1bFZvdGVzID0gTWF0aC5tYXgoMCwgcmV2aWV3LmhlbHBmdWxWb3RlcyAtIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBZGQgaGVscGZ1bCB2b3RlXG4gICAgICByZXZpZXcuaGVscGZ1bFVzZXJzLnB1c2godXNlcklkKTtcbiAgICAgIHJldmlldy5oZWxwZnVsVm90ZXMgKz0gMTtcbiAgICB9XG5cbiAgICBhd2FpdCByZXZpZXcuc2F2ZSgpO1xuXG4gICAgcmVzLmpzb24oXG4gICAgICBzdWNjZXNzUmVzcG9uc2UoXG4gICAgICAgIHtcbiAgICAgICAgICBoZWxwZnVsOiAhaXNBbHJlYWR5SGVscGZ1bCxcbiAgICAgICAgICBoZWxwZnVsVm90ZXM6IHJldmlldy5oZWxwZnVsVm90ZXNcbiAgICAgICAgfSxcbiAgICAgICAgYFJldmlldyAke2lzQWxyZWFkeUhlbHBmdWwgPyAndW5tYXJrZWQnIDogJ21hcmtlZCd9IGFzIGhlbHBmdWxgXG4gICAgICApXG4gICAgKTtcblxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBlcnJvcignRXJyb3IgbWFya2luZyByZXZpZXcgaGVscGZ1bCcsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCByZXZpZXdJZDogcmVxLnBhcmFtcy5yZXZpZXdJZCB9KTtcbiAgICBuZXh0KGVycik7XG4gIH1cbn07XG5cbi8vIEdldCBhbGwgcmV2aWV3cyAoYWRtaW4gb25seSlcbmNvbnN0IGdldEFsbFJldmlld3MgPSBhc3luYyhyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc3RhdHVzLCBwYWdlID0gMSwgbGltaXQgPSAyMCwgZGVzdGluYXRpb25JZCB9ID0gcmVxLnF1ZXJ5O1xuXG4gICAgLy8gQnVpbGQgcXVlcnlcbiAgICBjb25zdCBxdWVyeSA9IHt9O1xuICAgIGlmIChzdGF0dXMpIHtcbiAgICAgIHF1ZXJ5LnN0YXR1cyA9IHN0YXR1cztcbiAgICB9XG4gICAgaWYgKGRlc3RpbmF0aW9uSWQpIHtcbiAgICAgIHF1ZXJ5LmRlc3RpbmF0aW9uID0gZGVzdGluYXRpb25JZDtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgcGFnaW5hdGlvblxuICAgIGNvbnN0IHNraXAgPSAocGFyc2VJbnQocGFnZSwgMTApIC0gMSkgKiBwYXJzZUludChsaW1pdCwgMTApO1xuXG4gICAgLy8gR2V0IHJldmlld3Mgd2l0aCBwYWdpbmF0aW9uXG4gICAgY29uc3QgcmV2aWV3cyA9IGF3YWl0IFJldmlldy5maW5kKHF1ZXJ5KVxuICAgICAgLnBvcHVsYXRlKCdkZXN0aW5hdGlvbicsICd0aXRsZSBsb2NhdGlvbicpXG4gICAgICAucG9wdWxhdGUoJ3VzZXInLCAnbmFtZSBlbWFpbCcpXG4gICAgICAuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSlcbiAgICAgIC5za2lwKHNraXApXG4gICAgICAubGltaXQocGFyc2VJbnQobGltaXQsIDEwKSk7XG5cbiAgICAvLyBHZXQgdG90YWwgY291bnRcbiAgICBjb25zdCB0b3RhbCA9IGF3YWl0IFJldmlldy5jb3VudERvY3VtZW50cyhxdWVyeSk7XG5cbiAgICByZXMuanNvbihcbiAgICAgIHN1Y2Nlc3NSZXNwb25zZShcbiAgICAgICAge1xuICAgICAgICAgIHJldmlld3MsXG4gICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgY3VycmVudDogcGFyc2VJbnQocGFnZSwgMTApLFxuICAgICAgICAgICAgcGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIHBhcnNlSW50KGxpbWl0LCAxMCkpLFxuICAgICAgICAgICAgdG90YWxcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICdBbGwgcmV2aWV3cyByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5J1xuICAgICAgKVxuICAgICk7XG5cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFsbCByZXZpZXdzJywgeyBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7XG4gICAgbmV4dChlcnIpO1xuICB9XG59O1xuXG4vLyBVcGRhdGUgcmV2aWV3IHN0YXR1cyAoYWRtaW4gb25seSlcbmNvbnN0IHVwZGF0ZVJldmlld1N0YXR1cyA9IGFzeW5jKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyByZXZpZXdJZCB9ID0gcmVxLnBhcmFtcztcbiAgICBjb25zdCB7IHN0YXR1cywgYWRtaW5SZXNwb25zZSB9ID0gcmVxLmJvZHk7XG5cbiAgICBjb25zdCB2YWxpZFN0YXR1c2VzID0gWydwZW5kaW5nJywgJ2FwcHJvdmVkJywgJ3JlamVjdGVkJ107XG4gICAgaWYgKCF2YWxpZFN0YXR1c2VzLmluY2x1ZGVzKHN0YXR1cykpIHtcbiAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgcmV2aWV3IHN0YXR1cycpO1xuICAgIH1cblxuICAgIGNvbnN0IHJldmlldyA9IGF3YWl0IFJldmlldy5maW5kQnlJZChyZXZpZXdJZCk7XG4gICAgaWYgKCFyZXZpZXcpIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKCdSZXZpZXcgbm90IGZvdW5kJyk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHJldmlldyBzdGF0dXNcbiAgICByZXZpZXcuc3RhdHVzID0gc3RhdHVzO1xuXG4gICAgLy8gQWRkIGFkbWluIHJlc3BvbnNlIGlmIHByb3ZpZGVkXG4gICAgaWYgKGFkbWluUmVzcG9uc2UpIHtcbiAgICAgIHJldmlldy5hZG1pblJlc3BvbnNlID0ge1xuICAgICAgICBjb250ZW50OiBhZG1pblJlc3BvbnNlLFxuICAgICAgICByZXNwb25kZWRCeTogcmVxLnVzZXIuaWQsXG4gICAgICAgIHJlc3BvbmRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuICAgIH1cblxuICAgIGF3YWl0IHJldmlldy5zYXZlKCk7XG5cbiAgICAvLyBQb3B1bGF0ZSB0aGUgcmV2aWV3XG4gICAgYXdhaXQgcmV2aWV3LnBvcHVsYXRlKFtcbiAgICAgIHsgcGF0aDogJ3VzZXInLCBzZWxlY3Q6ICduYW1lIGVtYWlsJyB9LFxuICAgICAgeyBwYXRoOiAnZGVzdGluYXRpb24nLCBzZWxlY3Q6ICd0aXRsZSBsb2NhdGlvbicgfVxuICAgIF0pO1xuXG4gICAgaW5mbygnUmV2aWV3IHN0YXR1cyB1cGRhdGVkJywge1xuICAgICAgcmV2aWV3SWQsXG4gICAgICBuZXdTdGF0dXM6IHN0YXR1cyxcbiAgICAgIGFkbWluSWQ6IHJlcS51c2VyLmlkXG4gICAgfSk7XG5cbiAgICByZXMuanNvbihcbiAgICAgIHN1Y2Nlc3NSZXNwb25zZShcbiAgICAgICAgeyByZXZpZXcgfSxcbiAgICAgICAgJ1JldmlldyBzdGF0dXMgdXBkYXRlZCBzdWNjZXNzZnVsbHknXG4gICAgICApXG4gICAgKTtcblxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBlcnJvcignRXJyb3IgdXBkYXRpbmcgcmV2aWV3IHN0YXR1cycsIHsgZXJyb3I6IGVyci5tZXNzYWdlLCByZXZpZXdJZDogcmVxLnBhcmFtcy5yZXZpZXdJZCB9KTtcbiAgICBuZXh0KGVycik7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjcmVhdGVSZXZpZXcsXG4gIGdldERlc3RpbmF0aW9uUmV2aWV3cyxcbiAgZ2V0VXNlclJldmlld3MsXG4gIHVwZGF0ZVJldmlldyxcbiAgZGVsZXRlUmV2aWV3LFxuICBtYXJrUmV2aWV3SGVscGZ1bCxcbiAgZ2V0QWxsUmV2aWV3cyxcbiAgdXBkYXRlUmV2aWV3U3RhdHVzXG59OyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsK0JBQStCLENBQUM7QUFDdkQsTUFBTUMsV0FBVyxHQUFHRCxPQUFPLENBQUMsb0NBQW9DLENBQUM7QUFDakUsTUFBTUUsT0FBTyxHQUFHRixPQUFPLENBQUMsZ0NBQWdDLENBQUM7QUFDekQsTUFBTTtFQUFFRyxlQUFlO0VBQUVDLGFBQWE7RUFBRUM7QUFBYyxDQUFDLEdBQUdMLE9BQU8s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