7d0d1fb2e750ecaa37f12d6357648180
/* istanbul ignore next */
function cov_1y6t3e25u8() {
  var path = "/Users/mfarsx/dev/tripvar/tripvar-server/src/services/destination.service.js";
  var hash = "e86cd3775222b6a315dcd831aef83975c6a0bc31";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/mfarsx/dev/tripvar/tripvar-server/src/services/destination.service.js",
    statementMap: {
      "0": {
        start: {
          line: 1,
          column: 20
        },
        end: {
          line: 1,
          column: 45
        }
      },
      "1": {
        start: {
          line: 5,
          column: 4
        },
        end: {
          line: 5,
          column: 22
        }
      },
      "2": {
        start: {
          line: 10,
          column: 4
        },
        end: {
          line: 14,
          column: 5
        }
      },
      "3": {
        start: {
          line: 11,
          column: 6
        },
        end: {
          line: 11,
          column: 70
        }
      },
      "4": {
        start: {
          line: 13,
          column: 6
        },
        end: {
          line: 13,
          column: 18
        }
      },
      "5": {
        start: {
          line: 19,
          column: 4
        },
        end: {
          line: 23,
          column: 5
        }
      },
      "6": {
        start: {
          line: 20,
          column: 6
        },
        end: {
          line: 20,
          column: 50
        }
      },
      "7": {
        start: {
          line: 22,
          column: 6
        },
        end: {
          line: 22,
          column: 18
        }
      },
      "8": {
        start: {
          line: 28,
          column: 4
        },
        end: {
          line: 32,
          column: 5
        }
      },
      "9": {
        start: {
          line: 29,
          column: 6
        },
        end: {
          line: 29,
          column: 53
        }
      },
      "10": {
        start: {
          line: 31,
          column: 6
        },
        end: {
          line: 31,
          column: 18
        }
      },
      "11": {
        start: {
          line: 37,
          column: 4
        },
        end: {
          line: 41,
          column: 5
        }
      },
      "12": {
        start: {
          line: 38,
          column: 6
        },
        end: {
          line: 38,
          column: 60
        }
      },
      "13": {
        start: {
          line: 40,
          column: 6
        },
        end: {
          line: 40,
          column: 18
        }
      },
      "14": {
        start: {
          line: 46,
          column: 4
        },
        end: {
          line: 50,
          column: 5
        }
      },
      "15": {
        start: {
          line: 47,
          column: 6
        },
        end: {
          line: 47,
          column: 60
        }
      },
      "16": {
        start: {
          line: 49,
          column: 6
        },
        end: {
          line: 49,
          column: 18
        }
      },
      "17": {
        start: {
          line: 55,
          column: 4
        },
        end: {
          line: 59,
          column: 5
        }
      },
      "18": {
        start: {
          line: 56,
          column: 6
        },
        end: {
          line: 56,
          column: 72
        }
      },
      "19": {
        start: {
          line: 58,
          column: 6
        },
        end: {
          line: 58,
          column: 18
        }
      },
      "20": {
        start: {
          line: 64,
          column: 4
        },
        end: {
          line: 68,
          column: 5
        }
      },
      "21": {
        start: {
          line: 65,
          column: 6
        },
        end: {
          line: 65,
          column: 74
        }
      },
      "22": {
        start: {
          line: 67,
          column: 6
        },
        end: {
          line: 67,
          column: 18
        }
      },
      "23": {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 84,
          column: 5
        }
      },
      "24": {
        start: {
          line: 74,
          column: 32
        },
        end: {
          line: 74,
          column: 61
        }
      },
      "25": {
        start: {
          line: 75,
          column: 35
        },
        end: {
          line: 75,
          column: 71
        }
      },
      "26": {
        start: {
          line: 77,
          column: 6
        },
        end: {
          line: 81,
          column: 8
        }
      },
      "27": {
        start: {
          line: 83,
          column: 6
        },
        end: {
          line: 83,
          column: 18
        }
      },
      "28": {
        start: {
          line: 89,
          column: 4
        },
        end: {
          line: 97,
          column: 5
        }
      },
      "29": {
        start: {
          line: 90,
          column: 27
        },
        end: {
          line: 90,
          column: 55
        }
      },
      "30": {
        start: {
          line: 91,
          column: 6
        },
        end: {
          line: 91,
          column: 46
        }
      },
      "31": {
        start: {
          line: 91,
          column: 37
        },
        end: {
          line: 91,
          column: 46
        }
      },
      "32": {
        start: {
          line: 93,
          column: 26
        },
        end: {
          line: 93,
          column: 96
        }
      },
      "33": {
        start: {
          line: 93,
          column: 61
        },
        end: {
          line: 93,
          column: 92
        }
      },
      "34": {
        start: {
          line: 94,
          column: 6
        },
        end: {
          line: 94,
          column: 47
        }
      },
      "35": {
        start: {
          line: 96,
          column: 6
        },
        end: {
          line: 96,
          column: 18
        }
      },
      "36": {
        start: {
          line: 101,
          column: 0
        },
        end: {
          line: 101,
          column: 36
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 4,
            column: 2
          },
          end: {
            line: 4,
            column: 3
          }
        },
        loc: {
          start: {
            line: 4,
            column: 26
          },
          end: {
            line: 6,
            column: 3
          }
        },
        line: 4
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 9,
            column: 2
          },
          end: {
            line: 9,
            column: 3
          }
        },
        loc: {
          start: {
            line: 9,
            column: 48
          },
          end: {
            line: 15,
            column: 3
          }
        },
        line: 9
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 18,
            column: 2
          },
          end: {
            line: 18,
            column: 3
          }
        },
        loc: {
          start: {
            line: 18,
            column: 34
          },
          end: {
            line: 24,
            column: 3
          }
        },
        line: 18
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 27,
            column: 2
          },
          end: {
            line: 27,
            column: 3
          }
        },
        loc: {
          start: {
            line: 27,
            column: 43
          },
          end: {
            line: 33,
            column: 3
          }
        },
        line: 27
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 36,
            column: 2
          },
          end: {
            line: 36,
            column: 3
          }
        },
        loc: {
          start: {
            line: 36,
            column: 45
          },
          end: {
            line: 42,
            column: 3
          }
        },
        line: 36
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 45,
            column: 2
          },
          end: {
            line: 45,
            column: 3
          }
        },
        loc: {
          start: {
            line: 45,
            column: 45
          },
          end: {
            line: 51,
            column: 3
          }
        },
        line: 45
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 54,
            column: 2
          },
          end: {
            line: 54,
            column: 3
          }
        },
        loc: {
          start: {
            line: 54,
            column: 57
          },
          end: {
            line: 60,
            column: 3
          }
        },
        line: 54
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 63,
            column: 2
          },
          end: {
            line: 63,
            column: 3
          }
        },
        loc: {
          start: {
            line: 63,
            column: 58
          },
          end: {
            line: 69,
            column: 3
          }
        },
        line: 63
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 72,
            column: 2
          },
          end: {
            line: 72,
            column: 3
          }
        },
        loc: {
          start: {
            line: 72,
            column: 35
          },
          end: {
            line: 85,
            column: 3
          }
        },
        line: 72
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 88,
            column: 2
          },
          end: {
            line: 88,
            column: 3
          }
        },
        loc: {
          start: {
            line: 88,
            column: 27
          },
          end: {
            line: 98,
            column: 3
          }
        },
        line: 88
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 93,
            column: 46
          },
          end: {
            line: 93,
            column: 47
          }
        },
        loc: {
          start: {
            line: 93,
            column: 61
          },
          end: {
            line: 93,
            column: 92
          }
        },
        line: 93
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 9,
            column: 34
          },
          end: {
            line: 9,
            column: 46
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 9,
            column: 44
          },
          end: {
            line: 9,
            column: 46
          }
        }],
        line: 9
      },
      "1": {
        loc: {
          start: {
            line: 27,
            column: 31
          },
          end: {
            line: 27,
            column: 41
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 27,
            column: 39
          },
          end: {
            line: 27,
            column: 41
          }
        }],
        line: 27
      },
      "2": {
        loc: {
          start: {
            line: 91,
            column: 6
          },
          end: {
            line: 91,
            column: 46
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 91,
            column: 6
          },
          end: {
            line: 91,
            column: 46
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 91
      },
      "3": {
        loc: {
          start: {
            line: 93,
            column: 68
          },
          end: {
            line: 93,
            column: 91
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 93,
            column: 68
          },
          end: {
            line: 93,
            column: 86
          }
        }, {
          start: {
            line: 93,
            column: 90
          },
          end: {
            line: 93,
            column: 91
          }
        }],
        line: 93
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0
    },
    b: {
      "0": [0],
      "1": [0],
      "2": [0, 0],
      "3": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "e86cd3775222b6a315dcd831aef83975c6a0bc31"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1y6t3e25u8 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1y6t3e25u8();
const BaseService =
/* istanbul ignore next */
(cov_1y6t3e25u8().s[0]++, require('./base.service'));
class DestinationService extends BaseService {
  constructor(repository) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[0]++;
    cov_1y6t3e25u8().s[1]++;
    super(repository);
  }

  // Search destinations
  async searchDestinations(query, filters =
  /* istanbul ignore next */
  (cov_1y6t3e25u8().b[0][0]++, {})) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[1]++;
    cov_1y6t3e25u8().s[2]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[3]++;
      return await this.repository.searchDestinations(query, filters);
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[4]++;
      throw error;
    }
  }

  // Get featured destinations
  async getFeaturedDestinations() {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[2]++;
    cov_1y6t3e25u8().s[5]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[6]++;
      return await this.repository.findFeatured();
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[7]++;
      throw error;
    }
  }

  // Get popular destinations
  async getPopularDestinations(limit =
  /* istanbul ignore next */
  (cov_1y6t3e25u8().b[1][0]++, 10)) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[3]++;
    cov_1y6t3e25u8().s[8]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[9]++;
      return await this.repository.getPopular(limit);
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[10]++;
      throw error;
    }
  }

  // Find destinations by location
  async findDestinationsByLocation(location) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[4]++;
    cov_1y6t3e25u8().s[11]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[12]++;
      return await this.repository.findByLocation(location);
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[13]++;
      throw error;
    }
  }

  // Find destinations by category
  async findDestinationsByCategory(category) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[5]++;
    cov_1y6t3e25u8().s[14]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[15]++;
      return await this.repository.findByCategory(category);
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[16]++;
      throw error;
    }
  }

  // Find destinations by price range
  async findDestinationsByPriceRange(minPrice, maxPrice) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[6]++;
    cov_1y6t3e25u8().s[17]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[18]++;
      return await this.repository.findByPriceRange(minPrice, maxPrice);
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[19]++;
      throw error;
    }
  }

  // Update destination rating
  async updateDestinationRating(destinationId, newRating) {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[7]++;
    cov_1y6t3e25u8().s[20]++;
    try {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[21]++;
      return await this.repository.updateRating(destinationId, newRating);
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[22]++;
      throw error;
    }
  }

  // Get destination statistics
  async getDestinationStatistics() {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[8]++;
    cov_1y6t3e25u8().s[23]++;
    try {
      const totalDestinations =
      /* istanbul ignore next */
      (cov_1y6t3e25u8().s[24]++, await this.repository.count());
      const featuredDestinations =
      /* istanbul ignore next */
      (cov_1y6t3e25u8().s[25]++, await this.repository.findFeatured());
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[26]++;
      return {
        totalDestinations,
        featuredCount: featuredDestinations.length,
        averageRating: await this.getAverageRating()
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[27]++;
      throw error;
    }
  }

  // Get average rating across all destinations
  async getAverageRating() {
    /* istanbul ignore next */
    cov_1y6t3e25u8().f[9]++;
    cov_1y6t3e25u8().s[28]++;
    try {
      const destinations =
      /* istanbul ignore next */
      (cov_1y6t3e25u8().s[29]++, await this.repository.find());
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[30]++;
      if (destinations.length === 0) {
        /* istanbul ignore next */
        cov_1y6t3e25u8().b[2][0]++;
        cov_1y6t3e25u8().s[31]++;
        return 0;
      } else
      /* istanbul ignore next */
      {
        cov_1y6t3e25u8().b[2][1]++;
      }
      const totalRating =
      /* istanbul ignore next */
      (cov_1y6t3e25u8().s[32]++, destinations.reduce((sum, dest) => {
        /* istanbul ignore next */
        cov_1y6t3e25u8().f[10]++;
        cov_1y6t3e25u8().s[33]++;
        return sum + (
        /* istanbul ignore next */
        (cov_1y6t3e25u8().b[3][0]++, dest.averageRating) ||
        /* istanbul ignore next */
        (cov_1y6t3e25u8().b[3][1]++, 0));
      }, 0));
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[34]++;
      return totalRating / destinations.length;
    } catch (error) {
      /* istanbul ignore next */
      cov_1y6t3e25u8().s[35]++;
      throw error;
    }
  }
}
/* istanbul ignore next */
cov_1y6t3e25u8().s[36]++;
module.exports = DestinationService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXk2dDNlMjV1OCIsImFjdHVhbENvdmVyYWdlIiwiQmFzZVNlcnZpY2UiLCJzIiwicmVxdWlyZSIsIkRlc3RpbmF0aW9uU2VydmljZSIsImNvbnN0cnVjdG9yIiwicmVwb3NpdG9yeSIsImYiLCJzZWFyY2hEZXN0aW5hdGlvbnMiLCJxdWVyeSIsImZpbHRlcnMiLCJiIiwiZXJyb3IiLCJnZXRGZWF0dXJlZERlc3RpbmF0aW9ucyIsImZpbmRGZWF0dXJlZCIsImdldFBvcHVsYXJEZXN0aW5hdGlvbnMiLCJsaW1pdCIsImdldFBvcHVsYXIiLCJmaW5kRGVzdGluYXRpb25zQnlMb2NhdGlvbiIsImxvY2F0aW9uIiwiZmluZEJ5TG9jYXRpb24iLCJmaW5kRGVzdGluYXRpb25zQnlDYXRlZ29yeSIsImNhdGVnb3J5IiwiZmluZEJ5Q2F0ZWdvcnkiLCJmaW5kRGVzdGluYXRpb25zQnlQcmljZVJhbmdlIiwibWluUHJpY2UiLCJtYXhQcmljZSIsImZpbmRCeVByaWNlUmFuZ2UiLCJ1cGRhdGVEZXN0aW5hdGlvblJhdGluZyIsImRlc3RpbmF0aW9uSWQiLCJuZXdSYXRpbmciLCJ1cGRhdGVSYXRpbmciLCJnZXREZXN0aW5hdGlvblN0YXRpc3RpY3MiLCJ0b3RhbERlc3RpbmF0aW9ucyIsImNvdW50IiwiZmVhdHVyZWREZXN0aW5hdGlvbnMiLCJmZWF0dXJlZENvdW50IiwibGVuZ3RoIiwiYXZlcmFnZVJhdGluZyIsImdldEF2ZXJhZ2VSYXRpbmciLCJkZXN0aW5hdGlvbnMiLCJmaW5kIiwidG90YWxSYXRpbmciLCJyZWR1Y2UiLCJzdW0iLCJkZXN0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImRlc3RpbmF0aW9uLnNlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQmFzZVNlcnZpY2UgPSByZXF1aXJlKCcuL2Jhc2Uuc2VydmljZScpO1xuXG5jbGFzcyBEZXN0aW5hdGlvblNlcnZpY2UgZXh0ZW5kcyBCYXNlU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKHJlcG9zaXRvcnkpIHtcbiAgICBzdXBlcihyZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8vIFNlYXJjaCBkZXN0aW5hdGlvbnNcbiAgYXN5bmMgc2VhcmNoRGVzdGluYXRpb25zKHF1ZXJ5LCBmaWx0ZXJzID0ge30pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucmVwb3NpdG9yeS5zZWFyY2hEZXN0aW5hdGlvbnMocXVlcnksIGZpbHRlcnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgZmVhdHVyZWQgZGVzdGluYXRpb25zXG4gIGFzeW5jIGdldEZlYXR1cmVkRGVzdGluYXRpb25zKCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5yZXBvc2l0b3J5LmZpbmRGZWF0dXJlZCgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgcG9wdWxhciBkZXN0aW5hdGlvbnNcbiAgYXN5bmMgZ2V0UG9wdWxhckRlc3RpbmF0aW9ucyhsaW1pdCA9IDEwKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlcG9zaXRvcnkuZ2V0UG9wdWxhcihsaW1pdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIEZpbmQgZGVzdGluYXRpb25zIGJ5IGxvY2F0aW9uXG4gIGFzeW5jIGZpbmREZXN0aW5hdGlvbnNCeUxvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlcG9zaXRvcnkuZmluZEJ5TG9jYXRpb24obG9jYXRpb24pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyBGaW5kIGRlc3RpbmF0aW9ucyBieSBjYXRlZ29yeVxuICBhc3luYyBmaW5kRGVzdGluYXRpb25zQnlDYXRlZ29yeShjYXRlZ29yeSkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5yZXBvc2l0b3J5LmZpbmRCeUNhdGVnb3J5KGNhdGVnb3J5KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLy8gRmluZCBkZXN0aW5hdGlvbnMgYnkgcHJpY2UgcmFuZ2VcbiAgYXN5bmMgZmluZERlc3RpbmF0aW9uc0J5UHJpY2VSYW5nZShtaW5QcmljZSwgbWF4UHJpY2UpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucmVwb3NpdG9yeS5maW5kQnlQcmljZVJhbmdlKG1pblByaWNlLCBtYXhQcmljZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIFVwZGF0ZSBkZXN0aW5hdGlvbiByYXRpbmdcbiAgYXN5bmMgdXBkYXRlRGVzdGluYXRpb25SYXRpbmcoZGVzdGluYXRpb25JZCwgbmV3UmF0aW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlcG9zaXRvcnkudXBkYXRlUmF0aW5nKGRlc3RpbmF0aW9uSWQsIG5ld1JhdGluZyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdldCBkZXN0aW5hdGlvbiBzdGF0aXN0aWNzXG4gIGFzeW5jIGdldERlc3RpbmF0aW9uU3RhdGlzdGljcygpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdG90YWxEZXN0aW5hdGlvbnMgPSBhd2FpdCB0aGlzLnJlcG9zaXRvcnkuY291bnQoKTtcbiAgICAgIGNvbnN0IGZlYXR1cmVkRGVzdGluYXRpb25zID0gYXdhaXQgdGhpcy5yZXBvc2l0b3J5LmZpbmRGZWF0dXJlZCgpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RhbERlc3RpbmF0aW9ucyxcbiAgICAgICAgZmVhdHVyZWRDb3VudDogZmVhdHVyZWREZXN0aW5hdGlvbnMubGVuZ3RoLFxuICAgICAgICBhdmVyYWdlUmF0aW5nOiBhd2FpdCB0aGlzLmdldEF2ZXJhZ2VSYXRpbmcoKVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IGF2ZXJhZ2UgcmF0aW5nIGFjcm9zcyBhbGwgZGVzdGluYXRpb25zXG4gIGFzeW5jIGdldEF2ZXJhZ2VSYXRpbmcoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRlc3RpbmF0aW9ucyA9IGF3YWl0IHRoaXMucmVwb3NpdG9yeS5maW5kKCk7XG4gICAgICBpZiAoZGVzdGluYXRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XG4gICAgICBcbiAgICAgIGNvbnN0IHRvdGFsUmF0aW5nID0gZGVzdGluYXRpb25zLnJlZHVjZSgoc3VtLCBkZXN0KSA9PiBzdW0gKyAoZGVzdC5hdmVyYWdlUmF0aW5nIHx8IDApLCAwKTtcbiAgICAgIHJldHVybiB0b3RhbFJhdGluZyAvIGRlc3RpbmF0aW9ucy5sZW5ndGg7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IERlc3RpbmF0aW9uU2VydmljZTsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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