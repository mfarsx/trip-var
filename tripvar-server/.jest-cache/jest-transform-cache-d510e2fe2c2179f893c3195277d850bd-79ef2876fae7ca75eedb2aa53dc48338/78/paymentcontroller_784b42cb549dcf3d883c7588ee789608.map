{"version":3,"names":["Booking","require","ValidationError","NotFoundError","ConflictError","successResponse","info","error","simulatePaymentProcessing","paymentData","Promise","resolve","setTimeout","success","Math","random","paymentIntentId","Date","now","toString","substr","transactionId","amount","currency","status","errorCode","simulateRefundProcessing","refundData","refundId","processPayment","req","res","next","bookingId","params","paymentMethod","paymentDetails","body","userId","user","id","booking","findById","populate","paymentStatus","paymentResult","totalAmount","save","json","err","message","getPaymentStatus","select","_id","destination","createdAt","processRefund","reason","role","refundAmount","calculateRefund","refundResult","refundedAt","cancellationReason","getPaymentHistory","page","limit","query","skip","parseInt","bookings","find","sort","total","countDocuments","stats","aggregate","$match","$group","totalSpent","$sum","totalRefunded","$ifNull","paidBookings","$cond","$eq","refundedBookings","paymentStats","length","pagination","current","pages","ceil","module","exports"],"sources":["payment.controller.js"],"sourcesContent":["const Booking = require('../public/models/booking.model');\nconst { ValidationError, NotFoundError, ConflictError } = require('../utils/errors');\nconst { successResponse } = require('../utils/response');\nconst { info, error } = require('../utils/logger');\n\n// Simulate payment processing (replace with real payment provider integration)\nconst simulatePaymentProcessing = async(paymentData) => {\n  // Simulate processing delay\n  await new Promise(resolve => setTimeout(resolve, 1000));\n\n  // Simulate 95% success rate\n  const success = Math.random() > 0.05;\n\n  if (success) {\n    return {\n      success: true,\n      paymentIntentId: `pi_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      transactionId: `txn_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      amount: paymentData.amount,\n      currency: 'USD',\n      status: 'succeeded'\n    };\n  } else {\n    return {\n      success: false,\n      error: 'Payment processing failed',\n      errorCode: 'PAYMENT_FAILED'\n    };\n  }\n};\n\n// Simulate refund processing (replace with real payment provider integration)\nconst simulateRefundProcessing = async(refundData) => {\n  // Simulate processing delay\n  await new Promise(resolve => setTimeout(resolve, 1000));\n\n  // Simulate 98% success rate for refunds\n  const success = Math.random() > 0.02;\n\n  if (success) {\n    return {\n      success: true,\n      refundId: `re_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      amount: refundData.amount,\n      currency: 'USD',\n      status: 'succeeded'\n    };\n  } else {\n    return {\n      success: false,\n      error: 'Refund processing failed',\n      errorCode: 'REFUND_FAILED'\n    };\n  }\n};\n\n// Process payment for a booking\nconst processPayment = async(req, res, next) => {\n  try {\n    const { bookingId } = req.params;\n    const { paymentMethod, paymentDetails } = req.body;\n    const userId = req.user.id;\n\n    // Find the booking\n    const booking = await Booking.findById(bookingId).populate('destination');\n\n    if (!booking) {\n      throw new NotFoundError('Booking not found');\n    }\n\n    // Check if user owns this booking\n    if (booking.user.toString() !== userId) {\n      throw new ValidationError('Access denied');\n    }\n\n    // Check if booking is already paid\n    if (booking.paymentStatus === 'paid') {\n      throw new ConflictError('Booking is already paid');\n    }\n\n    // Check if booking is cancelled\n    if (booking.status === 'cancelled') {\n      throw new ConflictError('Cannot process payment for cancelled booking');\n    }\n\n    // Simulate payment processing\n    // In a real application, you would integrate with payment providers like Stripe, PayPal, etc.\n    const paymentResult = await simulatePaymentProcessing({\n      amount: booking.totalAmount,\n      paymentMethod,\n      paymentDetails,\n      bookingId\n    });\n\n    if (paymentResult.success) {\n      // Update booking with payment information\n      booking.paymentStatus = 'paid';\n      booking.paymentIntentId = paymentResult.paymentIntentId;\n      booking.paymentMethod = paymentMethod;\n\n      await booking.save();\n\n      info('Payment processed successfully', {\n        bookingId,\n        userId,\n        amount: booking.totalAmount,\n        paymentMethod\n      });\n\n      res.json(\n        successResponse(\n          {\n            booking,\n            paymentResult\n          },\n          'Payment processed successfully'\n        )\n      );\n    } else {\n      // Payment failed\n      booking.paymentStatus = 'failed';\n      await booking.save();\n\n      throw new ValidationError(paymentResult.error || 'Payment processing failed');\n    }\n\n  } catch (err) {\n    error('Error processing payment', { error: err.message, bookingId: req.params.bookingId });\n    next(err);\n  }\n};\n\n// Get payment status for a booking\nconst getPaymentStatus = async(req, res, next) => {\n  try {\n    const { bookingId } = req.params;\n    const userId = req.user.id;\n\n    const booking = await Booking.findById(bookingId)\n      .select('paymentStatus paymentMethod totalAmount paymentIntentId createdAt')\n      .populate('destination', 'title');\n\n    if (!booking) {\n      throw new NotFoundError('Booking not found');\n    }\n\n    // Check if user owns this booking\n    if (booking.user.toString() !== userId) {\n      throw new ValidationError('Access denied');\n    }\n\n    res.json(\n      successResponse(\n        {\n          booking: {\n            id: booking._id,\n            destination: booking.destination,\n            paymentStatus: booking.paymentStatus,\n            paymentMethod: booking.paymentMethod,\n            totalAmount: booking.totalAmount,\n            paymentIntentId: booking.paymentIntentId,\n            createdAt: booking.createdAt\n          }\n        },\n        'Payment status retrieved successfully'\n      )\n    );\n\n  } catch (err) {\n    error('Error fetching payment status', { error: err.message, bookingId: req.params.bookingId });\n    next(err);\n  }\n};\n\n// Refund a booking\nconst processRefund = async(req, res, next) => {\n  try {\n    const { bookingId } = req.params;\n    const { reason } = req.body;\n    const userId = req.user.id;\n\n    const booking = await Booking.findById(bookingId);\n\n    if (!booking) {\n      throw new NotFoundError('Booking not found');\n    }\n\n    // Check if user owns this booking or is admin\n    if (booking.user.toString() !== userId && req.user.role !== 'admin') {\n      throw new ValidationError('Access denied');\n    }\n\n    // Check if booking is paid\n    if (booking.paymentStatus !== 'paid') {\n      throw new ConflictError('Cannot refund unpaid booking');\n    }\n\n    // Check if booking is already refunded\n    if (booking.paymentStatus === 'refunded') {\n      throw new ConflictError('Booking is already refunded');\n    }\n\n    // Calculate refund amount\n    const refundAmount = booking.calculateRefund();\n\n    if (refundAmount === 0) {\n      throw new ValidationError('No refund available for this booking');\n    }\n\n    // Simulate refund processing\n    const refundResult = await simulateRefundProcessing({\n      paymentIntentId: booking.paymentIntentId,\n      amount: refundAmount,\n      reason\n    });\n\n    if (refundResult.success) {\n      // Update booking with refund information\n      booking.paymentStatus = 'refunded';\n      booking.refundAmount = refundAmount;\n      booking.refundedAt = new Date();\n      booking.cancellationReason = reason;\n\n      await booking.save();\n\n      info('Refund processed successfully', {\n        bookingId,\n        userId,\n        refundAmount,\n        reason\n      });\n\n      res.json(\n        successResponse(\n          {\n            booking,\n            refundResult\n          },\n          'Refund processed successfully'\n        )\n      );\n    } else {\n      throw new ValidationError(refundResult.error || 'Refund processing failed');\n    }\n\n  } catch (err) {\n    error('Error processing refund', { error: err.message, bookingId: req.params.bookingId });\n    next(err);\n  }\n};\n\n// Get payment history for a user\nconst getPaymentHistory = async(req, res, next) => {\n  try {\n    const userId = req.user.id;\n    const { page = 1, limit = 10, status } = req.query;\n\n    // Build query\n    const query = { user: userId };\n    if (status) {\n      query.paymentStatus = status;\n    }\n\n    // Calculate pagination\n    const skip = (parseInt(page, 10) - 1) * parseInt(limit, 10);\n\n    // Get bookings with payment information\n    const bookings = await Booking.find(query)\n      .select('paymentStatus paymentMethod totalAmount paymentIntentId createdAt refundAmount refundedAt')\n      .populate('destination', 'title location imageUrl')\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(parseInt(limit, 10));\n\n    // Get total count\n    const total = await Booking.countDocuments(query);\n\n    // Calculate payment statistics\n    const stats = await Booking.aggregate([\n      { $match: { user: userId } },\n      {\n        $group: {\n          _id: null,\n          totalSpent: { $sum: '$totalAmount' },\n          totalRefunded: { $sum: { $ifNull: ['$refundAmount', 0] } },\n          paidBookings: {\n            $sum: { $cond: [{ $eq: ['$paymentStatus', 'paid'] }, 1, 0] }\n          },\n          refundedBookings: {\n            $sum: { $cond: [{ $eq: ['$paymentStatus', 'refunded'] }, 1, 0] }\n          }\n        }\n      }\n    ]);\n\n    const paymentStats = stats.length > 0 ? stats[0] : {\n      totalSpent: 0,\n      totalRefunded: 0,\n      paidBookings: 0,\n      refundedBookings: 0\n    };\n\n    res.json(\n      successResponse(\n        {\n          bookings,\n          paymentStats,\n          pagination: {\n            current: parseInt(page, 10),\n            pages: Math.ceil(total / parseInt(limit, 10)),\n            total\n          }\n        },\n        'Payment history retrieved successfully'\n      )\n    );\n\n  } catch (err) {\n    error('Error fetching payment history', { error: err.message, userId: req.user?.id });\n    next(err);\n  }\n};\n\nmodule.exports = {\n  processPayment,\n  getPaymentStatus,\n  processRefund,\n  getPaymentHistory\n};"],"mappings":"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","ignoreList":[]}