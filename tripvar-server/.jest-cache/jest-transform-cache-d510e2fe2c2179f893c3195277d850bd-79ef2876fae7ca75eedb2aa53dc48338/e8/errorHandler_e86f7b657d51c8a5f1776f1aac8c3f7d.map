{"version":3,"names":["cov_1v3fuoo180","actualCoverage","AppError","createError","s","require","error","warn","security","config","handleCastErrorDB","err","f","message","path","value","validation","field","handleValidationErrorDB","errors","Object","values","map","el","e","join","handleJWTError","authentication","handleJWTExpiredError","handleDuplicateFieldsDB","keys","keyValue","charAt","toUpperCase","slice","conflict","handleMongoError","code","b","database","handleRedisError","serviceUnavailable","service","handleRateLimitError","tooManyRequests","retryAfter","limit","remaining","handleMulterError","maxSize","receivedSize","size","maxFiles","receivedFiles","files","length","sendErrorDev","res","req","console","log","statusCode","status","responseData","details","name","stack","requestId","timestamp","method","json","sendErrorProd","isOperational","url","userAgent","get","ip","body","query","params","Date","toISOString","module","exports","next","id","SyntaxError","originalError","type","server","isDevelopment","undefined","logError","securityError"],"sources":["errorHandler.js"],"sourcesContent":["const { AppError, createError } = require('../utils/errors');\nconst { error, warn, security } = require('../utils/logger');\nconst config = require('../config/config');\n\nconst handleCastErrorDB = err => {\n  const message = `Invalid ${err.path}: ${err.value}`;\n  return createError.validation(message, { field: err.path, value: err.value });\n};\n\nconst handleValidationErrorDB = err => {\n  const errors = Object.values(err.errors).map(el => ({\n    field: el.path,\n    message: el.message,\n    value: el.value\n  }));\n  const message = `Invalid input data. ${errors.map(e => e.message).join('. ')}`;\n  return createError.validation(message, errors);\n};\n\nconst handleJWTError = () =>\n  createError.authentication('Invalid token. Please log in again!');\n\nconst handleJWTExpiredError = () =>\n  createError.authentication('Your token has expired! Please log in again.');\n\nconst handleDuplicateFieldsDB = err => {\n  const field = Object.keys(err.keyValue)[0];\n  const value = err.keyValue[field];\n  const message = `${field.charAt(0).toUpperCase() + field.slice(1)} '${value}' already exists`;\n  return createError.conflict(message, { field, value });\n};\n\nconst handleMongoError = err => {\n  if (err.code === 11000) {\n    return handleDuplicateFieldsDB(err);\n  }\n  return createError.database('Database operation failed', { code: err.code });\n};\n\nconst handleRedisError = err => {\n  return createError.serviceUnavailable('Cache service unavailable', {\n    service: 'redis',\n    error: err.message\n  });\n};\n\nconst handleRateLimitError = err => {\n  return createError.tooManyRequests('Too many requests, please try again later', {\n    retryAfter: err.retryAfter,\n    limit: err.limit,\n    remaining: err.remaining\n  });\n};\n\nconst handleMulterError = err => {\n  if (err.code === 'LIMIT_FILE_SIZE') {\n    return createError.validation('File too large', {\n      maxSize: err.limit,\n      receivedSize: err.size\n    });\n  }\n  if (err.code === 'LIMIT_FILE_COUNT') {\n    return createError.validation('Too many files', {\n      maxFiles: err.limit,\n      receivedFiles: err.files?.length\n    });\n  }\n  if (err.code === 'LIMIT_UNEXPECTED_FILE') {\n    return createError.validation('Unexpected file field', {\n      field: err.field\n    });\n  }\n  return createError.validation('File upload error', { error: err.message });\n};\n\nconst sendErrorDev = (err, res, req) => {\n  console.log('sendErrorDev called with:', {\n    statusCode: err.statusCode,\n    status: err.status,\n    message: err.message,\n    code: err.code\n  });\n\n  try {\n    const responseData = {\n      status: err.status,\n      message: err.message,\n      code: err.code,\n      details: err.details,\n      error: {\n        name: err.name,\n        stack: err.stack\n      },\n      requestId: req.requestId,\n      timestamp: err.timestamp,\n      path: req.path,\n      method: req.method\n    };\n\n    console.log('Sending response:', responseData);\n    res.status(err.statusCode).json(responseData);\n    console.log('Response sent successfully');\n  } catch (error) {\n    console.error('Error in sendErrorDev:', error);\n    // Fallback response\n    res.status(500).json({\n      status: 'error',\n      message: 'Internal server error',\n      code: 'INTERNAL_ERROR'\n    });\n  }\n};\n\nconst sendErrorProd = (err, res, req) => {\n  // Operational, trusted error: send message to client\n  if (err.isOperational) {\n    res.status(err.statusCode).json({\n      status: err.status,\n      message: err.message,\n      code: err.code,\n      details: err.details,\n      requestId: req.requestId,\n      timestamp: err.timestamp\n    });\n  }\n  // Programming or other unknown error: don't leak error details\n  else {\n    // Log error for debugging\n    error('Unhandled error', {\n      error: err.message,\n      stack: err.stack,\n      requestId: req.requestId,\n      url: req.url,\n      method: req.method,\n      userAgent: req.get('User-Agent'),\n      ip: req.ip,\n      body: req.body,\n      query: req.query,\n      params: req.params\n    });\n\n    // Send generic message\n    res.status(500).json({\n      status: 'error',\n      message: 'Something went very wrong!',\n      code: 'INTERNAL_SERVER_ERROR',\n      requestId: req.requestId,\n      timestamp: new Date().toISOString()\n    });\n  }\n};\n\n// Global error handling middleware\nmodule.exports = (err, req, res, next) => {\n  // Debug: Log the error to see what's happening\n  console.log('Error handler called with:', {\n    message: err.message,\n    statusCode: err.statusCode,\n    status: err.status,\n    name: err.name,\n    stack: err.stack\n  });\n\n  err.statusCode = err.statusCode || 500;\n  err.status = err.status || 'error';\n  err.timestamp = err.timestamp || new Date().toISOString();\n  err.requestId = req.requestId || req.id || 'unknown';\n\n  // Handle JSON parsing errors\n  if (err instanceof SyntaxError && err.status === 400 && 'body' in err) {\n    err = createError.validation('Invalid JSON format', { \n      originalError: err.message,\n      code: 'INVALID_JSON'\n    });\n  }\n\n  // Handle payload too large errors\n  if (err.type === 'entity.too.large') {\n    err = createError.validation('Request payload too large', {\n      code: 'PAYLOAD_TOO_LARGE',\n      limit: err.limit\n    });\n  }\n\n  // Log all errors with appropriate level\n  console.log('About to log error details');\n  try {\n    if (err.statusCode >= 500) {\n      console.log('Logging server error');\n      error('Server error', {\n        error: err.message,\n        stack: config.server.isDevelopment ? err.stack : undefined,\n        requestId: req.requestId,\n        url: req.url,\n        method: req.method,\n        statusCode: err.statusCode,\n        userAgent: req.get('User-Agent'),\n        ip: req.ip\n      });\n\n      // Alert for critical server errors\n      security('CRITICAL SERVER ERROR', {\n        error: err.message,\n        requestId: req.requestId,\n        url: req.url,\n        method: req.method,\n        statusCode: err.statusCode,\n        ip: req.ip,\n        timestamp: new Date().toISOString()\n      });\n    } else if (err.statusCode >= 400) {\n      console.log('Logging client error');\n      warn('Client error', {\n        error: err.message,\n        requestId: req.requestId,\n        url: req.url,\n        method: req.method,\n        statusCode: err.statusCode,\n        userAgent: req.get('User-Agent'),\n        ip: req.ip\n      });\n    }\n    console.log('Error logging completed');\n  } catch (logError) {\n    console.error('Error in logging section:', logError);\n  }\n\n  // Log security-related errors\n  console.log('About to check security logging');\n  try {\n    if (err.statusCode === 401 || err.statusCode === 403) {\n      console.log('Logging security error');\n      security('Authentication/Authorization error', {\n        error: err.message,\n        requestId: req.requestId,\n        url: req.url,\n        method: req.method,\n        ip: req.ip,\n        userAgent: req.get('User-Agent')\n      });\n    }\n    console.log('Security logging completed');\n  } catch (securityError) {\n    console.error('Error in security logging section:', securityError);\n  }\n\n  console.log('About to check isDevelopment:', config.server.isDevelopment);\n  console.log('Config object:', config);\n  \n  if (config.server.isDevelopment) {\n    console.log('Calling sendErrorDev');\n    sendErrorDev(err, res, req);\n  } else {\n    console.log('Calling sendErrorProd');\n    let error = { ...err };\n    error.message = err.message;\n\n    // Handle specific error types\n    if (error.name === 'CastError') {\n      error = handleCastErrorDB(error);\n    }\n    if (error.name === 'ValidationError') {\n      error = handleValidationErrorDB(error);\n    }\n    if (error.name === 'JsonWebTokenError') {\n      error = handleJWTError();\n    }\n    if (error.name === 'TokenExpiredError') {\n      error = handleJWTExpiredError();\n    }\n    if (error.name === 'MongoError') {\n      error = handleMongoError(error);\n    }\n    if (error.name === 'MongoServerError') {\n      error = handleMongoError(error);\n    }\n    if (error.name === 'RedisError') {\n      error = handleRedisError(error);\n    }\n    if (error.name === 'RateLimitError') {\n      error = handleRateLimitError(error);\n    }\n    if (error.name === 'MulterError') {\n      error = handleMulterError(error);\n    }\n\n    sendErrorProd(error, res, req);\n  }\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}